MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;----------------------------------------------------------------
                      00002 ;TEST Tranmitter / Remote control for an electric blanket.  
                      00003 ;
                      00004 ;   TTTTTTTTTT  EEEEEEEEE       SSSSSSSSSSS     TTTTTTTTTTTTT
                      00005 ;       TT      EE              SS       SS           TT
                      00006 ;       TT      EE              SS                    TT
                      00007 ;       TT      EEEEEE          SSSSSSSSSSS           TT
                      00008 ;       TT      EE                       SS           TT
                      00009 ;       TT      EE              SS       SS           TT
                      00010 ;       TT      EEEEEEEEE       SSSSSSSSSSS           TT
                      00011 ;
                      00012 ;Funtions: Simulute different transmissions modes dependign on the MODE button position
                      00013 ;
                      00014 ; Programmer:   Gino Isla for Lambda Sistemi, Milano
                      00015 ; Created:              03-12-2005      Version 1.0
                      00016 ; Clock:                4Mhz
                      00017 ; IDE:                  MPLAB v7.20
                      00018 ;----------------------------------------------------------------
                      00019 ;       list            p=16f914                ; list directive to define processor
                      00020 ;       #include        <p16f917.inc>   ; processor specific variable definitions
                      00021         #include        <p16f914.inc>   ; processor specific variable definitions
                      00001         LIST
                      00002 ; P16F914.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.
                      00842         LIST
                      00022         #include        <Macros.inc>
                      00001 ;General macro definitions
                      00002 
                      00003 M_CMP_JE        macro   value1,value2,jumpto    ;value1 = value2?
                      00004                 movf    value1,w
                      00005                 xorwf   value2,w
                      00006                 btfsc   STATUS,Z
                      00007                 goto    jumpto
                      00008                 endm
                      00009 M_CMPL_JE       macro   value1,literal,jumpto   ;value1 = k?
                      00010                 movf    value1,w
                      00011                 xorlw   literal
                      00012                 btfsc   STATUS,Z
                      00013                 goto    jumpto
                      00014                 endm
                      00015 M_CMP_JNE       macro   value1,value2,jumpto    ;value1 <> value2?
                      00016                 movf    value1,w
                      00017                 xorwf   value2,w
                      00018                 btfss   STATUS,Z
                      00019                 goto    jumpto
                      00020                 endm
                      00021 M_CMPL_JNE      macro   value1,literal,jumpto   ;value1 <> k? WARNING: destroys WREG!
                      00022                 movf    value1,w
                      00023                 xorlw   literal
                      00024                 btfss   STATUS,Z
                      00025                 goto    jumpto
                      00026                 endm
                      00027 
                      00028 
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00029 M_CMPL_JGE      macro   value1,literal,jumpto   ;value1 >= k?
                      00030                 movlw   literal
                      00031                 subwf   value1,w                ;k-v1 >= 0
                      00032                 btfsc   STATUS,C
                      00033                 goto    jumpto
                      00034                 endm
                      00035 
                      00036 
                      00037 
                      00038 M_CMP_JG        macro   value1,value2,jumpto    ;value1 > value2?
                      00039                 movf    value2,w
                      00040                 subwf   value1,w        ;v1-v2 > 0
                      00041                 btfss   STATUS,C
                      00042                 goto    $+4
                      00043                 btfsc   STATUS,Z
                      00044                 goto    $+2
                      00045                 goto    jumpto
                      00046                 endm
                      00047 
                      00048 M_CMP_JGE       macro   value1,value2,jumpto    ;value1 >= value2?
                      00049                 movf    value2,w
                      00050                 subwf   value1,w        ;v1-v2 >= 0
                      00051                 btfsc   STATUS,C
                      00052                 goto    jumpto
                      00053                 endm
                      00054 
                      00055 M_CMP_JL        macro   value1,value2,jumpto    ;value1 < value2?
                      00056                 movf    value2,w
                      00057                 subwf   value1,w        ;v1-v2 < 0
                      00058                 btfss   STATUS,C
                      00059                 goto    jumpto
                      00060                 endm
                      00061 
                      00062 M_CMP_JLE       macro   value1,value2,jumpto    ;value1 <= value2?
                      00063                 movf    value1,w
                      00064                 subwf   value2,w        ;v2-v1 > 0
                      00065                 btfsc   STATUS,C
                      00066                 goto    $+2
                      00067                 btfsc   STATUS,Z
                      00068                 goto    jumpto
                      00069                 endm
                      00070 
                      00071 
                      00072 M_CMPL_JL       macro   value1,literal,jumpto   ;value1 < literal?
                      00073                 movf    value1,w
                      00074                 sublw   literal ;k-v1 < 0
                      00075                 btfss   STATUS,C
                      00076                 goto    $+4
                      00077                 btfsc   STATUS,Z
                      00078                 goto    $+2
                      00079                 goto    jumpto
                      00080                 endm
                      00081 
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00082 M_CMPL_JG       macro   value1,literal,jumpto   ;k-val1 < 0
                      00083                 movf    value1,w
                      00084                 sublw   literal
                      00085                 btfss   STATUS,C
                      00086                 goto    jumpto
                      00087                 endm
                      00088                 
                      00089 
                      00090 M_BANKSEL_0     macro
                      00091                 BCF     STATUS,6
                      00092                 BCF     STATUS,5
                      00093                 endm
                      00094 M_BANKSEL_1     macro
                      00095                 BCF     STATUS,6
                      00096                 BSF     STATUS,5
                      00097                 endm
                      00098 M_BANKSEL_2     macro
                      00099                 BSF     STATUS,6
                      00100                 BCF     STATUS,5
                      00101                 endm
                      00102 M_BANKSEL_3     macro
                      00103                 BSF     STATUS,6
                      00104                 BSF     STATUS,5
                      00105                 endm
                      00023         #include        <TXTestHeader.h>
                      00001 
                      00002 ;
                      00003 ;********* make changes to LCD prescale here  ONLY********************
  00000003            00004 LCD_PRESCALE    EQU             b'00000011'                                     ;PRESCALE=4 (last 4 bits
                             of LCDPS)
                      00005 ;#DEFINE        WAVE_TYPE_A
                      00006 #DEFINE         WAVE_TYPE_B                                                     ;
                      00007 ;*********************************************************************
  00000000            00008 WFT_A                           EQU             b'00000000'
  00000080            00009 WFT_B                           EQU             b'10000000'
  00000004            00010 MULTIPLEX                       EQU             .4                                                      
                            ;1/4 multiplex
                      00011 
  00000040            00012 LCD_FRAME_FREQ          EQU             .1024/(MULTIPLEX * (LCD_PRESCALE+1))    ;Hz
  000003E8            00013 MILLI                           EQU             .1000                                                   
                                            ;
  00003D09            00014 LCD_FRAME_PERIOD        EQU             .1000*MILLI/LCD_FRAME_FREQ                              ;in mill
                            isecs
                      00015 
                      00016 ;++++++++++++ This is the time base for this project (1/4 mpx) +++++++++++++++++++++++++++
  00007A12            00017 LCD_TICK        EQU             LCD_FRAME_PERIOD*2                                                      
                                    ;
                      00018 ;++++++++++++ This is the time base for this project +++++++++++++++++++++++++++++++++++++
                      00019 
  00000009            00020 PW_ON_PERIOD            EQU             .300*MILLI/LCD_TICK                                     ;counts 
                            for a period of approx 300ms
  00000060            00021 PW_OFF_PERIOD           EQU             .3000*MILLI/LCD_TICK                            ;counts for a pe
                            riod of approx 3 seconds
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000006            00022 DEBOUNCE_PERIOD         EQU             .200*MILLI/LCD_TICK                                     ;debounc
                            e
                      00023 
                      00024         IF      DEBOUNCE_PERIOD < .150*MILLI/LCD_TICK
                      00025         ERROR:"DEBOUNCE_PERIOD OUT OF RANGE"
                      00026         ENDIF
                      00027 
  00000040            00028 AUTOLOCK_DEBOUNCE       EQU             .2000*MILLI/LCD_TICK                            ;2seconds
                      00029 
  00000010            00030 BLINK_PERIOD            EQU             .500*MILLI/LCD_TICK                                     ;1/2 sec
                            ond blinks when adjusting the clock
  00000020            00031 IDLE_BTN_COUNT          EQU             .1000*MILLI/LCD_TICK                            ;button actions 
                            after 1 idle second
                      00032 
  00000005            00033 AUTOLOCK_ON_TIME        EQU             .1000*MILLI/(LCD_TICK*DEBOUNCE_PERIOD)  ;the count of AUTOLOCK t
                            imes is done with debouncing 
  0000001E            00034 AUTOLOCK_OFF_TIME       EQU             .30                                                             
                                    ;in seconds
  0000003C            00035 SIXTY_MINUTES           EQU             .60                                                             
                                    ;
  0000001E            00036 BACKLIGHT_PERIOD        EQU             .30                                                             
                                    ;seconds
                      00037 
  0000000A            00038 MAX_TEMP                        EQU             .10                                                     
                            ;max setting
                      00039 
  0000001E            00040 BOOST_PERIOD            EQU             .30                                                     ;minutes
  0000001E            00041 SEND_OFF_PERIOD         EQU             .30                                                     ;in minu
                            tes, repeat OFF msg
  000002D0            00042 SEND_ON_PERIOD          EQU             .720                                            ;in seconds, (+ 
                            a random number) for repeat ON msg
  00000001            00043 MSG_PAUSE_PERIOD        EQU             .32*MILLI/LCD_TICK                      ;30 ms betwwen repeats o
                            f the same message
                      00044 
  00000009            00045 HEAT_MSG_COUNTDWN       EQU             .300*MILLI/LCD_TICK                     ;delay before sending th
                            e last heat message
                      00046 
  00000099            00047 BATT_HIGH_THRESHLD      EQU             (.60*.255)/.100                         ;substitute the percent 
                            load (.65) by appropriate number
  00000087            00048 BATT_LOW_THRESHLD       EQU             (.53*.255)/.100                         ;substitute the percent 
                            load (.40) by appropriate number
  0000000C            00049 IDLE_BATTERY_TEST       EQU             .12                                                     ;number 
                            of HOURS in which to perform the battery test if no messages are sent
                      00050 
  00000000            00051 CLKP_NOTHING            EQU             0
  00000001            00052 CLKP_1224                       EQU             1
  00000002            00053 CLKP_MIN_ADJ            EQU             2
  00000003            00054 CLKP_HOUR_ADJ           EQU             3
  00000024            00055 CLKP_HOUR_DISP24        EQU             0x24                                            ;in BCD for disp
                            laying during adjustments
  00000012            00056 CLKP_HOUR_DISP12        EQU             0x12                                            ;in BCD for disp
                            laying during adjustments
  00000018            00057 CLKP_HOUR_24            EQU             .24                                                     ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000000C            00058 CLKP_HOUR_12            EQU             .12                                                     ;
                      00059 ;
  00000000            00060 AUTO_OFF_OFF            EQU             .0                                                      ;
  00000001            00061 AUTO_OFF_1HR            EQU             .1                                                      ;in hour
                            s
  00000003            00062 AUTO_OFF_3HR            EQU             .3                                                      ;
  0000000C            00063 AUTO_OFF_12HR           EQU             .12                                                     ;
                      00064 
  00000030            00065 MESSAGE_LENGTH          EQU             .48                                                     ;packet 
                            length
  00000002            00066 REXMIT_NORMAL           EQU             .2                                                      ;number 
                            of times to resend the message
  00000003            00067 REXMIT_EXTEND           EQU             .3                                                      ;learn a
                            nd refresh
                      00068 
                      00069 #define TXENBL_TRIS     TRISA,0                                                         ;switch the TX_E
                            NABLE port when not in use
                      00070 
                      00071 ;Port assignment
                      00072 #define TX_ENABLE       PORTA,0
                      00073 #define LCD7            PORTA,1
                      00074 #define COM2            PORTA,2
                      00075 #define KB0                     PORTA,3
                      00076 #define LCD4            PORTA,4
                      00077 #define LCD5            PORTA,5
                      00078 #define                         PORTA6  "NOT USED"
                      00079 #define                         PORTA7  "NOT USED"
                      00080 #define MASKTA          b'11000001'                                                     ;TX_ENABLE in IN
                            PUT
                      00081 ;
                      00082 #define LCD0            PORTB,0
                      00083 #define LCD1            PORTB,1
                      00084 #define LCD2            PORTB,2
                      00085 #define LCD3            PORTB,3
                      00086 #define COM0            PORTB,4
                      00087 #define COM1            PORTB,5
                      00088 #define BACKLIGHT       PORTB,6
                      00089 #define LED1            PORTB,7
                      00090 #define MASKTB          b'00000000'
                      00091 ;
                      00092 #define                         PORTC0  "DONT KNOW"
                      00093 #define                         PORTC1  "DONT KNOW"
                      00094 #define                         PORTC2  "DONT KNOW"
                      00095 #define LCD6            PORTC,3
                      00096 #define LCD11           PORTC,4
                      00097 #define LCD10           PORTC,5
                      00098 #define LCD9            PORTC,6
                      00099 #define LCD8            PORTC,7
                      00100 #define MASKTC          b'00000111'
                      00101 ;
                      00102 #define COM3            PORTD,0
                      00103 #define KB1                     PORTD,1
                      00104 #define KB2                     PORTD,2
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00105 #define KB3                     PORTD,3
                      00106 #define KB4                     PORTD,4
                      00107 #define KB5                     PORTD,5
                      00108 #define KB6                     PORTD,6
                      00109 #define PWM_HCS         PORTD,7
                      00110 #define MASKTD          b'00111110'
                      00111 ;
                      00112 #define DEBUG_OUT       PORTE,0
                      00113 #define KB7                     PORTE,0
                      00114 #define KB8                     PORTE,1
                      00115 #define VDIODE          PORTE,2
                      00116 #define MCLR            PORTE,3
                      00117 #define MASKTE          b'11111110'
                      00118 
                      00119 ;******* FLAGS ********* LOOK OUT FOR BANK CHANGES *********************
                      00120 #DEFINE MINUTES                 LCD_CHAR1,0                     ; LCD_CHAR1 IS THE COMMON BANK
                      00121 #DEFINE HOURS                   LCD_CHAR1,1                     ;
                      00122 #DEFINE ONEHR                   LCD_CHAR1,2                     ;characters to be displayed in the LCD 
                      00123 #DEFINE THREEHR                 LCD_CHAR1,3                     ;
                      00124 #DEFINE TWELVEHR                LCD_CHAR1,4                     ;
                      00125 #DEFINE TEMPETR                 LCD_CHAR1,5                     ;
                      00126 #DEFINE LOCKED                  LCD_CHAR1,6                     ;
                      00127 #DEFINE BATTLOW                 LCD_CHAR1,7                     ;
                      00128 
                      00129 #DEFINE DEVON                   LCD_CHAR2,0                     ; LCD_CHAR2 IS IN THE COMMON BANK
                      00130 #DEFINE DEVOFF                  LCD_CHAR2,1                     ;
                      00131 #DEFINE BOOST                   LCD_CHAR2,2                     ;
                      00132 #DEFINE LCD_UPD                 LCD_CHAR2,3                     ;time to update the real time clock coun
                            ters
                      00133 #DEFINE LED1_STATE              LCD_CHAR2,4                     ;LED1 flashes for.3 secs/3secs
                      00134 #DEFINE PLUS_BUT                LCD_CHAR2,5                     ;
                      00135 #DEFINE MINUS_BUT               LCD_CHAR2,6                     ;
                      00136 #DEFINE ADJUST_RT               LCD_CHAR2,7                     ;
                      00137 
                      00138 #DEFINE DEBOUNCING              LCD_CHAR3,0                     ; LCD_CHAR3 IS IN BANK 0
                      00139 #DEFINE BTN_ACT_PDG             LCD_CHAR3,1                     ;button action in progress
                      00140 #DEFINE MODE_ACT                LCD_CHAR3,2                     ;on-going MODE change 
                      00141 #DEFINE CLCKSET_ACT             LCD_CHAR3,3                     ;now changing the clock
                      00142 #DEFINE UNLOCKING               LCD_CHAR3,4                     ;now in process of unlocking
                      00143 #DEFINE HEAT_ACT                LCD_CHAR3,5                     ;
                      00144 #DEFINE AUTOLOCK_ON     LCD_CHAR3,6                     ;
                      00145 #DEFINE RELOCK_ON               LCD_CHAR3,7                     ;
                      00146 
                      00147 #DEFINE SND_OFF_MSG             LCD_CHAR4,0                     ;LCD_CHAR4 IS IN BANK 0
                      00148 #DEFINE SND_ON_MSG              LCD_CHAR4,1                     ;messages to the base
                      00149 #DEFINE SND_BOOSTON_MSG LCD_CHAR4,2                     ;
                      00150 #DEFINE SND_BOO_OFF_MSG LCD_CHAR4,3                     ;
                      00151 #DEFINE SND_TEMP_MSG    LCD_CHAR4,4                     ;
                      00152 #DEFINE SND_LEARN_MSG   LCD_CHAR4,5                     ;
                      00153 #DEFINE SND_TEST_MSG    LCD_CHAR4,6                     ;
                      00154 #DEFINE SND_REFRESH_MSG LCD_CHAR4,7
                      00155 
                      00156 #DEFINE BEEPER                  LCD_CHAR5,0                     ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00157 #DEFINE BATTERY_WARN    LCD_CHAR5,1                     ;warnings for the battery charge level
                      00158 #DEFINE BATTERY_LOW             LCD_CHAR5,2                     ;
                      00159 #DEFINE BOOST_ACT               LCD_CHAR5,3                     ;pre-heat
                      00160 #DEFINE F_BODY_GUARD    LCD_CHAR5,4                     ;DISABLE KB0 CONTROL
                      00161 ;
                      00162 #DEFINE SPARE                   NEW_BUTTON_CONFIG,0                     ;KB8
                      00163 #DEFINE PREHEAT                 NEW_BUTTON_CONFIG,1             ;KB1
                      00164 #DEFINE MODE                    NEW_BUTTON_CONFIG,2             ;KB2    
                      00165 #DEFINE MINUS                   NEW_BUTTON_CONFIG,3             ;KB3
                      00166 #DEFINE PLUS                    NEW_BUTTON_CONFIG,4             ;KB4
                      00167 #DEFINE CLOCK_SET               NEW_BUTTON_CONFIG,5             ;KB5
                      00168 #DEFINE S_KB6                   NEW_BUTTON_CONFIG,6
                      00169 #DEFINE S_KB7                   NEW_BUTTON_CONFIG,7
                      00170 
                      00171 
                      00172 
                      00173 
                      00024 
                      00025 ;********************** INCLUDE FOR TX HANDLING **************************
                      00026 ;        #include   <hcs_tx.inc> AT THE BOTTOM OF THIS CODE
                      00027 ;********************** INCLUDE FOR TX HANDLING **************************
                      00028 
                      00029         
2007   3CE4           00030         __CONFIG _FCMEN_ON & _IESO_ON & _CP_OFF & _WDT_OFF & _BOD_OFF & _MCLRE_ON & _PWRTE_ON & _INTRC_O
                            SC_NOCLKOUT
2000   0000 0001 0001 00031         __IDLOCS        0110    ;1.1.0
       0000 
                      00032         ERRORLEVEL -302
                      00033 
                      00034 
                      00035 ;******* INTERRUPT FLAGSS *************************************************
                      00036 #DEFINE TMR1_IF         PIR1,TMR1IF     ;(0) TMR1 INTERRUPT OCCURRED
                      00037 #DEFINE LCD_IF          PIR2,LCDIF      ;(4) LCD INTERRUPT OCCURRED
                      00038 ;******* ADCON0 *************************************************
                      00039 #DEFINE GO_DONE         ADCON0,1        ;(1)    1 = CONVERSION IN PROGRESS                              
                                                            
                      00040                                                                 ;               0 = CONVERSION DONE
                      00041 ;******* FOR INCLUDED CODE TX_HCS ******************************
                      00042 #DEFINE TMR_HCS_ON      _TMR1ON
                      00043 ;definitions for TX_HCS:
                      00044 #DEFINE BANK1   BSF     STATUS,RP0
                      00045 #DEFINE BANK0   BCF     STATUS,RP0
                      00046 #DEFINE RAM1    BSF     STATUS,RP0
                      00047 #DEFINE RAM0    BCF     STATUS,RP0
                      00048 #DEFINE RAM_1   BSF     STATUS,RP0
                      00049 #DEFINE RAM_0   BCF     STATUS,RP0
                      00050 #DEFINE SET     BSF
                      00051 #DEFINE CANC    BCF
                      00052 #DEFINE SC      BTFSC
                      00053 #DEFINE SS      BTFSS
                      00054 #DEFINE IFSET   BTFSC
                      00055 #DEFINE IFCANC  BTFSS
                      00056 #DEFINE SKPB    SKPNC
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00057 #DEFINE SKPNB   SKPC
                      00058 #DEFINE FW      MOVFW
                      00059 #DEFINE WF      MOVWF
                      00060 #DEFINE LW      MOVLW
                      00061 ;*** INTCON ***
                      00062 #DEFINE _INTE   INTCON,INTE
                      00063 #DEFINE _INTF   INTCON,INTF
                      00064 #DEFINE _GIE    INTCON,GIE
                      00065 #DEFINE _T0IE   INTCON,T0IE
                      00066 #DEFINE _T0IF   INTCON,T0IF
                      00067 #DEFINE _PEIE   INTCON,PEIE
                      00068 
                      00069 #DEFINE TRASMISSIONE_HCS        FLAGS_HCS,0     ;
                      00070 #DEFINE ALTO1_BASSO0            FLAGS_HCS,1     ;FLAG DA INVERTIRE CHE DETERMINA TE2
                      00071 
                      00072 ;#DEFINE        PWM_HCS         PORTD,7 ;PIN DI TRASMISSIONE HCS  <== new in electric blanket
                      00073 
                      00074 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00075 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00076 ;++++++++++++++++++++ DATA +++++++++++++++++++++++++++++++++++++++++
                      00077 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00078 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00079 
                      00080 ;BANK 0 VARIABLES       **************************************************
                      00081                 CBLOCK  020H
  00000020            00082 TEMP_BYT0_B0                                    ;general purpose for bank0
  00000021            00083 TEMP_BYT1_B0                                    ;general purpose for bank0
  00000022            00084 LED1_CLOCK                                      ;
  00000023            00085 RT_SECONDS                                      ;real time seconds counter
  00000024            00086 RT_MINUTES                                      ;       "               minutes   "
  00000025            00087 RT_HOURS                                        ;       "               hours     "
  00000026            00088 DEBOUNCE_CNT                                    ;debounce count
  00000027            00089 BACKLIGHT_CNT                                   ;
  00000028            00090 BLINK_COUNT                                     ;delay for blinking the display
  00000029            00091 NEW_BUTTON_CONFIG                               ;configuration of the buttons when they are read
  0000002A            00092 OLD_BUTTON_CONFIG                               ;OLD configuration of the buttons
  0000002B            00093 LCD_CHAR3                                       ;all purpose flags
  0000002C            00094 LCD_CHAR4                                       ;more flags
  0000002D            00095 LCD_CHAR5                                       ;more flags (MISC, NOT USED)
  0000002E            00096 ADJUST_CLK_PHASE                                ;
  0000002F            00097 MAX_HOURS                                       ;CLOCK turn over
  00000030            00098 RE_LOCK_TIME                                    ;RE LOCK TIMER
  00000031            00099 AUTO_OFF_HOURS                                  ;1, 3 or 12 hr AUTO SHUT-OFF timer
  00000032            00100 AUTO_OFF_MINUTES                                ;AUTO SHUT-OFF minutes count down
  00000033            00101 BOOST_MINUTES                                   ;minutes, counter of PRE-HEAT minutes
  00000034            00102 SAVED_TEMPERATURE                               ;save the temp when AUTO-OFF timer is is turned off
  00000035            00103 PRE_MESSAGE_TIMER                               ;wait time before sending a HEAT message
  00000036            00104 REXMIT_COUNT                                    ;
  00000037            00105 RESEND_OFF_COUNT                                ;counter for resending the OFF msg (15')
  00000038            00106 RESEND_ON_COUNT_L                               ;counter for resending the ON msg (15' -> 900secs)
  00000039            00107 RESEND_ON_COUNT_H                               ;
  0000003A            00108 PAUSE_COUNT                                     ;counter delays in
  0000003B            00109 BATTERY_BLINK_COUNT                             ;counter blinks the battery segment
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000003C            00110 IDLE_BATT_COUNT                                 ;number of hours after which the test message is sent wh
                            en no other tranmissions
  0000003D            00111 BAT_OFF_MSG_COUNT                               ;this is a stop to endless sends of the OFF msg on low b
                            attery.
                      00112 ;=====================================================
                      00113 ; BUFFER DI TRASMISSIONE HCS
  0000003E            00114 HCS1                                            ;reserved(7:5), left/right side (4),serial number high (
                            3:0)
  0000003F            00115 HCS2                                            ;serial number(7:0)
  00000040            00116 HCS3                                            ;serial number(7:0)
  00000041            00117 HCS4                                            ;serial number(7:0) low
  00000042            00118 HCS5                                            ;level(7:3),beep(2),learn(1), padding(0)
  00000043            00119 HCS6                                            ;checksum
  00000044            00120 FLAGS_HCS
  00000045            00121 FASE_TX_HCS
  00000046            00122 CARICA_TIMER_HCS_HI
  00000047            00123 CARICA_TIMER_HCS_LO
  00000048            00124 PUNTA_HCS
  00000049            00125 COUNT_BIT
  0000004A            00126 TEMP_ROTATE
  0000004B            00127 COUNT_PREAMBOLO
  0000004C            00128 BI_STATUS
  0000004D            00129 BI_PCLATH
  0000004E            00130 BI_FSR
                      00131                 ENDC
                      00132 
                      00133 ;COMMON DATA            **************************************************
                      00134                 CBLOCK  71H
  00000071            00135 LCD_CHAR1                                       ;flags to discriminate characters in the display
  00000072            00136 LCD_CHAR2                                       ;all purpose flags
  00000073            00137 MIN_VALUE                                       ;minutes to write on the display [0:60]
  00000074            00138 HOUR_VALUE                                      ;hours to write on the display [0:24]
  00000075            00139 TMPTR_VALUE                                     ;temperature to write on the display [0:24]
  00000076            00140 BI_WREG                                         ;save wreg in ISR
                      00141                 ENDC
                      00142 
                      00143 ;BANK 2 VARIABLES       **************************************************
                      00144                 CBLOCK  0120H
  00000120            00145 WR_ERRORS                                       ;
  00000121            00146 WR_NOERRORS                                     ;
  00000122            00147 TOGGLE_LCD                                      ;
  00000123            00148 TEMP_BYT0_B2                                    ;general purpose for bank2
  00000124            00149 TEMP_BYT1_B2                                    ;general purpose for bank2
                      00150                 ENDC
                      00151 
                      00152 ;-- ALIAS HCS_TX -------------------------------------------------------------
                      00153 
                      00154 
  00000001            00155 TMR_HCS EQU     TMR0
  0000004B            00156 HEADER_COUNT    EQU     COUNT_PREAMBOLO
  0000004B            00157 COUNT_DATA      EQU     COUNT_PREAMBOLO
                      00158 
                      00159 
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00160 
                      00161 ;Uncomment to work with ICD2 +++++++++
                      00162 ;#DEFINE DEBUG
                      00163                                                 ;
0000                  00164         ORG     0x000                           ; processor reset vector
0000   018A           00165         clrf    PCLATH                          ; ensure page bits are cleared
0001   281B           00166         goto    main                            ; go to beginning of program
                      00167                                                 ;
                      00168                                                 ;
0004                  00169         org     0x04                            ;
0004                  00170 PUSH:                                           ;
0004   00F6           00171         WF      BI_WREG                         ;COPIA DEL WREG
0005   0E03           00172         SWAPF   STATUS,W                        ;COPIA DELLO STATUS
                      00173         M_BANKSEL_0
0006   1303               M                 BCF     STATUS,6
0007   1283               M                 BCF     STATUS,5
0008   00CC           00174         MOVWF   BI_STATUS
0009   080A           00175         FW      PCLATH
000A   00CD           00176         WF      BI_PCLATH
000B   0804           00177         FW      FSR
000C   00CE           00178         WF      BI_FSR
000D   2B38           00179         B       INTERRUPT
                      00180 
                      00181 
                      00182 ;Begining of executable code    ;
                      00183 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00184 ;Jump table for drawing a character in the LCD
                      00185 ;bit sequence is:  -gfedcba
                      00186 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
000E                  00187 DIGIT_SELECT                                    ;
000E   0782           00188         ADDWF   PCL,F                           ;
000F   343F           00189         RETLW   b'00111111'                     ;"0"            
0010   3406           00190         RETLW   b'00000110'                     ;"1"
0011   345B           00191         RETLW   b'01011011'                     ;"2"            
0012   344F           00192         RETLW   b'01001111'                     ;"3"
0013   3466           00193         RETLW   b'01100110'                     ;"4"
0014   346D           00194         RETLW   b'01101101'                     ;"5"
0015   347D           00195         RETLW   b'01111101'                     ;"6"
0016   3407           00196         RETLW   b'00000111'                     ;"7"
0017   347F           00197         RETLW   b'01111111'                     ;"8"
0018   346F           00198         RETLW   b'01101111'                     ;"9"
0019   3438           00199         RETLW   b'00111000'                     ;"L" (value=10)
001A   3476           00200         RETLW   b'01110110'                     ;"H" (value=11)
                      00201 
                      00202 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00203 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00204 ;++++++++++++++   Start of the Program   ++++++++++++++++++++++++++++++
                      00205 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00206 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
001B                  00207 main                                            ;
                      00208         M_BANKSEL_0                             ;bank 0
001B   1303               M                 BCF     STATUS,6
001C   1283               M                 BCF     STATUS,5
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001D   0064           00209         CLRWDT                                  ;
                      00210 
                      00211 
001E   3040           00212         movlw   AUTOLOCK_DEBOUNCE
001F   3099           00213         movlw   BATT_HIGH_THRESHLD
0020   3087           00214         movlw   BATT_LOW_THRESHLD
0021   3001           00215         movlw   MSG_PAUSE_PERIOD
0022   3003           00216         movlw   LCD_PRESCALE
0023   3040           00217         movlw   LCD_FRAME_FREQ
0024   3009           00218         movlw   PW_ON_PERIOD
0025   3060           00219         movlw   PW_OFF_PERIOD
0026   3006           00220         movlw   DEBOUNCE_PERIOD
                      00221 
                      00222 
0027   3000           00223         MOVLW   b'00000000'                     ;gie off, peripherals off,tmr0 off,RB0 and RB changes of
                            f,flags off
0028   008B           00224         MOVWF   INTCON                          ;
0029   0185           00225         CLRF    PORTA                           ;
002A   0186           00226         CLRF    PORTB                           ;
002B   0187           00227         CLRF    PORTC                           ;
002C   0188           00228         CLRF    PORTD                           ;
002D   0189           00229         CLRF    PORTE                           ;
002E   018C           00230         CLRF    PIR1                            ;clear all interrupt flags
002F   018D           00231         CLRF    PIR2                            ;clear all interrupt flags .......including LCDPS,WA
                      00232                                                 ;
0030   300F           00233         MOVLW   b'00001111'                     ;gate off, 1:1 PS, no sync extr clock,tmr1 on
0031   0090           00234         MOVWF   T1CON                           ;
                      00235                                                 ;
0032   242A           00236         CALL    CLEAR_RAM_0                     ;
0033   2433           00237         CALL    CLEAR_RAM_1                     ;
                      00238                                                 ;       
0034   300C           00239         MOVLW   CLKP_HOUR_12                    ;
0035   00AF           00240         MOVWF   MAX_HOURS                       ;
                      00241                                                 ;
                      00242 ;A/D CONVERTER                                  ;
0036   301C           00243         MOVLW   b'00011100'                     ;LEFT justified,vref,read AN7,A/D powered OFF
0037   009F           00244         MOVWF   ADCON0                          ;
                      00245                                                 ;
                      00246         M_BANKSEL_1                             ;
0038   1303               M                 BCF     STATUS,6
0039   1683               M                 BSF     STATUS,5
003A   3080           00247         MOVLW   b'10000000'                     ;Select AN7 (RE2) analogue input for low battery detecti
                            on
003B   0091           00248         MOVWF   ANSEL                           ;
                      00249                                                 ;
003C   3050           00250         MOVLW   b'01010000'                     ;fosc/16 for conversion
003D   009F           00251         MOVWF   ADCON1                          ;
                      00252                                                 ;
003E   3007           00253         MOVLW   .7                              ;
003F   009C           00254         MOVWF   CMCON0                          ;OFF
                      00255                                                 ;
0040   3061           00256         MOVLW   b'01100001'                     ;4MHz clock,dev is running from int clk,int osc for syst
                            em clock
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0041   008F           00257         MOVWF   OSCCON                          ;
0042   3000           00258         MOVLW   b'00000000'                     ;TMR1 interrupts DISABLED, TMR1IF flag will be polled fo
                            r seconds roll-over
                      00259 ;interrupts and ports                           ;
0043   008C           00260         MOVWF   PIE1                            ;
0044   3000           00261         MOVLW   b'00000000'                     ;LCD interrupt disabled
0045   008D           00262         MOVWF   PIE2                            ;
0046   30C1           00263         MOVLW   MASKTA                          ;
0047   0085           00264         MOVWF   TRISA                           ;
0048   3000           00265         MOVLW   MASKTB                          ;
0049   0086           00266         MOVWF   TRISB                           ;
004A   3007           00267         MOVLW   MASKTC                          ;
004B   0087           00268         MOVWF   TRISC                           ;
004C   303E           00269         MOVLW   MASKTD                          ;
004D   0088           00270         MOVWF   TRISD                           ;
004E   30FE           00271         MOVLW   MASKTE                          ;
004F   0089           00272         MOVWF   TRISE                           ;
                      00273                                                 ;
0050   3080           00274         MOVLW   b'10000000'                     ;no pullups, tmr0 internal, prescale assigned to tmr0,<2
                            :0>=PS tmr0 = 1:2 ***FOR NOW
0051   0081           00275         MOVWF   OPTION_REG                      ;PortA pullups disabled
                      00276                                                 ;
                      00277 ;LCD control registers                          ;
                      00278         M_BANKSEL_2                             ;
0052   1703               M                 BSF     STATUS,6
0053   1283               M                 BCF     STATUS,5
0054   01A0           00279         CLRF    WR_ERRORS                       ;
0055   01A1           00280         CLRF    WR_NOERRORS                     ;
0056   01A2           00281         CLRF    TOGGLE_LCD                      ;
0057   3017           00282         MOVLW   b'00010111'                     ;lcd off, on when sleep,no write error,VLCD enabled,TMR1
                             is source clk,1/4 common
0058   0087           00283         MOVWF   LCDCON                          ; 
                      00284                                                 ;
0059   3080           00285         MOVLW   b'10000000'                     ;waveform B(1),bias 1/3 for 1/4 mux,
005A   3803           00286         IORLW   LCD_PRESCALE                    ;add the prescaler (see TXHeader.h)
005B   0088           00287         MOVWF   LCDPS                           ;  --- with 1:2 PS
                      00288                                                 ;
                      00289 #IFDEF  WAVE_TYPE_B                             ;
005C   3080           00290         MOVLW   WFT_B                           ;waveform B(1),bias 1/3 for 1/4 mux,
                      00291 #ELSE                                           ;
                      00292         MOVLW   WFT_A                           ;waveform A(0),bias 1/3 for 1/4 mux,
                      00293 #ENDIF                                          ;
005D   0488           00294         IORWF   LCDPS,F                         ;
                      00295                                                 ;
005E   30FF           00296         MOVLW   b'11111111'                     ;Sements (7:0) all LCD segments enabled
005F   009C           00297         MOVWF   LCDSE0                          ;
                      00298 #IFDEF DEBUG                                    ;
                      00299         MOVLW   b'11101111'                     ; DEBUG - RB5 and RB6 for ICD2, seg15 <bit5> problems
                      00300 #ELSE                                           ;
0060   300F           00301         MOVLW   b'00001111'                     ;Sements (15:8)  THIS ARE THE REAL FLAGS !!!!!!!!!!
                      00302 #ENDIF                                          ;
0061   009D           00303         MOVWF   LCDSE1                          ;
0062   019E           00304         CLRF    LCDSE2                          ;Sements (23:16) all IO pins ********* LCDSE2 doesn't ex
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ist in 16F913 ***
                      00305                                                 ;
0063   3012           00306         MOVLW   b'00010010'                     ;WDT PS 1:16K, software enable off
0064   0085           00307         MOVWF   WDTCON                          ;
0065   0190           00308         CLRF    LCDDATA0                        ;all segments dark
0066   0191           00309         CLRF    LCDDATA1                        ;
0067   0193           00310         CLRF    LCDDATA3                        ;******** LCDDATA2,LCDDATA5, LCDDATA8 and LCDDATA11 don'
                            t exist in 6F913 ***
0068   0194           00311         CLRF    LCDDATA4                        ;
0069   0196           00312         CLRF    LCDDATA6                        ;
006A   0197           00313         CLRF    LCDDATA7                        ;
006B   0199           00314         CLRF    LCDDATA9                        ;
006C   019A           00315         CLRF    LCDDATA10                       ;
006D   1787           00316         BSF     LCDCON,LCDEN                    ;
                      00317                                                 ;
                      00318         M_BANKSEL_0                             ;
006E   1303               M                 BCF     STATUS,6
006F   1283               M                 BCF     STATUS,5
0070   3060           00319         MOVLW   PW_OFF_PERIOD                   ;LED1 initialized to OFF
0071   00A2           00320         MOVWF   LED1_CLOCK                      ;
0072   1585           00321         BSF     KB0                             ;buttons disabled
0073   3003           00322         MOVLW   b'00000011'                     ;display hours, minutes
0074   00F1           00323         MOVWF   LCD_CHAR1                       ;
0075   3002           00324         MOVLW   b'00000010'                     ;display device OFF
0076   00F2           00325         MOVWF   LCD_CHAR2                       ;Initialize some more local data
0077   15F2           00326         BSF     LCD_UPD                         ;
                      00327                                                 ;
0078   172C           00328         BSF     SND_TEST_MSG                    ;Test the batery by sending a test message
0079   300C           00329         MOVLW   IDLE_BATTERY_TEST               ; and reload the counter
007A   00BC           00330         MOVWF   IDLE_BATT_COUNT                 ;
007B   3001           00331         MOVLW   1                               ;
007C   00BD           00332         MOVWF   BAT_OFF_MSG_COUNT               ;
                      00333 
007D   3001           00334         MOVLW   1
007E   00BA           00335         MOVWF   PAUSE_COUNT                     ;
                      00336 
                      00337 
                      00338 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00339 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00340 ;+++++++++++++++++++++   Main Loop ++++++++++++++++++++++++++++++++++++
                      00341 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00342 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
007F                  00343 _SNOOZE:                                        ;
                      00344         M_BANKSEL_0                             ;
007F   1303               M                 BCF     STATUS,6
0080   1283               M                 BCF     STATUS,5
0081   1009           00345         BCF     DEBUG_OUT                       ;
0082   1844           00346         BTFSC   TRASMISSIONE_HCS                ;if TRASMISSIONE_HCS is set, we're still transmitting
0083   2893           00347         GOTO    _STAY_UP                        ;
0084   18AB           00348         BTFSC   BTN_ACT_PDG                     ;if there is an on-going button action, don't sleep
0085   2893           00349         GOTO    _STAY_UP                        ;
                      00350                                                 ;
0086   0000           00351         NOP                                     ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0087   138B           00352         BCF     INTCON,GIE                      ;
0088   170B           00353         BSF     INTCON,PEIE                     ;
0089   1683           00354         BSF     STATUS,5                        ;BANK 1
008A   160D           00355         BSF     PIE2,LCDIE                      ;set LCD ints to wake up
008B   0000           00356         NOP                                     ;
008C   0000           00357         NOP                                     ;       
                      00358                                                 ;
                      00359         #IFNDEF DEBUG                           ;
008D   0063           00360         SLEEP                                   ;
                      00361         ELSE                                    ;
                      00362         NOP                                     ;
                      00363         #ENDIF                                  ;
008E   0000           00364         NOP                                     ;
008F   0000           00365         NOP                                     ;
0090   120D           00366         BCF     PIE2,LCDIE                      ;
0091   1283           00367         BCF     STATUS,5                        ;BANK 0
0092   130B           00368         BCF     INTCON,PEIE                     ;
0093                  00369 _STAY_UP                                        ;
0093   1E0D           00370         BTFSS   LCD_IF                          ;wait here for lcd interrupt flag
0094   2893           00371         GOTO    _STAY_UP                        ;
                      00372                                                 ;
0095   0000           00373         NOP                                     ;
0096   1409           00374         bsf     DEBUG_OUT                       ;
0097   0000           00375         NOP                                     ;
0098   1C44           00376         BTFSS   TRASMISSIONE_HCS                ;if TRASMISSIONE_HCS is set, we're transmitting somethin
                            g, 
0099   20AD           00377         CALL    SEND_MESSAGES                   ; so go do other jobs
                      00378                                                 ;
009A   0000           00379         NOP                                     ;
009B   0000           00380         NOP                                     ;
009C   0000           00381         NOP                                     ;
009D   0000           00382         NOP                                     ;
009E   234C           00383         CALL    UPDATE_LCD                      ;finish any display that may be pending because of even/
                            odd frames
009F   22C6           00384         CALL    REAL_TIME_SERVICES              ;see if TMR1 expired in the meantime
                      00385                                                 ;
00A0   303E           00386         MOVLW   b'00111110'                     ;handle ALL ACTIONS which are in progress
00A1   052B           00387         ANDWF   LCD_CHAR3,W                     ;
00A2   1D03           00388         BTFSS   STATUS,Z                        ;
00A3   2125           00389         CALL    HANDLE_BUTTONS                  ;
                      00390                                                 ;
00A4   192D           00391         BTFSC   BATTERY_LOW                     ;block all actions of the batteries are low
00A5   287F           00392         GOTO    _SNOOZE                         ;
00A6   1CAB           00393         BTFSS   BTN_ACT_PDG                     ;accept new jobs only if no other job is pending
00A7   2267           00394         CALL    TEST_BUTTONS                    ;
                      00395                                                 ;
00A8   2329           00396         CALL    DISPLAY_REAL_TIME               ;Load Real Time variables for display in the LCD
00A9   22A5           00397         CALL    MANAGE_LED1                     ;
00AA   22B4           00398         CALL    TREAT_BATTERY_DISPLAY           ;
00AB   234C           00399         CALL    UPDATE_LCD                      ;
00AC   287F           00400         GOTO    _SNOOZE                         ;
                      00401 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00402 ;Handles message sending to the BASE unit. 
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00403 ;BEEPER bit must be in the correct state
                      00404 ;Message layout:
                      00405 ;HCS1   BIT 75         0               RESERVED, FORCED TO ZERO
                      00406 ;HCS1   BIT 4           01             LEFT/RIGHT SIDE
                      00407 ;HCS1   BIT 30         0F             SERIAL NUMBER HIGH
                      00408 ;HCS2   BIT 70         00FF   SERIAL NUMBER
                      00409 ;HCS3   BIT 70         00FF   SERIAL NUMBER
                      00410 ;HCS4   BIT 70         00FF   SERIAL NUMBER LOW
                      00411 ;HCS5   BIT 73         000A   LEVEL CODE
                      00412 ;HCS5   BIT 2           01             BEEPER
                      00413 ;HCS5   BIT 1           0-1             LEARN MODE ON/OFF
                      00414 ;HCS5   BIT 0           0               PADDING
                      00415 ;HCS6   BIT 70         00FF   CHECKSUM
                      00416 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00417 ;-----------------------------------------------;---------------- THIS PROJECT'S TEST MODIFICATIONS: ---
                            ------
00AD                  00418 SEND_MESSAGES                                   ;
00AD   1844           00419         BTFSC   TRASMISSIONE_HCS                ;If we are not finished xmitting, leave
00AE   2924           00420         GOTO    _MSG_FIN                        ;don't start a new one
                      00421                                                 ;
00AF   1971           00422         BTFSC   ONEHR                           ;
00B0   28B4           00423         GOTO    _ONE_HOURMSG                    ;
00B1   19F1           00424         BTFSC   THREEHR                         ;
00B2   28BB           00425         GOTO    _THREE_HOURMSG                  ;
00B3   28C2           00426         GOTO    _TWELVE_HOURMSG                 ;12hr or OFF
                      00427                                                 ;
00B4                  00428 _ONE_HOURMSG                                    ;
00B4   0BBA           00429         DECFSZ  PAUSE_COUNT,F                   ;
00B5   2924           00430         GOTO    _MSG_FIN                        ;in this mode, respect the pause between messages but co
                            ntinue
                      00431                                                 ; to send them ad infinitum
00B6   14AC           00432         BSF     SND_ON_MSG                      ;
00B7   08B6           00433         MOVF    REXMIT_COUNT,F                  ;-used as a flag-
00B8   1903           00434         BTFSC   STATUS,Z                        ;
00B9   28CE           00435         GOTO    _ON_MSG                         ;       
00BA   2917           00436         GOTO    _RE_SEND                        ;
                      00437                                                 ;
00BB                  00438 _THREE_HOURMSG                                  ;
00BB   1005           00439         BCF     TX_ENABLE                       ;
00BC   1683           00440         BANK1                                   ;In this mode just enable (active low) TX_ENABLE
00BD   1005           00441         BCF     TXENBL_TRIS                     ;
00BE   1283           00442         BANK0                                   ;
00BF   1005           00443         BCF     TX_ENABLE                       ;
00C0   1788           00444         BSF     PWM_HCS                         ;hold the RF-TX pin always high
00C1   2924           00445         GOTO    _MSG_FIN                        ;
                      00446                                                 ;
00C2                  00447 _TWELVE_HOURMSG                                 ;
00C2   01B6           00448         CLRF    REXMIT_COUNT                    ;
00C3   1405           00449         BSF     TX_ENABLE                       ;
00C4   1683           00450         BANK1                                   ;
00C5   1405           00451         BSF     TXENBL_TRIS                     ;
00C6   1283           00452         BANK0                                   ;
00C7   1388           00453         BCF     PWM_HCS                         ;hold the RF-TX pin low when not in transmission
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00C8   2924           00454         GOTO    _MSG_FIN                        ;
                      00455 ;-----------------------------------------------;---------------- THIS PROJECT'S TEST MODIFICATIONS: ---
                            ------
                      00456                                                 ;
00C9                  00457 _NEW_MSG                                        ; else
00C9   1C2C           00458         BTFSS   SND_OFF_MSG                     ;check if there are NEW messages to send
00CA   28CE           00459         GOTO    _ON_MSG                         ;
00CB   3000           00460         MOVLW   .0                              ;tempertature = 0
00CC   102C           00461         BCF     SND_OFF_MSG                     ;
00CD   28E8           00462         GOTO    _MSG_CONT1                      ;
00CE                  00463 _ON_MSG                                         ;
00CE   1CAC           00464         BTFSS   SND_ON_MSG                      ;
00CF   28D3           00465         GOTO    _REFRESH_MSG                    ;
00D0   0875           00466         MOVF    TMPTR_VALUE,W                   ;temperature = new temperature
00D1   10AC           00467         BCF     SND_ON_MSG                      ;
00D2   28E8           00468         GOTO    _MSG_CONT1                      ;
00D3                  00469 _REFRESH_MSG                                    ;
00D3   1FAC           00470         BTFSS   SND_REFRESH_MSG                 ;
00D4   28D8           00471         GOTO    _BOOST_ON_MSG                   ;temperature = real temperature
00D5   0875           00472         MOVF    TMPTR_VALUE,W                   ;
00D6   13AC           00473         BCF     SND_REFRESH_MSG                 ;
00D7   28EC           00474         GOTO    _MSG_CONT2                      ;do 5 repetitions
00D8                  00475 _BOOST_ON_MSG                                   ;
00D8   1D2C           00476         BTFSS   SND_BOOSTON_MSG                 ;
00D9   28DD           00477         GOTO    _BOOST_OFF_MSG                  ;
00DA   300A           00478         MOVLW   .10                             ;temperature = max temperature
00DB   112C           00479         BCF     SND_BOOSTON_MSG                 ;
00DC   28E8           00480         GOTO    _MSG_CONT1                      ;
00DD                  00481 _BOOST_OFF_MSG                                  ;
00DD   1DAC           00482         BTFSS   SND_BOO_OFF_MSG                 ;
00DE   28E2           00483         GOTO    _SND_LEARN_MSG                  ;
00DF   0875           00484         MOVF    TMPTR_VALUE,W                   ;temperature = real temperature
00E0   11AC           00485         BCF     SND_BOO_OFF_MSG                 ;
00E1   28E8           00486         GOTO    _MSG_CONT1                      ;
00E2                  00487 _SND_LEARN_MSG                                  ;
00E2   1EAC           00488         BTFSS   SND_LEARN_MSG                   ;
00E3   28E6           00489         GOTO    _SND_TEST_MSG                   ;we need the SND_LEARN_MSG flag down below
00E4   3000           00490         MOVLW   .0                              ;temperature = 0 (don't care)
00E5   28EC           00491         GOTO    _MSG_CONT2                      ;5 repetitions
                      00492                                                 ;
00E6                  00493 _SND_TEST_MSG                                   ;
00E6   1F2C           00494         BTFSS   SND_TEST_MSG                    ;if this is a test message, we will load all the
00E7   2924           00495         GOTO    _MSG_FIN                        ; message parameters but corrupt the checksum to make
                      00496                                                 ; sure the test message is not used by the base
00E8                  00497 _MSG_CONT1                                      ;
00E8   00A0           00498         MOVWF   TEMP_BYT0_B0                    ;save temperature level whiche is in WREG in temp_byt
00E9   3002           00499         MOVLW   REXMIT_NORMAL                   ;new message is ready to send
00EA   00B6           00500         MOVWF   REXMIT_COUNT                    ;Load the repeat counter
00EB   28EF           00501         GOTO    _MSG_CONT3                      ;
                      00502                                                 ;
00EC                  00503 _MSG_CONT2                                      ;
00EC   00A0           00504         MOVWF   TEMP_BYT0_B0                    ;save temperature level whiche is in WREG in temp_byt
00ED   3003           00505         MOVLW   REXMIT_EXTEND                   ;new message is ready to send
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00EE   00B6           00506         MOVWF   REXMIT_COUNT                    ;Load the repeat counter                                
                                                            ;
                      00507                                                 ;
00EF                  00508 _MSG_CONT3                                      ;
00EF   0DA0           00509         RLF     TEMP_BYT0_B0,F                  ;now pack the temperature
00F0   0DA0           00510         RLF     TEMP_BYT0_B0,F                  ;and
00F1   0DA0           00511         RLF     TEMP_BYT0_B0,F                  ;
00F2   30F8           00512         MOVLW   0xF8                            ;clear padding bit
00F3   0520           00513         ANDWF   TEMP_BYT0_B0,W                  ;
00F4   00C2           00514         MOVWF   HCS5                            ;and
00F5   182D           00515         BTFSC   BEEPER                          ;
00F6   1542           00516         BSF     HCS5,2                          ;load beeper
00F7   1AAC           00517         BTFSC   SND_LEARN_MSG                   ;and
00F8   14C2           00518         BSF     HCS5,1                          ;learn bits
                      00519                                                 ;
00F9   102D           00520         BCF     BEEPER                          ;
00FA   12AC           00521         BCF     SND_LEARN_MSG                   ;flags can now be cleared
                      00522                                                 ;
00FB   27FC           00523         CALL    GET_SERIAL_0                    ;msb
00FC   00A0           00524         MOVWF   TEMP_BYT0_B0                    ;
00FD   300F           00525         MOVLW   0x0F                            ;msb is 1 nibble only
00FE   0520           00526         ANDWF   TEMP_BYT0_B0,W                  ;
00FF   04BE           00527         IORWF   HCS1,F                          ;
                      00528                                                 ;
0100   27FD           00529         CALL    GET_SERIAL_1                    ;next msb
0101   00BF           00530         MOVWF   HCS2                            ;
0102   27FE           00531         CALL    GET_SERIAL_2                    ;next msb
0103   00C0           00532         MOVWF   HCS3                            ;
0104   27FF           00533         CALL    GET_SERIAL_3                    ;lsb
0105   00C1           00534         MOVWF   HCS4                            ;
0106   123E           00535         BCF     HCS1,4                          ;Future LEFT/RIGHT indication
                      00536                                                 ;
0107   01C3           00537         CLRF    HCS6                            ;
0108   303E           00538         MOVLW   HCS1                            ;calculate checksum
0109   0084           00539         MOVWF   FSR                             ;
010A   3005           00540         MOVLW   .5                              ;
010B   00A0           00541         MOVWF   TEMP_BYT0_B0                    ;
010C                  00542 _CHKSUM_LOOP                                    ;
010C   0800           00543         MOVF    INDF,W                          ;
010D   07C3           00544         ADDWF   HCS6,F                          ;
010E   0A84           00545         INCF    FSR,F                           ;
010F   0BA0           00546         DECFSZ  TEMP_BYT0_B0,F                  ;
0110   290C           00547         GOTO    _CHKSUM_LOOP                    ;
                      00548                                                 ;
0111   1F2C           00549         BTFSS   SND_TEST_MSG                    ;
0112   2917           00550         GOTO    _RE_SEND                        ;
0113   0AC3           00551         INCF    HCS6,F                          ;corrupt the checksum
0114   132C           00552         BCF     SND_TEST_MSG                    ;
0115   01B6           00553         CLRF    REXMIT_COUNT                    ;send test message only once
0116   2917           00554         GOTO    _RE_SEND                        ;
                      00555                                                 ;
0117                  00556 _RE_SEND                                        ;
0117   1005           00557         BCF     TX_ENABLE                       ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0118   1683           00558         BANK1                                   ;TX_ENABLE should only be output when transmitting
0119   1005           00559         BCF     TXENBL_TRIS                     ;
011A   1283           00560         BANK0                                   ;
011B   1005           00561         BCF     TX_ENABLE                       ;
011C   303C           00562         MOVLW   .60                             ;hard delay 120uS                                       
                                                    
011D   00A0           00563         MOVWF   TEMP_BYT0_B0                    ;
011E                  00564 _LOOP_DELAY                                     ;
011E   0BA0           00565         DECFSZ  TEMP_BYT0_B0,F                  ;
011F   291E           00566         GOTO    _LOOP_DELAY                     ;
0120   178B           00567         BSF     _GIE                            ;enable global ints     for
                      00568                                                 ;
0121   3001           00569         MOVLW   MSG_PAUSE_PERIOD                ;
0122   00BA           00570         MOVWF   PAUSE_COUNT                     ;
0123   243C           00571         CALL    INIZIO_TX_HCS                   ;
0124                  00572 _MSG_FIN                                        ;
0124   0008           00573         RETURN                                  ;
                      00574 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00575 ;Decide which button procedure must handle this button
                      00576 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
0125                  00577 HANDLE_BUTTONS                                  ;
0125   1F2B           00578         BTFSS   AUTOLOCK_ON                     ;
0126   2934           00579         GOTO    _NEXT_HANDLE                    ;if locked
                      00580                                                 ;  then
0127   3004           00581         MOVLW   b'00000100'                     ;
0128   0629           00582         XORWF   NEW_BUTTON_CONFIG,W             ;
0129   1D03           00583         BTFSS   STATUS,Z                        ;when in AUTOLOCK, the debounce timer is 2 seconds!
012A   2932           00584         GOTO    _AUTOLOCK_REJECT                ; so on first detection of the MODE key, we
012B   132B           00585         BCF     AUTOLOCK_ON                     ; can remove the LOCK
012C   17AB           00586         BSF     RELOCK_ON                       ; and 
012D   301E           00587         MOVLW   AUTOLOCK_OFF_TIME               ; prepare the count to re-lock
012E   00B0           00588         MOVWF   RE_LOCK_TIME                    ;
012F   10AB           00589         BCF     BTN_ACT_PDG                     ;
0130   1371           00590         BCF     LOCKED                          ;
0131   2A3A           00591         GOTO    _DISPLAY_ADJUSTMENTS            ;
                      00592                                                 ;
0132                  00593 _AUTOLOCK_REJECT                                ;
0132   172B           00594         BSF     AUTOLOCK_ON                     ;
0133   2A43           00595         GOTO    _BUTTON_REJECT                  ;
                      00596                                                 ;
0134                  00597 _NEXT_HANDLE                                    ;HANDLE BUTTON ACTIONS.........
0134   19AB           00598         BTFSC   CLCKSET_ACT                     ;clock adjustments?
0135   2992           00599         GOTO    _HANDLE_CLK_SET                 ;
0136   1AAB           00600         BTFSC   HEAT_ACT                        ;check if an action has already been assigned
0137   2A12           00601         GOTO    _HEAT_MSG_ACTION                ;boost adjustments?
                      00602                                                 ;
0138                  00603 _NEW_ACTIONS                                    ;no task has been assigned yet, this may be a new action
                      00604 ;===================================== SEND LEARN MESSAGE ==========
0138   3006           00605         MOVLW   b'00000110'                     ;
0139   0629           00606         XORWF   NEW_BUTTON_CONFIG,W             ;
013A   1D03           00607         BTFSS   STATUS,Z                        ;
013B   293F           00608         GOTO    _PREHEAT                        ;
013C   142D           00609         BSF     BEEPER                          ;beep
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

013D   16AC           00610         BSF     SND_LEARN_MSG                   ;
013E   2A43           00611         GOTO    _BUTTON_REJECT                  ;
                      00612                                                 ;
013F                  00613 _PREHEAT                                        ;
013F   1CA9           00614         BTFSS   PREHEAT                         ;
0140   2953           00615         GOTO    _NEW_MODE                       ;
                      00616                                                 ;
                      00617 ;===================================== NEW BOOST ACTION ==============
0141   1C72           00618         BTFSS   DEVON                           ;accept boost only if the device is on
0142   2A3D           00619         GOTO    _INVALID_BUTTON                 ;
0143   19AD           00620         BTFSC   BOOST_ACT                       ;If the device is already BOOSTing, don't start it again
0144   2A3D           00621         GOTO    _INVALID_BUTTON                 ;
                      00622                                                 ;
0145   15AD           00623         BSF     BOOST_ACT                       ;
0146   152C           00624         BSF     SND_BOOSTON_MSG                 ;
0147   16F1           00625         BSF     TEMPETR                         ;turn on TEMP and BOOST icons
0148   142D           00626         BSF     BEEPER                          ;beep
0149   1572           00627         BSF     BOOST                           ;
014A   300A           00628         MOVLW   .10                             ;display "H"
014B   00F5           00629         MOVWF   TMPTR_VALUE                     ;
014C   301E           00630         MOVLW   BOOST_PERIOD                    ;
014D   00B3           00631         MOVWF   BOOST_MINUTES                   ;start BOOST timer
014E   15F2           00632         BSF     LCD_UPD                         ;
014F   234C           00633         CALL    UPDATE_LCD                      ;
0150   234C           00634         CALL    UPDATE_LCD                      ;
0151   10AB           00635         BCF     BTN_ACT_PDG                     ;
0152   2A40           00636         GOTO    _RESET_RELOCK                   ;
                      00637                                                 ;
0153                  00638 _NEW_MODE                                       ;
0153   1D29           00639         BTFSS   MODE                            ;
0154   2986           00640         GOTO    _NEW_CLKSET                     ;
                      00641 ;======================================= NEW ACTION FOR AUTO-OFF TIMER =====
0155   18F2           00642         BTFSC   DEVOFF                          ;
0156   295E           00643         GOTO    _MODE1HR                        ;
0157   1971           00644         BTFSC   ONEHR                           ;
0158   296D           00645         GOTO    _MODE3HR                        ;
0159   19F1           00646         BTFSC   THREEHR                         ;
015A   2975           00647         GOTO    _MODE12HR                       ;
015B   1A71           00648         BTFSC   TWELVEHR                        ;
015C   297D           00649         GOTO    _MODE_OFF                       ;
015D   2A3D           00650         GOTO    _INVALID_BUTTON                 ;resets flags, resets relock count and goes out
                      00651                                                 ;
015E                  00652 _MODE1HR                                        ;
015E   3001           00653         MOVLW   AUTO_OFF_1HR                    ;THIS IS HOW WE TURN ON THE DEVICE
015F   00B1           00654         MOVWF   AUTO_OFF_HOURS                  ;Step through the different settings
                      00655                                                 ;
0160   0834           00656         MOVF    SAVED_TEMPERATURE,W             ;
0161   00F5           00657         MOVWF   TMPTR_VALUE                     ;
0162   1472           00658         BSF     DEVON                           ;
0163   16F1           00659         BSF     TEMPETR                         ;
0164   10F2           00660         BCF     DEVOFF                          ;
0165   1571           00661         BSF     ONEHR                           ;
0166   11F1           00662         BCF     THREEHR                         ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0167   1271           00663         BCF     TWELVEHR                        ;
0168   14AC           00664         BSF     SND_ON_MSG                      ;Inform the base
0169   142D           00665         BSF     BEEPER                          ;(beep, unit is turned on)
016A   2247           00666         CALL    FILL_RESEND_PERIOD              ;
016B   01B7           00667         CLRF    RESEND_OFF_COUNT                ;don't send off msg
016C   297F           00668         GOTO    _SAVE_MINUTES                   ;
016D                  00669 _MODE3HR                                        ;
016D   3003           00670         MOVLW   AUTO_OFF_3HR                    ;
016E   00B1           00671         MOVWF   AUTO_OFF_HOURS                  ;
016F   1472           00672         BSF     DEVON                           ;
0170   10F2           00673         BCF     DEVOFF                          ;Don't need to inform the base, we'll just keep sending 
                            the refresh msg longer
0171   1171           00674         BCF     ONEHR                           ;
0172   15F1           00675         BSF     THREEHR                         ;
0173   1271           00676         BCF     TWELVEHR                        ;(no beep)
0174   297F           00677         GOTO    _SAVE_MINUTES                   ;
0175                  00678 _MODE12HR                                       ;
0175   300C           00679         MOVLW   AUTO_OFF_12HR                   ;
0176   00B1           00680         MOVWF   AUTO_OFF_HOURS                  ;
0177   1472           00681         BSF     DEVON                           ;
0178   10F2           00682         BCF     DEVOFF                          ;
0179   1171           00683         BCF     ONEHR                           ;
017A   11F1           00684         BCF     THREEHR                         ;
017B   1671           00685         BSF     TWELVEHR                        ;(no beep)
017C   297F           00686         GOTO    _SAVE_MINUTES                   ;
017D                  00687 _MODE_OFF                                       ;
017D   2255           00688         CALL    DEVICE_OFF                      ;
017E   2981           00689         GOTO    _DISP_AUTO_OFF                  ;
                      00690                                                 ;
017F                  00691 _SAVE_MINUTES                                   ;
017F   303C           00692         MOVLW   SIXTY_MINUTES                   ;
0180   00B2           00693         MOVWF   AUTO_OFF_MINUTES                ;minutes count down (hours already loaded in AUTO_OFF_HO
                            URS)
0181                  00694 _DISP_AUTO_OFF                                  ;
0181   15F2           00695         BSF     LCD_UPD                         ;
0182   234C           00696         CALL    UPDATE_LCD                      ;
0183   234C           00697         CALL    UPDATE_LCD                      ;
0184   10AB           00698         BCF     BTN_ACT_PDG                     ;
0185   2A40           00699         GOTO    _RESET_RELOCK                   ;
                      00700                                                 ;
0186                  00701 _NEW_CLKSET                                     ;
0186   1EA9           00702         BTFSS   CLOCK_SET                       ;
0187   2A04           00703         GOTO    _NEW_TEMP_VARS                  ;
                      00704 ;=================================== NEW CLOCK ADJUSTMENTS ACTION ============
0188                  00705 _NEW_CLK_ADJ                                    ;
0188   15AB           00706         BSF     CLCKSET_ACT                     ;start clock adjustment
0189   3002           00707         MOVLW   CLKP_MIN_ADJ                    ;
018A   00AE           00708         MOVWF   ADJUST_CLK_PHASE                ;1st phase of clock adjustment
018B   3010           00709         MOVLW   BLINK_PERIOD                    ;
018C   00A8           00710         MOVWF   BLINK_COUNT                     ;
018D   1471           00711         BSF     MINUTES                         ;
018E   15F2           00712         BSF     LCD_UPD                         ;
018F   234C           00713         CALL    UPDATE_LCD                      ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0190   234C           00714         CALL    UPDATE_LCD                      ;
0191   2A40           00715         GOTO    _RESET_RELOCK                   ;
                      00716 ;===================================================================
0192                  00717 _HANDLE_CLK_SET                                 ;continue setting the clock according to the phase
                      00718         M_CMPL_JE       ADJUST_CLK_PHASE,CLKP_MIN_ADJ,_MIN_ADJUST
0192   082E               M                 movf    ADJUST_CLK_PHASE,w
0193   3A02               M                 xorlw   CLKP_MIN_ADJ
0194   1903               M                 btfsc   STATUS,Z
0195   299B               M                 goto    _MIN_ADJUST
                      00719         M_CMPL_JE       ADJUST_CLK_PHASE,CLKP_HOUR_ADJ,_HR_ADJUST
0196   082E               M                 movf    ADJUST_CLK_PHASE,w
0197   3A03               M                 xorlw   CLKP_HOUR_ADJ
0198   1903               M                 btfsc   STATUS,Z
0199   29CE               M                 goto    _HR_ADJUST
019A   2A3D           00720         GOTO    _INVALID_BUTTON                 ;resets flags, resets relock count and goes out
                      00721                                                 ;
019B                  00722 _MIN_ADJUST                                     ;ADJUST MINUTES
019B   0BA8           00723         DECFSZ  BLINK_COUNT,F                   ;
019C   29A3           00724         GOTO    _NO_BLKMIN                      ;
019D   3001           00725         MOVLW   b'00000001'                     ;toggle MINUTES
019E   06F1           00726         XORWF   LCD_CHAR1,F                     ;
019F   3010           00727         MOVLW   BLINK_PERIOD                    ;
01A0   00A8           00728         MOVWF   BLINK_COUNT                     ;
01A1   15F2           00729         BSF     LCD_UPD                         ;
01A2   234C           00730         CALL    UPDATE_LCD                      ;blink the display
01A3                  00731 _NO_BLKMIN                                      ;
01A3   2267           00732         CALL    TEST_BUTTONS                    ;check for + - buttons
01A4   14AB           00733         BSF     BTN_ACT_PDG                     ;make sure we stay in this loop until debouncing is fini
                            shed
01A5   182B           00734         BTFSC   DEBOUNCING                      ;
01A6   2A40           00735         GOTO    _RESET_RELOCK                   ;
01A7   01AA           00736         CLRF    OLD_BUTTON_CONFIG               ;
                      00737                                                 ;
01A8                  00738 _SKIPMIN                                        ;button was pressed
01A8   1A29           00739         BTFSC   PLUS                            ;+ button
01A9   29AD           00740         GOTO    _ADD_MINUTE                     ;
01AA   19A9           00741         BTFSC   MINUS                           ;- button
01AB   29B7           00742         GOTO    _SUB_MINUTE                     ;
01AC   29C2           00743         GOTO    _MODE_MIN                       ;
01AD                  00744 _ADD_MINUTE                                     ;
01AD   0AA4           00745         INCF    RT_MINUTES,F                    ;
                      00746         M_CMPL_JL RT_MINUTES,.60,_GO1_MIN       ;
01AE   0824               M                 movf    RT_MINUTES,w
01AF   3C3C               M                 sublw   .60     ;k-v1 < 0
01B0   1C03               M                 btfss   STATUS,C
01B1   29B5               M                 goto    $+4
01B2   1903               M                 btfsc   STATUS,Z
01B3   29B5               M                 goto    $+2
01B4   29B6               M                 goto    _GO1_MIN
01B5   01A4           00747         CLRF    RT_MINUTES                      ;
01B6                  00748 _GO1_MIN                                        ;
01B6   29BD           00749         GOTO    _NEW_MINUTES                    ;
01B7                  00750 _SUB_MINUTE                                     ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01B7   08A4           00751         MOVF    RT_MINUTES,F                    ;
01B8   1D03           00752         BTFSS   STATUS,Z                        ;decrement if not zero
01B9   29BC           00753         GOTO    _DECMIN                         ;
01BA   303C           00754         MOVLW   .59+.1                          ;
01BB   00A4           00755         MOVWF   RT_MINUTES                      ;
01BC                  00756 _DECMIN                                         ;
01BC   03A4           00757         DECF    RT_MINUTES,F                    ;
01BD                  00758 _NEW_MINUTES                                    ;
01BD   15F2           00759         BSF     LCD_UPD                         ;
01BE   0824           00760         MOVF    RT_MINUTES,W                    ;
01BF   23F5           00761         CALL    Convert_to_BCD                  ;
01C0   00F3           00762         MOVWF   MIN_VALUE                       ;
01C1   2A40           00763         GOTO    _RESET_RELOCK                   ;
01C2                  00764 _MODE_MIN                                       ;
01C2   1D29           00765         BTFSS   MODE                            ;MODE button pressed?
01C3   2A46           00766         GOTO    _HANDLE_FIN                     ;
01C4   1471           00767         BSF     MINUTES                         ;
01C5   3010           00768         MOVLW   BLINK_PERIOD                    ;stop blinking 12/24 hours
01C6   00A8           00769         MOVWF   BLINK_COUNT                     ;
01C7   3003           00770         MOVLW   CLKP_HOUR_ADJ                   ;go to phase 3, adjust hours
01C8   00AE           00771         MOVWF   ADJUST_CLK_PHASE                ;
01C9   15F2           00772         BSF     LCD_UPD                         ;
01CA   234C           00773         CALL    UPDATE_LCD                      ;
01CB   234C           00774         CALL    UPDATE_LCD                      ;
01CC   14F1           00775         BSF     HOURS                           ;
01CD   2A40           00776         GOTO    _RESET_RELOCK                   ;
                      00777                                                 ;
01CE                  00778 _HR_ADJUST                                      ;ADJUST HOURS
01CE   0BA8           00779         DECFSZ  BLINK_COUNT,F                   ;
01CF   29D6           00780         GOTO    _NO_BLKHR                       ;
01D0   3002           00781         MOVLW   b'00000010'                     ;toggle HOURS bit for blinking
01D1   06F1           00782         XORWF   LCD_CHAR1,F                     ;
01D2   3010           00783         MOVLW   BLINK_PERIOD                    ;
01D3   00A8           00784         MOVWF   BLINK_COUNT                     ;
01D4   15F2           00785         BSF     LCD_UPD                         ;
01D5   234C           00786         CALL    UPDATE_LCD                      ;
01D6                  00787 _NO_BLKHR                                       ;
01D6   2267           00788         CALL    TEST_BUTTONS                    ;check for adjustments 
01D7   14AB           00789         BSF     BTN_ACT_PDG                     ;make sure we stay in this loop until debouncing is fini
                            shed
01D8   182B           00790         BTFSC   DEBOUNCING                      ; 
01D9   2A40           00791         GOTO    _RESET_RELOCK                   ;
01DA   01AA           00792         CLRF    OLD_BUTTON_CONFIG               ;
                      00793                                                 ;
01DB                  00794 _SKIPHR                                         ;button pressed was:
01DB   1A29           00795         BTFSC   PLUS                            ;+ button
01DC   29E0           00796         GOTO    _ADD_HOUR                       ;
01DD   19A9           00797         BTFSC   MINUS                           ;- button
01DE   29EA           00798         GOTO    _SUB_HOUR                       ;
01DF   29F8           00799         GOTO    _MODE_HOUR                      ;
01E0                  00800 _ADD_HOUR                                       ;
01E0   0AA5           00801         INCF    RT_HOURS,F                      ;
                      00802         M_CMP_JLE RT_HOURS,MAX_HOURS,_GO1_HR    ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01E1   0825               M                 movf    RT_HOURS,w
01E2   022F               M                 subwf   MAX_HOURS,w     ;v2-v1 > 0
01E3   1803               M                 btfsc   STATUS,C
01E4   29E6               M                 goto    $+2
01E5   1903               M                 btfsc   STATUS,Z
01E6   29E9               M                 goto    _GO1_HR
01E7   3001           00803         MOVLW   .1                              ;
01E8   00A5           00804         MOVWF   RT_HOURS                        ;
01E9                  00805 _GO1_HR                                         ;
01E9   29F2           00806         GOTO    _NEW_HOURS                      ;
01EA                  00807 _SUB_HOUR                                       ;
                      00808         M_CMPL_JG RT_HOURS,1,_DECHR
01EA   0825               M                 movf    RT_HOURS,w
01EB   3C01               M                 sublw   1
01EC   1C03               M                 btfss   STATUS,C
01ED   29F1               M                 goto    _DECHR
01EE   300C           00809         MOVLW   CLKP_HOUR_12                    ;...2,1,12,11...
01EF   00A5           00810         MOVWF   RT_HOURS                        ;
01F0   29F2           00811         GOTO    _NEW_HOURS                      ;
01F1                  00812 _DECHR                                          ;
01F1   03A5           00813         DECF    RT_HOURS,F                      ;
01F2                  00814 _NEW_HOURS                                      ;
01F2   14F1           00815         BSF     HOURS                           ;
01F3   15F2           00816         BSF     LCD_UPD                         ;
01F4   0825           00817         MOVF    RT_HOURS,W                      ;
01F5   23F5           00818         CALL    Convert_to_BCD                  ;
01F6   00F4           00819         MOVWF   HOUR_VALUE                      ;
01F7   2A40           00820         GOTO    _RESET_RELOCK                   ;
01F8                  00821 _MODE_HOUR                                      ;
01F8   1D29           00822         BTFSS   MODE                            ;
01F9   2A46           00823         GOTO    _HANDLE_FIN                     ;
01FA   1471           00824         BSF     MINUTES                         ;hour values is being confirmed
01FB   14F1           00825         BSF     HOURS                           ;
01FC   10AB           00826         BCF     BTN_ACT_PDG                     ;
01FD   11AB           00827         BCF     CLCKSET_ACT                     ;
01FE   01AE           00828         CLRF    ADJUST_CLK_PHASE                ;ADJUST_CLK_PHASE = CLKP_NOTHING
01FF   01A3           00829         CLRF    RT_SECONDS                      ;
0200   15F2           00830         BSF     LCD_UPD                         ;
0201   234C           00831         CALL    UPDATE_LCD                      ;
0202   234C           00832         CALL    UPDATE_LCD                      ;
0203   2A40           00833         GOTO    _RESET_RELOCK                   ;
                      00834                                                 ;
                      00835 ;===================================== NEW TEMPERATURES CHANGES ======
0204                  00836 _NEW_TEMP_VARS                                  ;
0204   1C72           00837         BTFSS   DEVON                           ;[$$$] accept heat changes only if the device is on 
0205   2A3D           00838         GOTO    _INVALID_BUTTON                 ;REMOVE THESE 2 LINES IF NOT NEEDED
                      00839                                                 ;
0206   1B2B           00840         BTFSC   AUTOLOCK_ON                     ;
0207   2A3D           00841         GOTO    _INVALID_BUTTON                 ;Temperature variations accepted only if unlocked
                      00842                                                 ;
0208   19AD           00843         BTFSC   BOOST_ACT                       ;If the device is BOOSTing, don't accept temperature cha
                            nges (new requirement)
0209   2A3D           00844         GOTO    _INVALID_BUTTON                 ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00845                                                 ;
020A   1A29           00846         BTFSC   PLUS                            ;
020B   2A0E           00847         GOTO    _ACCEPT_HEAT_CHANGE             ;
020C   1DA9           00848         BTFSS   MINUS                           ;
020D   2A3D           00849         GOTO    _INVALID_BUTTON                 ;
020E                  00850 _ACCEPT_HEAT_CHANGE                             ;
020E   16AB           00851         BSF     HEAT_ACT                        ;make sure we come back to _HEAT_MSG_COUNTING below
020F   16F1           00852         BSF     TEMPETR                         ;
0210   3009           00853         MOVLW   HEAT_MSG_COUNTDWN               ;start the count down
0211   00B5           00854         MOVWF   PRE_MESSAGE_TIMER               ;
0212                  00855 _HEAT_MSG_ACTION                                ;
0212   1A29           00856         BTFSC   PLUS                            ;
0213   2A17           00857         GOTO    _TEMP_INCR                      ;
0214   19A9           00858         BTFSC   MINUS                           ;
0215   2A1F           00859         GOTO    _TEMP_DECR                      ;
0216   2A31           00860         GOTO    _HEAT_MSG_COUNTDOWN             ;countdown if now button pressed
                      00861                                                 ;
0217                  00862 _TEMP_INCR                                      ;
                      00863         M_CMPL_JG TMPTR_VALUE,MAX_TEMP-1,_WRAP_ZERO ;wrap around if we're at min
0217   0875               M                 movf    TMPTR_VALUE,w
0218   3C09               M                 sublw   MAX_TEMP-1
0219   1C03               M                 btfss   STATUS,C
021A   2A1D               M                 goto    _WRAP_ZERO
021B   0AF5           00864         INCF    TMPTR_VALUE,F                   ;
021C   2A27           00865         GOTO    _DELAY_MSG_SEND                 ;
021D                  00866 _WRAP_ZERO                                      ;
021D   01F5           00867         CLRF    TMPTR_VALUE                     ;
021E   2A27           00868         GOTO    _DELAY_MSG_SEND                 ;
                      00869                                                 ;
021F                  00870 _TEMP_DECR                                      ;"-" BUTTON?
                      00871         M_CMPL_JE       TMPTR_VALUE,0,_WRAP_HIGH ;wrap around if we're at max
021F   0875               M                 movf    TMPTR_VALUE,w
0220   3A00               M                 xorlw   0
0221   1903               M                 btfsc   STATUS,Z
0222   2A25               M                 goto    _WRAP_HIGH
0223   03F5           00872         DECF    TMPTR_VALUE,F                   ;
0224   2A27           00873         GOTO    _DELAY_MSG_SEND                 ;
0225                  00874 _WRAP_HIGH                                      ;
0225   300A           00875         MOVLW   MAX_TEMP                        ;
0226   00F5           00876         MOVWF   TMPTR_VALUE                     ;
                      00877                                                 ;
0227                  00878 _DELAY_MSG_SEND                                 ;
0227   0875           00879         MOVF    TMPTR_VALUE,W                   ;
0228   00B4           00880         MOVWF   SAVED_TEMPERATURE               ;
0229   3009           00881         MOVLW   HEAT_MSG_COUNTDWN               ;reload the count down
022A   00B5           00882         MOVWF   PRE_MESSAGE_TIMER               ;
022B   15F2           00883         BSF     LCD_UPD                         ;
022C   234C           00884         CALL    UPDATE_LCD                      ;call twice
022D   234C           00885         CALL    UPDATE_LCD                      ;
022E   01AA           00886         CLRF    OLD_BUTTON_CONFIG               ;
022F   01A9           00887         CLRF    NEW_BUTTON_CONFIG               ;
0230   2A40           00888         GOTO    _RESET_RELOCK                   ;
                      00889                                                 ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0231                  00890 _HEAT_MSG_COUNTDOWN                             ;
0231   0BB5           00891         DECFSZ  PRE_MESSAGE_TIMER,F             ;
0232   2A46           00892         GOTO    _HANDLE_FIN                     ;
0233   14AC           00893         BSF     SND_ON_MSG                      ;
0234   142D           00894         BSF     BEEPER                          ;(beep, on last increment)
0235   12AB           00895         BCF     HEAT_ACT                        ;
0236   10AB           00896         BCF     BTN_ACT_PDG                     ;
0237   2247           00897         CALL    FILL_RESEND_PERIOD              ;
0238   01AA           00898         CLRF    OLD_BUTTON_CONFIG               ;
0239   2A40           00899         GOTO    _RESET_RELOCK                   ;
                      00900 ;===================================================================
023A                  00901 _DISPLAY_ADJUSTMENTS                            ;
023A   15F2           00902         BSF     LCD_UPD                         ;
023B   234C           00903         CALL    UPDATE_LCD                      ;
023C   2A40           00904         GOTO    _RESET_RELOCK                   ;DONE ADJUSTING TIME
                      00905                                                 ;
023D                  00906 _INVALID_BUTTON                                 ;
023D   10AB           00907         BCF     BTN_ACT_PDG                     ;
023E   01A9           00908         CLRF    NEW_BUTTON_CONFIG               ;
023F   01AA           00909         CLRF    OLD_BUTTON_CONFIG               ;
                      00910                                                 ;
0240                  00911 _RESET_RELOCK                                   ;
0240   301E           00912         MOVLW   AUTOLOCK_OFF_TIME               ; RESET THE RE-LOCK counters (even if we're not in autol
                            ock)
0241   00B0           00913         MOVWF   RE_LOCK_TIME                    ;
0242   2A46           00914         GOTO    _HANDLE_FIN                     ;
                      00915                                                 ;
0243                  00916 _BUTTON_REJECT                                  ;
0243   10AB           00917         BCF     BTN_ACT_PDG                     ;
0244   01A9           00918         CLRF    NEW_BUTTON_CONFIG               ;
0245   01AA           00919         CLRF    OLD_BUTTON_CONFIG               ;
0246                  00920 _HANDLE_FIN                                     ;
0246   0008           00921         RETURN                                  ;
                      00922 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00923 ;Fill the RESEND_ON_COUNT with a pseudo random number with a spread that 
                      00924 ;goes from 12' to 15'.
                      00925 ;OUTPUT: RESEND_ON_COUNT_L,RESEND_ON_COUNT_H
                      00926 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
0247                  00927 FILL_RESEND_PERIOD                              ;
0247   3002           00928         MOVLW   HIGH (SEND_ON_PERIOD)           ;
0248   00A1           00929         MOVWF   TEMP_BYT1_B0                    ;
0249   30BF           00930         MOVLW   0xBF                            ;xBF = mask to get a ramdom spread of 191secs (~3mins)
024A   0501           00931         ANDWF   TMR0,W                          ; randomize with value of TMR0
024B   00A0           00932         MOVWF   TEMP_BYT0_B0                    ;
024C   30D0           00933         MOVLW   LOW (SEND_ON_PERIOD)            ;
024D   07A0           00934         ADDWF   TEMP_BYT0_B0,F                  ;
024E   1803           00935         SKPNC                                   ;
024F   0AA1           00936         INCF    TEMP_BYT1_B0,F                  ;       
0250   0820           00937         MOVF    TEMP_BYT0_B0,W                  ;
0251   00B8           00938         MOVWF   RESEND_ON_COUNT_L               ;
0252   0A21           00939         INCF    TEMP_BYT1_B0,W                  ;this INCF is to make the countdown algorithm work fotr 
                            the last FF period
0253   00B9           00940         MOVWF   RESEND_ON_COUNT_H               ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0254   0008           00941         RETURN                                  ;
                      00942 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00943 ;Turn this device off (adjust the LCD accordingly and send an OFF message to 
                      00944 ;the base
                      00945 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
0255                  00946 DEVICE_OFF                                      ;
0255   01B1           00947         CLRF    AUTO_OFF_HOURS                  ;
0256   1072           00948         BCF     DEVON                           ;
0257   1272           00949         BCF     LED1_STATE                      ;
0258   1386           00950         BCF     LED1                            ;make sure LED1 is off when the device goes off
0259   3060           00951         MOVLW   PW_OFF_PERIOD                   ;
025A   00A2           00952         MOVWF   LED1_CLOCK                      ;
025B   12F1           00953         BCF     TEMPETR                         ;
025C   11AD           00954         BCF     BOOST_ACT                       ;
025D   1172           00955         BCF     BOOST                           ;
025E   14F2           00956         BSF     DEVOFF                          ;
025F   1171           00957         BCF     ONEHR                           ;
0260   11F1           00958         BCF     THREEHR                         ;
0261   1271           00959         BCF     TWELVEHR                        ;
0262   142C           00960         BSF     SND_OFF_MSG                     ;
0263   301E           00961         MOVLW   SEND_OFF_PERIOD                 ;
0264   00B7           00962         MOVWF   RESEND_OFF_COUNT                ;
0265   142D           00963         BSF     BEEPER                          ;(beep, change is manual)
0266   0008           00964         RETURN                                  ;
                      00965 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00966 ;Test and debounce push buttons
                      00967 ;NEW_BUTTON_CONFIG<0:7> are mapped as follows: KB7, KB1, KB2, KB3, KB4, KB5, KB6, KB8
                      00968 ;redefined as CLOCK_SET(5),........
                      00969 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
0267                  00970 TEST_BUTTONS                                    ;
                      00971 #IFDEF DEBUG                                    ;
                      00972         M_BANKSEL_2                             ;
                      00973         BCF     LCDSE1,7                        ;SEG15 shared with KB0 (RA3)
                      00974         BCF     STATUS,6                        ;BANK 0
                      00975 #ENDIF                                          ;
0267   10AB           00976         BCF     BTN_ACT_PDG                     ;
0268   1185           00977         BCF     KB0                             ;
0269   3005           00978         MOVLW   5                               ;
026A   00A0           00979         MOVWF   TEMP_BYT0_B0                    ;
026B                  00980 _TB_WAIT                                        ;
026B   0BA0           00981         DECFSZ  TEMP_BYT0_B0,F                  ;forced delay 5us wait for push buttons
026C   2A6B           00982         GOTO    _TB_WAIT                        ;
                      00983                                                 ;
026D   0808           00984         MOVF    PORTD,W                         ;read buttons
026E   00A9           00985         MOVWF   NEW_BUTTON_CONFIG               ;
026F   1729           00986         BSF     NEW_BUTTON_CONFIG,6             ;NOT_USED
0270   17A9           00987         BSF     NEW_BUTTON_CONFIG,7             ;NOT USED.......
0271   1429           00988         BSF     NEW_BUTTON_CONFIG,0             ;NOT USED.......
                      00989                                                                 ;
0272   1A2B           00990         BTFSC   UNLOCKING                       ;if the unlock/relock process is running
0273   2A83           00991         GOTO    _TB_CONT                        ;       don't test the lock button
0274   1BAB           00992         BTFSC   RELOCK_ON                       ;
0275   2A83           00993         GOTO    _TB_CONT                        ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00994                                                 ;
0276   1889           00995         BTFSC   KB8                             ;else
0277   2A7E           00996         GOTO    _TB_UNLOCK                      ;set the lock/unlock 
0278                  00997 _TB_LOCK                                        ;       according the current position 
0278   1B2B           00998         BTFSC   AUTOLOCK_ON                     ;       display if it has changed
0279   2A83           00999         GOTO    _TB_CONT                        ;
027A   172B           01000         BSF     AUTOLOCK_ON                     ;
027B   1771           01001         BSF     LOCKED                          ;
027C   15F2           01002         BSF     LCD_UPD                         ;
027D   2A83           01003         GOTO    _TB_CONT                        ;
027E                  01004 _TB_UNLOCK                                      ;
027E   1F2B           01005         BTFSS   AUTOLOCK_ON                     ;
027F   2A83           01006         GOTO    _TB_CONT                        ;
0280   132B           01007         BCF     AUTOLOCK_ON                     ;
0281   1371           01008         BCF     LOCKED                          ;
0282   15F2           01009         BSF     LCD_UPD                         ;fi;
0283                  01010 _TB_CONT                                        ;
0283   1E2D           01011         BTFSS   F_BODY_GUARD                    ;
0284   1585           01012         BSF     KB0                             ;finished reading buttons
                      01013                                                 ;
0285   30FF           01014         MOVLW   0xFF                            ;
0286   06A9           01015         XORWF   NEW_BUTTON_CONFIG,F             ;invert
                      01016                                                 ;
0287   1C2B           01017         BTFSS   DEBOUNCING                      ;are we debouncing?
0288   2A94           01018         GOTO    _START_DEBOUNCING               ;no
                      01019                                                 ;
0289                  01020 _DEBOUNCING                                     ;yes, waiting for a zero count
                      01021         M_CMP_JNE NEW_BUTTON_CONFIG,OLD_BUTTON_CONFIG,_CLEAR_DEBOUNCE   ;we are debouncing, still the sa
                            me?
0289   0829               M                 movf    NEW_BUTTON_CONFIG,w
028A   062A               M                 xorwf   OLD_BUTTON_CONFIG,w
028B   1D03               M                 btfss   STATUS,Z
028C   2AA3               M                 goto    _CLEAR_DEBOUNCE
028D   0BA6           01022         DECFSZ  DEBOUNCE_CNT,F                  ;
028E   2AA4           01023         GOTO    _BUTTON_END                     ;
028F   1706           01024         BSF     BACKLIGHT                       ;turn backlight on
0290   301E           01025         MOVLW   BACKLIGHT_PERIOD                ;
0291   00A7           01026         MOVWF   BACKLIGHT_CNT                   ;
0292   14AB           01027         BSF     BTN_ACT_PDG                     ;
0293   2AA3           01028         GOTO    _CLEAR_DEBOUNCE                 ;finished debouncing
                      01029                                                 ;
0294                  01030 _START_DEBOUNCING                               ;this would be a first change
                      01031         M_CMP_JE NEW_BUTTON_CONFIG,OLD_BUTTON_CONFIG,_CLEAR_DEBOUNCE ;not debouncing and no change
0294   0829               M                 movf    NEW_BUTTON_CONFIG,w
0295   062A               M                 xorwf   OLD_BUTTON_CONFIG,w
0296   1903               M                 btfsc   STATUS,Z
0297   2AA3               M                 goto    _CLEAR_DEBOUNCE
0298   142B           01032         BSF     DEBOUNCING                      ;start debouncing
0299   0829           01033         MOVF    NEW_BUTTON_CONFIG,W             ;the button pressed or released is here
029A   00AA           01034         MOVWF   OLD_BUTTON_CONFIG               ;
                      01035 
029B   1F2B           01036         BTFSS   AUTOLOCK_ON     
029C   2AA0           01037         GOTO    _NORMAL_DEB_PERIOD
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

029D   3040           01038         MOVLW   AUTOLOCK_DEBOUNCE
029E   00A6           01039         MOVWF   DEBOUNCE_CNT
029F   2AA4           01040         GOTO    _BUTTON_END
02A0                  01041 _NORMAL_DEB_PERIOD
                      01042 
02A0   3006           01043         MOVLW   DEBOUNCE_PERIOD                 ;
02A1   00A6           01044         MOVWF   DEBOUNCE_CNT                    ;
02A2   2AA4           01045         GOTO    _BUTTON_END                     ;
                      01046                                                 ;
02A3                  01047 _CLEAR_DEBOUNCE                                 ;
02A3   102B           01048         BCF     DEBOUNCING                      ;no more debounce
                      01049                                                 ;
02A4                  01050 _BUTTON_END                                     ;
                      01051 #IFDEF DEBUG                                    ;
                      01052         BSF     STATUS,6                        ;BANK 2
                      01053         BSF     LCDSE1,7                        ;SEG15 shared with KB0 (RA3)
                      01054         BCF     STATUS,6                        ;BANK 0
                      01055 #ENDIF                                          ;
02A4   0008           01056         RETURN                                  ;
                      01057 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01058 ;Drive the ON/OFF cycle of LED1
                      01059 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
02A5                  01060 MANAGE_LED1                                     ;
02A5   1C72           01061         BTFSS   DEVON                           ;drive LED only when the device is on
02A6   2AB3           01062         GOTO    _LED1_END                       ;
                      01063                                                 ;
02A7   0BA2           01064         DECFSZ  LED1_CLOCK,F                    ;
02A8   2AB3           01065         GOTO    _LED1_END                       ;
                      01066                                                 ;
02A9   1A72           01067         BTFSC   LED1_STATE                      ;
02AA   2AAF           01068         GOTO    _TURN_LED1_OFF                  ;
                      01069                                                 ;
02AB                  01070 _TURN_LED1_ON                                   ;
02AB   1672           01071         BSF     LED1_STATE                      ;
02AC   1786           01072         BSF     LED1                            ;don't go to sleep while LED1 is ON
02AD   3009           01073         MOVLW   PW_ON_PERIOD                    ;
02AE   2AB2           01074         GOTO    _LED1_SET                       ;
                      01075                                                 ;
02AF                  01076 _TURN_LED1_OFF                                  ;
02AF   1272           01077         BCF     LED1_STATE                      ;
02B0   1386           01078         BCF     LED1                            ;don't go to sleep while LED1 is ON
02B1   3060           01079         MOVLW   PW_OFF_PERIOD                   ;
                      01080                                                 ;
02B2                  01081 _LED1_SET                                       ;
02B2   00A2           01082         MOVWF   LED1_CLOCK                      ;
02B3                  01083 _LED1_END                                       ;
02B3   0008           01084         RETURN                                  ;
                      01085 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01086 ;Treat the battery LCD segment according to its state
                      01087 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
02B4                  01088 TREAT_BATTERY_DISPLAY                           ;
02B4   1CAD           01089         BTFSS   BATTERY_WARN                    ;
02B5   2ABF           01090         GOTO    _BATT_LOW                       ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02B6   0BBB           01091         DECFSZ  BATTERY_BLINK_COUNT,F           ;battery warning
02B7   2AC5           01092         GOTO    _BATT_FIN                       ; decrement the blink counter
02B8   3010           01093         MOVLW   BLINK_PERIOD                    ; when the count reches 0, toggle the bit
02B9   00BB           01094         MOVWF   BATTERY_BLINK_COUNT             ; and display in the LCD
02BA   3080           01095         MOVLW   b'10000000'                     ;
02BB   06F1           01096         XORWF   LCD_CHAR1,F                     ;
02BC   15F2           01097         BSF     LCD_UPD                         ;
02BD   234C           01098         CALL    UPDATE_LCD                      ;
02BE   2AC5           01099         GOTO    _BATT_FIN                       ;
                      01100                                                 ;               
02BF                  01101 _BATT_LOW                                       ;
02BF   1D2D           01102         BTFSS   BATTERY_LOW                     ;
02C0   2AC4           01103         GOTO    _BATT_GOOD                      ;
02C1   17F1           01104         BSF     BATTLOW                         ;battery low
02C2   15F2           01105         BSF     LCD_UPD                         ;
02C3   2AC5           01106         GOTO    _BATT_FIN                       ;
                      01107                                                 ;
02C4                  01108 _BATT_GOOD                                      ;
02C4   13F1           01109         BCF     BATTLOW                         ;
02C5                  01110 _BATT_FIN                                       ;
02C5   0008           01111         RETURN                                  ;
                      01112 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01113 ;Updates the real time clock and the LCD display when necessary
                      01114 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
02C6                  01115 REAL_TIME_SERVICES                              ;
02C6   1C0C           01116         BTFSS   TMR1_IF                         ;if TMR1 rolled over
02C7   2B28           01117         GOTO    _RT_DONE                        ;
                      01118                                                 ;
                      01119 ;============================= SECONDS COUNTERS ===============================
02C8   100C           01120         BCF     TMR1_IF                         ;
02C9                  01121 _RT_SECONDS                                     ;
02C9   0AA3           01122         INCF    RT_SECONDS,F                    ;ticks every 2 seconds at 32K
02CA   0AA3           01123         INCF    RT_SECONDS,F                    ;
                      01124 ;...............................................;
                      01125 ;HANDLE ANY OTHER REAL TIME SECONDS COUNTERS
                      01126 ;...............................................;
02CB   08A7           01127         MOVF    BACKLIGHT_CNT,F                 ;BACKLIGHT OFF
02CC   1903           01128         BTFSC   STATUS,Z                        ;
02CD   2AD4           01129         GOTO    _RESEND_ON_MSG                  ;       
02CE   0BA7           01130         DECFSZ  BACKLIGHT_CNT,F                 ;
02CF   2AD1           01131         GOTO    _BL1                            ;BACKLIGHT OFF time should always be an even number
02D0   2AD3           01132         GOTO    _TURN_OFF_BL                    ; <-- this GOTO in case it was odd
02D1   0BA7           01133 _BL1    DECFSZ  BACKLIGHT_CNT,F                 ;
02D2   2AD4           01134         GOTO    _RESEND_ON_MSG                  ;
02D3                  01135 _TURN_OFF_BL                                    ;
02D3   1306           01136         BCF     BACKLIGHT                       ;
                      01137 ;...............................................;
02D4                  01138 _RESEND_ON_MSG                                  ;periodic ON message
02D4   1C72           01139         BTFSS   DEVON                           ;
02D5   2ADC           01140         GOTO    _RELOCK_SECS                    ;
02D6   0BB8           01141         DECFSZ  RESEND_ON_COUNT_L,F             ;
02D7   2ADC           01142         GOTO    _RELOCK_SECS                    ;
02D8   0BB9           01143         DECFSZ  RESEND_ON_COUNT_H,F             ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02D9   2ADC           01144         GOTO    _RELOCK_SECS                    ;
                      01145                                                 ;
02DA                  01146 _RELOAD_ON_MSG                                  ;
02DA   2247           01147         CALL    FILL_RESEND_PERIOD              ;
02DB   17AC           01148         BSF     SND_REFRESH_MSG                 ;
                      01149 ;...............................................;
02DC                  01150 _RELOCK_SECS                                    ;
02DC   1FAB           01151         BTFSS   RELOCK_ON                       ;RE-LOCK
02DD   2AE7           01152         GOTO    _RT_MINUTES                     ;relock time should always be an even number
02DE   0BB0           01153         DECFSZ  RE_LOCK_TIME,F                  ;
02DF   2AE1           01154         GOTO    $+2                             ;
02E0   2AE3           01155         GOTO    _RELOCK_REACHED                 ;
02E1   0BB0           01156         DECFSZ  RE_LOCK_TIME,F                  ;
02E2   2AE7           01157         GOTO    _RT_MINUTES                     ;
02E3                  01158 _RELOCK_REACHED                                 ;
02E3   1771           01159         BSF     LOCKED                          ;
02E4   15F2           01160         BSF     LCD_UPD                         ;
02E5   172B           01161         BSF     AUTOLOCK_ON                     ;LOCK again
02E6   13AB           01162         BCF     RELOCK_ON                       ;prepare the count till un-lock
                      01163                                                 ;
                      01164 ;============================= MINUTES COUNTERS ===============================
02E7                  01165 _RT_MINUTES                                     ;
                      01166         M_CMPL_JG RT_SECONDS,.59,_INCMIN        ;
02E7   0823               M                 movf    RT_SECONDS,w
02E8   3C3B               M                 sublw   .59
02E9   1C03               M                 btfss   STATUS,C
02EA   2AEC               M                 goto    _INCMIN
02EB   2B28           01167         GOTO    _RT_DONE                        ;
                      01168                                                 ;
02EC                  01169 _INCMIN                                         ;
02EC   01A3           01170         CLRF    RT_SECONDS                      ;REAL TIME MINUTES
02ED   0AA4           01171         INCF    RT_MINUTES,F                    ;
02EE   15F2           01172         BSF     LCD_UPD                         ;minutes have been updated so LCD must be updated also
                      01173 ;...............................................;
02EF                  01174 _RESEND_OFF_MSG                                 ;
02EF   08B7           01175         MOVF    RESEND_OFF_COUNT,F              ;see if OFF msg has to be resent
02F0   1903           01176         BTFSC   STATUS,Z                        ;
02F1   2AF5           01177         GOTO    _AUTOSHUTOFF                    ;
02F2   0BB7           01178         DECFSZ  RESEND_OFF_COUNT,F              ;
02F3   2AF5           01179         GOTO    _AUTOSHUTOFF                    ;
02F4   142C           01180         BSF     SND_OFF_MSG                     ;
                      01181 ;...............................................;
02F5                  01182 _AUTOSHUTOFF                                    ;
02F5   1C72           01183         BTFSS   DEVON                           ;
02F6   2B0B           01184         GOTO    PREHEAT_COUNTDOWN               ;
02F7   0BB2           01185         DECFSZ  AUTO_OFF_MINUTES,F              ;AUTO SHUT-OFF minutes count down
02F8   2B0B           01186         GOTO    PREHEAT_COUNTDOWN               ;
02F9   0BB1           01187         DECFSZ  AUTO_OFF_HOURS,F                ;hours count down
02FA   2AFC           01188         GOTO    _RELOAD_AO_MINUTES              ;
02FB   2AFF           01189         GOTO    _AO_DONE                        ;
02FC                  01190 _RELOAD_AO_MINUTES                              ;
02FC   303C           01191         MOVLW   SIXTY_MINUTES                   ;
02FD   00B2           01192         MOVWF   AUTO_OFF_MINUTES                ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02FE   2B0B           01193         GOTO    PREHEAT_COUNTDOWN               ;
02FF                  01194 _AO_DONE                                        ;
02FF   01B1           01195         CLRF    AUTO_OFF_HOURS                  ;AUTO SHUT-OFF count reached, 
0300   1072           01196         BCF     DEVON                           ;Change the display to "OFF"
0301   12F1           01197         BCF     TEMPETR                         ;
0302   14F2           01198         BSF     DEVOFF                          ;Send and OFF message to the base
0303   1171           01199         BCF     ONEHR                           ;
0304   11F1           01200         BCF     THREEHR                         ;
0305   1271           01201         BCF     TWELVEHR                        ;
0306   142C           01202         BSF     SND_OFF_MSG                     ;(no beep)
0307   301E           01203         MOVLW   SEND_OFF_PERIOD                 ;
0308   00B7           01204         MOVWF   RESEND_OFF_COUNT                ;load counter to repeat the off message after 15'
0309   0875           01205         MOVF    TMPTR_VALUE,W                   ;
030A   00B4           01206         MOVWF   SAVED_TEMPERATURE               ;Save the temperature before going off
                      01207 ;...............................................;
030B                  01208 PREHEAT_COUNTDOWN                               ;
030B   1D72           01209         BTFSS   BOOST                           ;
030C   2B14           01210         GOTO    _RT_HOURS                       ;
                      01211                                                 ;
030D   0BB3           01212         DECFSZ  BOOST_MINUTES,F                 ;PRE-HEAT period minutes count down
030E   2B14           01213         GOTO    _RT_HOURS                       ;
030F   1172           01214         BCF     BOOST                           ;
0310   11AD           01215         BCF     BOOST_ACT                       ;
0311   0834           01216         MOVF    SAVED_TEMPERATURE,W             ;
0312   00F5           01217         MOVWF   TMPTR_VALUE                     ;
0313   15AC           01218         BSF     SND_BOO_OFF_MSG                 ;turn pre heat off in the base
                      01219                                                 ;
                      01220 ;============================= HOURS COUNTERS ===============================
0314                  01221 _RT_HOURS                                       ;
                      01222         M_CMPL_JG RT_MINUTES,.59,_INCHR         ;
0314   0824               M                 movf    RT_MINUTES,w
0315   3C3B               M                 sublw   .59
0316   1C03               M                 btfss   STATUS,C
0317   2B19               M                 goto    _INCHR
0318   2B28           01223         GOTO    _RT_DONE                        ;
0319                  01224 _INCHR                                          ;
0319   01A4           01225         CLRF    RT_MINUTES                      ;0 minutes
031A   0AA5           01226         INCF    RT_HOURS,F                      ;next hour
                      01227         M_CMP_JLE RT_HOURS,MAX_HOURS,_BATTERY_COUNTER
031B   0825               M                 movf    RT_HOURS,w
031C   022F               M                 subwf   MAX_HOURS,w     ;v2-v1 > 0
031D   1803               M                 btfsc   STATUS,C
031E   2B20               M                 goto    $+2
031F   1903               M                 btfsc   STATUS,Z
0320   2B23               M                 goto    _BATTERY_COUNTER
0321   3001           01228         MOVLW   .1                              ;
0322   00A5           01229         MOVWF   RT_HOURS                        ;roll the clock over
                      01230                                                 ;
                      01231 ;...............................................;
0323                  01232 _BATTERY_COUNTER                                ;
0323   0BBC           01233         DECFSZ  IDLE_BATT_COUNT,F               ;
0324   2B28           01234         GOTO    _RT_DONE                        ;
                      01235                                                 ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0325   172C           01236         BSF     SND_TEST_MSG                    ;If the counter is exceeded, send a test message
0326   300C           01237         MOVLW   IDLE_BATTERY_TEST               ; and reload the counter
0327   00BC           01238         MOVWF   IDLE_BATT_COUNT                 ;
                      01239                                                 ;
0328                  01240 _RT_DONE                                        ;
0328   0008           01241         RETURN                                  ;
                      01242 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01243 ;If there are no jobs pending and the display must be cupdated, 
                      01244 ;display move the REal Time info into the variables for the LCD
                      01245 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
0329                  01246 DISPLAY_REAL_TIME                               ;Display the real time in the clock
0329   301F           01247         MOVLW   b'00011111'                     ;unless some action is in progress
032A   052B           01248         ANDWF   LCD_CHAR3,W                     ;
032B   1D03           01249         BTFSS   STATUS,Z                        ;
032C   2B37           01250         GOTO    _TM1ENDEND                      ;(but don't reset LCD_UPDATE)
                      01251                                                 ;
032D   1DF2           01252         BTFSS   LCD_UPD                         ;
032E   2B37           01253         GOTO    _TM1ENDEND                      ;
                      01254                                                 ;
032F   1471           01255         BSF     MINUTES                         ;
0330   0824           01256         MOVF    RT_MINUTES,W                    ;
0331   23F5           01257         CALL    Convert_to_BCD                  ;convert both hours and minutes to BCD
0332   00F3           01258         MOVWF   MIN_VALUE                       ;
                      01259                                                 ;
0333   0825           01260         MOVF    RT_HOURS,W                      ;
0334   23F5           01261         CALL    Convert_to_BCD                  ;convert to BCD
0335   00F4           01262         MOVWF   HOUR_VALUE                      ;
0336   14F1           01263         BSF     HOURS                           ;
0337                  01264 _TM1ENDEND                                      ;
0337   0008           01265         RETURN                                  ;
                      01266 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
0338                  01267 INTERRUPT
                      01268 ;Servo l'interrupt
0338   190B           01269 ISR     BTFSC   _T0IF
0339   1E8B           01270         BTFSS   _T0IE
033A   2B41           01271         B       ISR_X
                      01272 
                      01273 ;=======================================
                      01274 ;*** BASE TEMPI OGNI 204,8 S [(256 (CICLI) * 4 (PRESCALE) / 5 (QUARZO 20 MHZ)]
033B   110B           01275         BCF     _T0IF
                      01276 
033C   1C44           01277         SS      TRASMISSIONE_HCS
033D   2B41           01278         B       ISR_X
                      01279 
033E   30C8           01280         LW      .200
033F   0281           01281         SUBWF   TMR_HCS,F
                      01282 
0340   248A           01283         CALL    GESTIONE_TMR_HCS
                      01284 
                      01285 ;=======================================
0341                  01286 ISR_X
                      01287 POP     M_BANKSEL_0
0341   1303               M                 BCF     STATUS,6
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0342   1283               M                 BCF     STATUS,5
0343   084E           01288         FW      BI_FSR
0344   0084           01289         WF      FSR
0345   084D           01290         FW      BI_PCLATH
0346   008A           01291         WF      PCLATH
0347   0E4C           01292         SWAPF   BI_STATUS,W     ;RIPRISTINO DELLO STATUS
0348   0083           01293         MOVWF   STATUS
0349   0EF6           01294         SWAPF   BI_WREG,F       ;RIPRISTINO DEL WREG
034A   0E76           01295         SWAPF   BI_WREG,W
034B   0009           01296         RETFIE
                      01297 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01298 ;LCD driver
                      01299 ;PARAMETERS: LCD DIGIT,VALUE (when displaying minutes, hours and temp)
                      01300 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
034C                  01301 UPDATE_LCD                                      ;
                      01302         M_BANKSEL_2                             ;
034C   1703               M                 BSF     STATUS,6
034D   1283               M                 BCF     STATUS,5
034E   1387           01303         BCF     LCDCON,LCDEN                    ;this is needed to be able to clear the LCDIF flag
034F   1303           01304         BCF     STATUS,6                        ;bank 0
0350   120D           01305         BCF     LCD_IF                          ;
0351   1703           01306         BSF     STATUS,6                        ;bank 2
0352   1787           01307         BSF     LCDCON,LCDEN                    ;
                      01308                                                 ;
0353   1DF2           01309         BTFSS   LCD_UPD                         ;write only if there is a request
0354   2BF2           01310         GOTO    _LCD_DONE                       ;
                      01311                                                 ;
                      01312 #IFDEF  WAVE_TYPE_B                             ;
0355   3001           01313         MOVLW   1                               ;
0356   06A2           01314         XORWF   TOGGLE_LCD,F                    ;Write only every other frame with WaveType "B"
0357   1903           01315         BTFSC   STATUS,Z                        ;
0358   2BF2           01316         GOTO    _LCD_DONE                       ;
                      01317 #ENDIF                                          ;
                      01318                                                 ;
0359   1E87           01319         BTFSS   LCDCON,WERR                     ;write only if no errors writing to the LCD
035A   2B5E           01320         GOTO    _LCDCONT                        ;
035B   1287           01321         BCF     LCDCON,WERR                     ;
                      01322                                                 ;
035C   1E08           01323         BTFSS   LCDPS,WA                        ;write only if WA (write allowed) flag is set
035D   2BF2           01324         GOTO    _LCD_DONE                       ;
                      01325                                                 ;manage here the character flags an blinking
035E                  01326 _LCDCONT                                        ;
035E   11F2           01327         BCF     LCD_UPD                         ;
035F   0AA1           01328         INCF    WR_NOERRORS,F                   ;FOR DEBUG - bANK 2
0360   0190           01329         CLRF    LCDDATA0                        ;first clear the display
0361   0191           01330         CLRF    LCDDATA1                        ;
0362   0193           01331         CLRF    LCDDATA3                        ;
0363   0194           01332         CLRF    LCDDATA4                        ;
0364   0196           01333         CLRF    LCDDATA6                        ;
0365   0197           01334         CLRF    LCDDATA7                        ;
0366   0199           01335         CLRF    LCDDATA9                        ;
0367   019A           01336         CLRF    LCDDATA10                       ;
                      01337                                                 ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0368   1C71           01338         BTFSS   MINUTES                         ;
0369   2B93           01339         GOTO    _HOURS                          ;
036A   3000           01340         MOVLW   HIGH (DIGIT_SELECT)             ;take care of paging and jump tables
036B   008A           01341         MOVWF   PCLATH                          ;
036C   0873           01342         MOVF    MIN_VALUE,W                     ;
036D   390F           01343         ANDLW   0x0F                            ;
036E   200E           01344         CALL    DIGIT_SELECT                    ;
036F   00A3           01345         MOVWF   TEMP_BYT0_B2                    ;Display units of minutes
0370   1823           01346         BTFSC   TEMP_BYT0_B2,0                  ;
0371   1410           01347         BSF     LCDDATA0,0                      ;4A
0372   18A3           01348         BTFSC   TEMP_BYT0_B2,1                  ;
0373   1413           01349         BSF     LCDDATA3,0                      ;4B
0374   1923           01350         BTFSC   TEMP_BYT0_B2,2                  ;
0375   1416           01351         BSF     LCDDATA6,0                      ;4C
0376   19A3           01352         BTFSC   TEMP_BYT0_B2,3                  ;
0377   1419           01353         BSF     LCDDATA9,0                      ;4D
0378   1A23           01354         BTFSC   TEMP_BYT0_B2,4                  ;
0379   1496           01355         BSF     LCDDATA6,1                      ;4E
037A   1AA3           01356         BTFSC   TEMP_BYT0_B2,5                  ;
037B   1490           01357         BSF     LCDDATA0,1                      ;4F
037C   1B23           01358         BTFSC   TEMP_BYT0_B2,6                  ;
037D   1493           01359         BSF     LCDDATA3,1                      ;4G
                      01360                                                 ;
037E   3000           01361         MOVLW   HIGH (DIGIT_SELECT)             ;take care of paging and jump tables
037F   008A           01362         MOVWF   PCLATH                          ;
0380   0E73           01363         SWAPF   MIN_VALUE,W                     ;
0381   390F           01364         ANDLW   0x0F                            ;
0382   200E           01365         CALL    DIGIT_SELECT                    ;Display tens of minute
0383   00A3           01366         MOVWF   TEMP_BYT0_B2                    ;
0384   1823           01367         BTFSC   TEMP_BYT0_B2,0                  ;
0385   1510           01368         BSF     LCDDATA0,2                      ;3A
0386   18A3           01369         BTFSC   TEMP_BYT0_B2,1                  ;
0387   1513           01370         BSF     LCDDATA3,2                      ;3B
0388   1923           01371         BTFSC   TEMP_BYT0_B2,2                  ;
0389   1516           01372         BSF     LCDDATA6,2                      ;3C
038A   19A3           01373         BTFSC   TEMP_BYT0_B2,3                  ;
038B   1519           01374         BSF     LCDDATA9,2                      ;3D
038C   1A23           01375         BTFSC   TEMP_BYT0_B2,4                  ;
038D   1596           01376         BSF     LCDDATA6,3                      ;3E
038E   1AA3           01377         BTFSC   TEMP_BYT0_B2,5                  ;
038F   1590           01378         BSF     LCDDATA0,3                      ;3F
0390   1B23           01379         BTFSC   TEMP_BYT0_B2,6                  ;
0391   1593           01380         BSF     LCDDATA3,3                      ;3G
0392   1619           01381         BSF     LCDDATA9,4                      ;":"
0393                  01382 _HOURS:                                         ;
0393   1CF1           01383         BTFSS   HOURS                           ;
0394   2BBD           01384         GOTO    _1HR                            ;
0395   3000           01385         MOVLW   HIGH (DIGIT_SELECT)             ;take care of paging and jump tables
0396   008A           01386         MOVWF   PCLATH                          ;
0397   0874           01387         MOVF    HOUR_VALUE,W                    ;
0398   390F           01388         ANDLW   0x0F                            ;
0399   200E           01389         CALL    DIGIT_SELECT                    ;
039A   00A3           01390         MOVWF   TEMP_BYT0_B2                    ;Display units of hours
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

039B   1823           01391         BTFSC   TEMP_BYT0_B2,0                  ;
039C   1610           01392         BSF     LCDDATA0,4                      ;2A
039D   18A3           01393         BTFSC   TEMP_BYT0_B2,1                  ;
039E   1613           01394         BSF     LCDDATA3,4                      ;2B
039F   1923           01395         BTFSC   TEMP_BYT0_B2,2                  ;
03A0   1616           01396         BSF     LCDDATA6,4                      ;2C
03A1   19A3           01397         BTFSC   TEMP_BYT0_B2,3                  ;
03A2   1699           01398         BSF     LCDDATA9,5                      ;2D
03A3   1A23           01399         BTFSC   TEMP_BYT0_B2,4                  ;
03A4   1696           01400         BSF     LCDDATA6,5                      ;2E
03A5   1AA3           01401         BTFSC   TEMP_BYT0_B2,5                  ;
03A6   1690           01402         BSF     LCDDATA0,5                      ;2F
03A7   1B23           01403         BTFSC   TEMP_BYT0_B2,6                  ;
03A8   1693           01404         BSF     LCDDATA3,5                      ;2G
                      01405                                                 ;
03A9   3000           01406         MOVLW   HIGH (DIGIT_SELECT)             ;take care of paging and jump tables
03AA   008A           01407         MOVWF   PCLATH                          ;
03AB   0E74           01408         SWAPF   HOUR_VALUE,W                    ;
03AC   390F           01409         ANDLW   0x0F                            ;
03AD   200E           01410         CALL    DIGIT_SELECT                    ;Display tens of hours
03AE   00A3           01411         MOVWF   TEMP_BYT0_B2                    ;
03AF   1823           01412         BTFSC   TEMP_BYT0_B2,0                  ;
03B0   1790           01413         BSF     LCDDATA0,7                      ;1A
03B1   18A3           01414         BTFSC   TEMP_BYT0_B2,1                  ;
03B2   1793           01415         BSF     LCDDATA3,7                      ;1B
03B3   1923           01416         BTFSC   TEMP_BYT0_B2,2                  ;
03B4   1796           01417         BSF     LCDDATA6,7                      ;1C
03B5   19A3           01418         BTFSC   TEMP_BYT0_B2,3                  ;
03B6   1719           01419         BSF     LCDDATA9,6                      ;1D
03B7   1A23           01420         BTFSC   TEMP_BYT0_B2,4                  ;
03B8   1716           01421         BSF     LCDDATA6,6                      ;1E
03B9   1AA3           01422         BTFSC   TEMP_BYT0_B2,5                  ;
03BA   1710           01423         BSF     LCDDATA0,6                      ;1F
03BB   1B23           01424         BTFSC   TEMP_BYT0_B2,6                  ;
03BC   1713           01425         BSF     LCDDATA3,6                      ;1G
03BD                  01426 _1HR:                                           ;
03BD   1D71           01427         BTFSS   ONEHR                           ;
03BE   2BC0           01428         GOTO    _3HR                            ;
03BF   1799           01429         BSF     LCDDATA9,7                      ;1G
03C0                  01430 _3HR                                            ;
03C0   1DF1           01431         BTFSS   THREEHR                         ;
03C1   2BC3           01432         GOTO    _12HR                           ;
03C2   141A           01433         BSF     LCDDATA10,0                     ;1G
03C3                  01434 _12HR                                           ;
03C3   1E71           01435         BTFSS   TWELVEHR                        ;
03C4   2BC6           01436         GOTO    _TEMPERATURE                    ;
03C5   1499           01437         BSF     LCDDATA9,1                      ;1G
03C6                  01438 _TEMPERATURE                                    ;
03C6   1EF1           01439         BTFSS   TEMPETR                         ;
03C7   2BE3           01440         GOTO    _LOCKED                         ;
                      01441                                                 ;
03C8   0875           01442         MOVF    TMPTR_VALUE,W                   ;
03C9   00A4           01443         MOVWF   TEMP_BYT1_B2                    ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03CA                  01444 _TEMPHIGH                                       ;
                      01445         M_CMPL_JNE TMPTR_VALUE,.10,_TEMP_CONT   ;
03CA   0875               M                 movf    TMPTR_VALUE,w
03CB   3A0A               M                 xorlw   .10
03CC   1D03               M                 btfss   STATUS,Z
03CD   2BD0               M                 goto    _TEMP_CONT
03CE   300B           01446         MOVLW   .11                             ;If 10 display 'H'
03CF   00A4           01447         MOVWF   TEMP_BYT1_B2                    ;
03D0                  01448 _TEMP_CONT                                      ;else normal temp 
03D0   3000           01449         MOVLW   HIGH (DIGIT_SELECT)             ;take care of paging and jump tables
03D1   008A           01450         MOVWF   PCLATH                          ;
03D2   0824           01451         MOVF    TEMP_BYT1_B2,W                  ;
03D3   200E           01452         CALL    DIGIT_SELECT                    ;
03D4   00A3           01453         MOVWF   TEMP_BYT0_B2                    ;
03D5   1823           01454         BTFSC   TEMP_BYT0_B2,0                  ;
03D6   149A           01455         BSF     LCDDATA10,1                     ;5A
03D7   18A3           01456         BTFSC   TEMP_BYT0_B2,1                  ;
03D8   1497           01457         BSF     LCDDATA7,1                      ;5B
03D9   1923           01458         BTFSC   TEMP_BYT0_B2,2                  ;
03DA   1494           01459         BSF     LCDDATA4,1                      ;5C
03DB   19A3           01460         BTFSC   TEMP_BYT0_B2,3                  ;
03DC   1491           01461         BSF     LCDDATA1,1                      ;5D
03DD   1A23           01462         BTFSC   TEMP_BYT0_B2,4                  ;
03DE   1514           01463         BSF     LCDDATA4,2                      ;5E
03DF   1AA3           01464         BTFSC   TEMP_BYT0_B2,5                  ;
03E0   151A           01465         BSF     LCDDATA10,2                     ;5F
03E1   1B23           01466         BTFSC   TEMP_BYT0_B2,6                  ;
03E2   1517           01467         BSF     LCDDATA7,2                      ;5G
03E3                  01468 _LOCKED                                         ;
03E3   1F71           01469         BTFSS   LOCKED                          ;
03E4   2BE6           01470         GOTO    _BATTERY                        ;
03E5   1411           01471         BSF     LCDDATA1,0                      ;
03E6                  01472 _BATTERY                                        ;
03E6   1FF1           01473         BTFSS   BATTLOW                         ;
03E7   2BE9           01474         GOTO    _ON                             ;
03E8   1511           01475         BSF     LCDDATA1,2                      ;
03E9                  01476 _ON                                             ;
03E9   1C72           01477         BTFSS   DEVON                           ;
03EA   2BEC           01478         GOTO    _OFF                            ;
03EB   1414           01479         BSF     LCDDATA4,0                      ;
03EC                  01480 _OFF                                            ;
03EC   1CF2           01481         BTFSS   DEVOFF                          ;
03ED   2BEF           01482         GOTO    _BOOST                          ;
03EE   1594           01483         BSF     LCDDATA4,3                      ;
03EF                  01484 _BOOST                                          ;
03EF   1D72           01485         BTFSS   BOOST                           ;
03F0   2BF2           01486         GOTO    _LCD_DONE                       ;
03F1   1417           01487         BSF     LCDDATA7,0                      ;
03F2                  01488 _LCD_DONE:                                      ;
                      01489         M_BANKSEL_0                             ;
03F2   1303               M                 BCF     STATUS,6
03F3   1283               M                 BCF     STATUS,5
03F4   0008           01490         RETURN                                  ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01491 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01492 ;INPUT:         W in binary
                      01493 ;OUTPUT:        W in BCD
                      01494 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
03F5                  01495 Convert_to_BCD                                  ;
03F5   01A0           01496         CLRF    TEMP_BYT0_B0                    ;bank 0
03F6                  01497 LOOP_BCD:                                       ;
03F6   3EF6           01498         ADDLW   -.10                            ;
03F7   1C03           01499         BTFSS   STATUS,C                        ;
03F8   2BFB           01500         GOTO    SWAPBCD                         ;
03F9   0AA0           01501         INCF    TEMP_BYT0_B0,F                  ;
03FA   2BF6           01502         GOTO    LOOP_BCD                        ;
03FB                  01503 SWAPBCD:                                        ;
03FB   3E0A           01504         ADDLW   .10                             ;
03FC   0EA0           01505         SWAPF   TEMP_BYT0_B0,F                  ;
03FD   0420           01506         IORWF   TEMP_BYT0_B0,W                  ;
03FE   0008           01507         RETURN                                  ;
                      01508 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01509 ;Called from hcs_tx.inc at the end of every message sent.
                      01510 ;Do and A/D conversion to test the battery voltage and decide its
                      01511 ;charge state
                      01512 ;**********************************************************
03FF                  01513 TEST_BATTERY                                    ;
03FF   149F           01514         BSF     GO_DONE                         ;start conversion
0400                  01515 _ADCON_GO                                       ;
0400   189F           01516         BTFSC   GO_DONE                         ;
0401   2C00           01517         GOTO    _ADCON_GO                       ;
                      01518                                                 ;
0402   0000           01519         NOP                                     ;
0403   1585           01520         BSF     KB0                             ;
0404   122D           01521         BCF     F_BODY_GUARD                    ;
0405   0000           01522         NOP                                     ;
                      01523         M_CMPL_JG ADRESH,BATT_HIGH_THRESHLD,_BATTERY_OK;
0406   081E               M                 movf    ADRESH,w
0407   3C99               M                 sublw   BATT_HIGH_THRESHLD
0408   1C03               M                 btfss   STATUS,C
0409   2C1F               M                 goto    _BATTERY_OK
                      01524         M_CMPL_JG ADRESH,BATT_LOW_THRESHLD,_BATTERY_WARNING;
040A   081E               M                 movf    ADRESH,w
040B   3C87               M                 sublw   BATT_LOW_THRESHLD
040C   1C03               M                 btfss   STATUS,C
040D   2C1A               M                 goto    _BATTERY_WARNING
                      01525                                                 ;
040E                  01526 _BATTERY_LOW                                    ;
040E   08BD           01527         MOVF    BAT_OFF_MSG_COUNT,F             ;initialized to one at restart, send this messag from
040F   1903           01528         BTFSC   STATUS,Z                        ;  here only once, than the machine is shutoff anyways
0410   2C23           01529         GOTO    _TESTBATT_DONE                  ;
0411   2255           01530         CALL    DEVICE_OFF                      ;
0412   17F1           01531         BSF     BATTLOW                         ;turn on the LOWBATT symbol, no blink
0413   1071           01532         BCF     MINUTES                         ;turn off hours and minutes also
0414   10F1           01533         BCF     HOURS                           ;
0415   152D           01534         BSF     BATTERY_LOW                     ;
0416   10AD           01535         BCF     BATTERY_WARN                    ;
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0417   15F2           01536         BSF     LCD_UPD                         ;
0418   03BD           01537         DECF    BAT_OFF_MSG_COUNT,F             ;
0419   2C23           01538         GOTO    _TESTBATT_DONE                  ;
041A                  01539 _BATTERY_WARNING                                ;
041A   14AD           01540         BSF     BATTERY_WARN                    ;
041B   112D           01541         BCF     BATTERY_LOW                     ;
041C   3010           01542         MOVLW   BLINK_PERIOD                    ;
041D   00BB           01543         MOVWF   BATTERY_BLINK_COUNT             ;
041E   2C23           01544         GOTO    _TESTBATT_DONE                  ;
                      01545                                                 ;
041F                  01546 _BATTERY_OK                                     ;
041F   13F1           01547         BCF     BATTLOW                         ;
0420   10AD           01548         BCF     BATTERY_WARN                    ;
0421   112D           01549         BCF     BATTERY_LOW                     ;
0422   15F2           01550         BSF     LCD_UPD                         ;
                      01551                                                 ;
0423                  01552 _TESTBATT_DONE                                  ;
0423   300C           01553         MOVLW   IDLE_BATTERY_TEST               ;in all cases reload the idle counter
0424   00BC           01554         MOVWF   IDLE_BATT_COUNT                 ;
0425   0008           01555         RETURN                                  ;
                      01556 ;**********************************************************
                      01557 ;Called during interrupts, message is being sent, start the converter
                      01558 ;**********************************************************
0426                  01559 AD_START                                        ;
0426   162D           01560         SET     F_BODY_GUARD                    ;
0427   1185           01561         BCF     KB0                             ;
0428   141F           01562         BSF     ADCON0,0                        ;START ADCONVERTER
0429   0008           01563         RETURN                                  ;
                      01564 ;**********************************************************
042A                  01565 CLEAR_RAM_0
042A   301F           01566         MOVLW   01FH            ;INIZIO RAM -1
042B   0084           01567         MOVWF   FSR
                      01568 
042C   0A84           01569 PR      INCF    FSR,F
042D   0180           01570         CLRF    INDF
042E   307F           01571         MOVLW   07FH            ;FINE RAM
042F   0604           01572         XORWF   FSR,W
0430   1D03           01573         SKPZ
0431   2C2C           01574         B       PR
                      01575 
0432   0008           01576         RETURN
                      01577 ;******** PULIZIA RAM BANK1 *****************************************
0433                  01578 CLEAR_RAM_1
0433   309F           01579         MOVLW   09FH            ;INIZIO RAM -1
0434   0084           01580         MOVWF   FSR
                      01581 
0435   0A84           01582 PURA1   INCF    FSR,F
0436   0180           01583         CLRF    INDF
0437   30EF           01584         MOVLW   0EFH            ;FINE RAM
0438   0604           01585         XORWF   FSR,W
0439   1D03           01586         SKPZ
043A   2C35           01587         B       PURA1
                      01588 
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

043B   0008           01589         RETURN
                      01590 ;**********************************************************
043C                  01591 ORG_INCLUDES:
                      01592         #include        <hcs_tx.inc>
                      00001 
                      00002 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      00003 ;TRASMISSIONE HCS
                      00004 ;#DEFINE        TMR_HCS_ON      _TMR1ON
                      00005 
                      00006 ;*** MOVED TO TXMain.asm  *************************************************************
                      00007 ;       CBLOCK  
                      00008 ;
                      00009 ;FLAGS_HCS
                      00010 ;
                      00011 ; BUFFER DI TRASMISSIONE HCS
                      00012 ;HCS1                   ;ROLLING CODE
                      00013 ;HCS2                   ;ROLLING CODE
                      00014 ;HCS3                   ;DISCRIMINANTE (LSB)
                      00015 ;HCS4                   ;7:4 CHANNELS, 3:2 OVERFLOW BITS (UNUSED), DISCRIMINANTE (LSB)
                      00016 ;HCS5                   ;SERIAL NUMBER (LSB)
                      00017 ;HCS6                   ;SERIAL NUMBER
                      00018 ;HCS7                   ;SERIAL NUMBER (MSB)
                      00019 ;HCS8                   ;7:4 CHANNELS CODE (S2, S1, S0, S3)
                      00020 ;HCS9                   ;1 REPEAT, 0 LOW BATT
                      00021 ;
                      00022 ;FASE_TX_HCS
                      00023 ;
                      00024 ;CARICA_TIMER_HCS_HI
                      00025 ;CARICA_TIMER_HCS_LO
                      00026 ;
                      00027 ;PUNTA_HCS
                      00028 ;
                      00029 ;COUNT_BIT
                      00030 ;
                      00031 ;TEMP_ROTATE
                      00032 ;
                      00033 ;COUNT_PREAMBOLO
                      00034 ;       ENDC
                      00035 ;-- ALIAS -------------------------------------------------------------
                      00036 ;TMR_HCS        EQU     TMR0
                      00037 ;HEADER_COUNT   EQU     COUNT_PREAMBOLO
                      00038 ;COUNT_DATA     EQU     COUNT_PREAMBOLO
                      00039 ;----------------------------------------------------------------
                      00040 ;
                      00041 ; CODE COMPOSITION INTO TRASMISSION BUFFER
                      00042 ;
                      00043 ;HCS1   BIT 75         0       RESERVED, FORCED TO ZERO
                      00044 ;HCS1   BIT 4           01     LEFT/RIGHT SIDE
                      00045 ;HCS1   BIT 30         0F     SERIAL NUMBER HIGH
                      00046 
                      00047 ;HCS2   BIT 70         00FF   SERIAL NUMBER
                      00048 
                      00049 ;HCS3   BIT 70         00FF   SERIAL NUMBER
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00050 
                      00051 ;HCS4   BIT 70         00FF   SERIAL NUMBER LOW
                      00052 
                      00053 ;HCS5   BIT 73         000A   LEVEL CODE
                      00054 ;HCS5   BIT 2           01     BEEPER
                      00055 ;HCS5   BIT 1           0-1     LEARN MODE ON/OFF
                      00056 ;HCS5   BIT 0           0       PADDING
                      00057 ;HCS6   BIT 70         00FF   CHECKSUM
                      00058 ;MESSGE FOR LEARNING: BIT LEARN =1, SERIAL MUST BE VALID, LEFT/RIGHT, BEEPER ON, THE REST = DON'T CARE
                      00059 ;
                      00060 ; DURATA DI UN TE (TEMPO TIPICO)        400 MICROSECONDI
                      00061 ; DURATA DEL PREAMBOLO                   23 TE ALTERNATI HIGH-LOW-HIGH
                      00062 ; DURATA DEL HEADER                      10 TE LOW (4 MILLISECONDI DI PAUSA)
                      00063 ; DURATA DEL SINGOLO BIT                  3 TE: IL 1 HIGH, IL 3 LOW, IL 2 INVERTITO
                      00064 ;                                               DETERMINA IL DATO
                      00065 ;****** RE-DEFINE PORTD *****************************************
                      00066 ;#DEFINE        PWM_HCS         PORTD,7 ;PIN DI TRASMISSIONE HCS  <== new in electric blanket
                      00067 
                      00068 ;****** FLAGS_HCS *****************************************
                      00069 ;#DEFINE        TRASMISSIONE_HCS        FLAGS_HCS,0     ;
                      00070 ;#DEFINE        ALTO1_BASSO0            FLAGS_HCS,1     ;FLAG DA INVERTIRE CHE DETERMINA TE2
                      00071 
                      00072         IFDEF   NO_COMMENT
                      00073 #DEFINE                 FLAGS_HCS,2     ;
                      00074 #DEFINE                 FLAGS_HCS,3     ;
                      00075 #DEFINE                 FLAGS_HCS,4     ;
                      00076 #DEFINE                 FLAGS_HCS,5     ;
                      00077 #DEFINE         FLAGS_HCS,6     ;
                      00078 #DEFINE         FLAGS_HCS,7     ;
                      00079 
                      00080 ;****** FLAGS_HCS2 *************************************
                      00081 ;#DEFINE                FLAGS_HCS2,0    ;
                      00082 #DEFINE         FLAGS_HCS2,1    ;
                      00083         ENDIF
                      00084 
                      00085 ;*******************************************************
                      00086 
                      00087 
                      00088 ;*******************************************************
                      00089 ;       ORG             ORG_INCLUDES
043C                  00090 INIZIO_TX_HCS
                      00091 ;*** CARICARE BUFFER HCS
                      00092 ;       RAM1
                      00093 
                      00094 
043C   01C5           00095         CLRF    FASE_TX_HCS
043D   3017           00096         MOVLW   .23
043E   00CB           00097         MOVWF   COUNT_PREAMBOLO
                      00098 
043F   303E           00099         LW      HCS1
0440   00C8           00100         WF      PUNTA_HCS
                      00101 
0441   083E           00102         FW      HCS1
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0442   00CA           00103         WF      TEMP_ROTATE
                      00104 
0443   3008           00105         LW      .8
0444   00C9           00106         WF      COUNT_BIT
                      00107 
                      00108         ;LW     0BH             ;COMPARE MODE, TRIGGER SPECIAL EVENT (CCP1 RESETS TMR1)
                      00109         ;WF     CCP1CON
                      00110 
0445   247E           00111         CALL    SET_TMR_TX
0446   1444           00112         SET     TRASMISSIONE_HCS
                      00113 
0447   0008           00114 ITH_X   RETURN
                      00115 ;*******************************************************
                      00116 
                      00117 
                      00118 ;*******************************************************
0448                  00119 FASE_PREAMBOLO
0448   3080           00120         MOVLW   0X80            ;1      ;TRASMISSIONE PREAMBOLO
0449   0688           00121         XORWF   PORTD,F         ;2              <-- gi:(WAS MOVLW 08H , XORWF PORTA,3?)
                      00122 
044A   0BCB           00123         DECFSZ  COUNT_PREAMBOLO,F
044B   2C4F           00124         B       FP_X
                      00125 
044C   300A           00126         MOVLW   .10
044D   00CB           00127         MOVWF   HEADER_COUNT
044E   0AC5           00128         INCF    FASE_TX_HCS,F
                      00129 
044F   2C93           00130 FP_X    B       GTH_X
                      00131 ;*******************************************************
                      00132 
                      00133 
                      00134 ;*******************************************************
0450                  00135 FASE_HEADER
0450   0000           00136         NOP                     ;1
0451   1388           00137         CANC    PWM_HCS         ;2      ;TRASMISSIONE HEADER
                      00138 
0452   0BCB           00139         DECFSZ  HEADER_COUNT,F
0453   2C57           00140         B       FH_X
                      00141 
0454   3030           00142         MOVLW   MESSAGE_LENGTH          ;48 BITS...
0455   00CB           00143         MOVWF   COUNT_DATA
0456   0AC5           00144         INCF    FASE_TX_HCS,F
                      00145 
0457   2C93           00146 FH_X    B       GTH_X
                      00147 ;*******************************************************
                      00148 
                      00149 
                      00150 ;*******************************************************
0458                  00151 FASE_PWM_HI
0458   0000           00152         NOP                     ;1
0459   1788           00153         SET     PWM_HCS         ;2
                      00154 
045A   2470           00155         CALL    CALCOLA_PIN
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

045B   0AC5           00156         INCF    FASE_TX_HCS,F   ;1
                      00157 
045C   034B           00158         DECF    COUNT_DATA,W
045D   1903           00159         SKPNZ
045E   2426           00160         CALL    AD_START                ;(FIRST PUT KB0 TO GROUND,
                      00161 
                      00162 
045F   2C93           00163 FPH_X   B       GTH_X
                      00164 ;*******************************************************
                      00165 ;TURN ON ANALOGICO...
                      00166 ;
                      00167 
                      00168 
                      00169 
                      00170 ;*******************************************************
0460                  00171 FASE_PWM_DATA                   ;IL PIN ARRIVA ALTO...
0460   18C4           00172         IFSET   ALTO1_BASSO0    ;1      ;...SE DEVO TRASMETTERE 1... 
0461   1388           00173         CANC    PWM_HCS         ;2      ;...LO INVERTO,...
                      00174                                 ;...SE DEVO TRASMETTERE 0 LO LASCIO ALTO
0462   0AC5           00175         INCF    FASE_TX_HCS,F
                      00176 
0463   034B           00177         DECF    COUNT_DATA,W
0464   1903           00178         SKPNZ
0465   23FF           00179         CALL    TEST_BATTERY                    ;..REMEMBER TO SHUT OFF)
                      00180 
                      00181 
0466   2C93           00182         B       GTH_X
                      00183 ;*******************************************************
                      00184 
                      00185 
                      00186 ;*******************************************************
0467                  00187 FASE_PWM_LO
0467   0000           00188         NOP                     ;1
0468   1388           00189         CANC    PWM_HCS         ;2
                      00190 
0469   03C5           00191         DECF    FASE_TX_HCS,F
046A   03C5           00192         DECF    FASE_TX_HCS,F
                      00193 
046B   0BCB           00194         DECFSZ  COUNT_DATA,F
046C   2C6F           00195         B       FPL_X
                      00196 
                      00197 
046D   1044           00198         CANC    TRASMISSIONE_HCS
                      00199 
046E   2483           00200         CALL    CANC_TMR_TX
                      00201 
046F   2C93           00202 FPL_X   B       GTH_X
                      00203 ;*******************************************************
                      00204 
                      00205 
                      00206 ;*******************************************************
0470                  00207 CALCOLA_PIN
0470   10C4           00208         CANC    ALTO1_BASSO0
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0471   0CCA           00209         RRF     TEMP_ROTATE,F
0472   1803           00210         SKPNC
0473   14C4           00211         SET     ALTO1_BASSO0
                      00212         
0474   0BC9           00213         DECFSZ  COUNT_BIT,F
0475   2C7D           00214         B       CP_X
                      00215 
0476   0AC8           00216         INCF    PUNTA_HCS,F
0477   0848           00217         FW      PUNTA_HCS
0478   0084           00218         WF      FSR
0479   0800           00219         FW      INDF
047A   00CA           00220         WF      TEMP_ROTATE
                      00221 
047B   3008           00222         MOVLW   .8
047C   00C9           00223         MOVWF   COUNT_BIT
                      00224 
047D   0008           00225 CP_X    RETURN
                      00226 ;*******************************************************
                      00227 
                      00228 
                      00229 ;*******************************************************
047E                  00230 SET_TMR_TX
047E   3038           00231         LW      -.200  ;<----- CAMBIA PRESCALE PER 400uS
047F   0081           00232         WF      TMR_HCS
                      00233 
0480   110B           00234         CANC    _T0IF
0481   168B           00235         SET     _T0IE
                      00236 
0482   0008           00237         RETURN
                      00238 ;*******************************************************
                      00239 
                      00240 
                      00241 ;*******************************************************
0483                  00242 CANC_TMR_TX
                      00243 
0483   128B           00244         CANC    _T0IE
0484   1044           00245         CANC    TRASMISSIONE_HCS
                      00246         
0485   1405           00247         SET     TX_ENABLE
0486   1683           00248         BANK1
0487   1405           00249         BSF     TXENBL_TRIS
0488   1283           00250         BANK0
                      00251 
0489   0008           00252         RETURN
                      00253 ;*******************************************************
                      00254 
                      00255 
                      00256 ;*******************************************************
048A                  00257 GESTIONE_TMR_HCS
048A   3004           00258         LW      HIGH    TAB_FASE_HCS
048B   008A           00259         WF      PCLATH
                      00260         ;ORG
                      00261 
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

048C   0845           00262         FW      FASE_TX_HCS
048D   0782           00263         ADDWF   PCL,F
                      00264 
048E                  00265 TAB_FASE_HCS
048E   2C48           00266         B       FASE_PREAMBOLO  ;0
048F   2C50           00267         B       FASE_HEADER     ;1
0490   2C58           00268         B       FASE_PWM_HI     ;2
0491   2C60           00269         B       FASE_PWM_DATA   ;3
0492                  00270 END_TAB_FASE_HCS
0492   2C67           00271         B       FASE_PWM_LO     ;4
                      00272 
                      00273         IF HIGH(TAB_FASE_HCS) != HIGH(END_TAB_FASE_HCS)
                      00274         ERROR "TAB_COMANDO: OVERFLOW del PCL"
                      00275         ENDIF
                      00276 
0493   0008           00277 GTH_X   RETURN                  ;A INTERRUPT
                      00278 ;*******************************************************
                      00279 
                      00280         IFDEF   NO_COMMENT
                      00281         NOP
                      00282         NOP
                      00283         NOP
                      00284         NOP
                      00285         NOP
                      00286         NOP
                      00287         NOP
                      00288         NOP
                      00289         NOP
                      00290         NOP
                      00291         NOP
                      00292         NOP
                      00293         NOP
                      00294         NOP
                      00295         NOP
                      00296         NOP
                      00297         NOP
                      00298         NOP
                      00299         NOP
                      00300         NOP
                      00301         NOP
                      00302         NOP
                      00303         NOP
                      00304         NOP
                      00305         NOP
                      00306         NOP
                      00307         NOP
                      00308         NOP
                      00309         NOP
                      00310         NOP
                      00311         NOP
                      00312         NOP
                      00313         NOP
                      00314         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00315         NOP
                      00316         NOP
                      00317         NOP
                      00318         NOP
                      00319         NOP
                      00320         NOP
                      00321         NOP
                      00322         NOP
                      00323         NOP
                      00324         NOP
                      00325         NOP
                      00326         NOP
                      00327         NOP
                      00328         NOP
                      00329         NOP
                      00330         NOP
                      00331         NOP
                      00332         NOP
                      00333         NOP
                      00334         NOP
                      00335         NOP
                      00336         NOP
                      00337         NOP
                      00338         NOP
                      00339         NOP
                      00340         NOP
                      00341         NOP
                      00342         NOP
                      00343         NOP
                      00344         NOP
                      00345         NOP
                      00346         NOP
                      00347         NOP
                      00348         NOP
                      00349         NOP
                      00350         NOP
                      00351         NOP
                      00352         NOP
                      00353         NOP
                      00354         NOP
                      00355         NOP
                      00356         NOP
                      00357         NOP
                      00358         NOP
                      00359         NOP
                      00360         NOP
                      00361         NOP
                      00362         NOP
                      00363         NOP
                      00364         NOP
                      00365         NOP
                      00366         NOP
                      00367         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00368         NOP
                      00369         NOP
                      00370         NOP
                      00371         NOP
                      00372         NOP
                      00373         NOP
                      00374         NOP
                      00375         NOP
                      00376         NOP
                      00377         NOP
                      00378         NOP
                      00379         NOP
                      00380         NOP
                      00381         NOP
                      00382         NOP
                      00383         NOP
                      00384         NOP
                      00385         NOP
                      00386         NOP
                      00387         NOP
                      00388         NOP
                      00389         NOP
                      00390         NOP
                      00391         NOP
                      00392         NOP
                      00393         NOP
                      00394         NOP
                      00395         NOP
                      00396         NOP
                      00397         NOP
                      00398         NOP
                      00399         NOP
                      00400         NOP
                      00401         NOP
                      00402         NOP
                      00403         NOP
                      00404         NOP
                      00405         NOP
                      00406         NOP
                      00407         NOP
                      00408         NOP
                      00409         NOP
                      00410         NOP
                      00411         NOP
                      00412         NOP
                      00413         NOP
                      00414         NOP
                      00415         NOP
                      00416         NOP
                      00417         NOP
                      00418         NOP
                      00419         NOP
                      00420         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00421         NOP
                      00422         NOP
                      00423         NOP
                      00424         NOP
                      00425         RETURN
                      00426         NOP
                      00427         NOP
                      00428         NOP
                      00429         NOP
                      00430         NOP
                      00431         NOP
                      00432         NOP
                      00433         NOP
                      00434         NOP
                      00435         NOP
                      00436         NOP
                      00437         NOP
                      00438         NOP
                      00439         NOP
                      00440         NOP
                      00441         NOP
                      00442         NOP
                      00443         NOP
                      00444         NOP
                      00445         NOP
                      00446         NOP
                      00447         NOP
                      00448         NOP
                      00449         NOP
                      00450         NOP
                      00451         NOP
                      00452         NOP
                      00453         NOP
                      00454         NOP
                      00455         NOP
                      00456         NOP
                      00457         NOP
                      00458         NOP
                      00459         NOP
                      00460         NOP
                      00461         NOP
                      00462         NOP
                      00463         NOP
                      00464         NOP
                      00465         NOP
                      00466         NOP
                      00467         NOP
                      00468         NOP
                      00469         NOP
                      00470         NOP
                      00471         NOP
                      00472         NOP
                      00473         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00474         NOP
                      00475         NOP
                      00476         NOP
                      00477         NOP
                      00478         NOP
                      00479         NOP
                      00480         NOP
                      00481         NOP
                      00482         NOP
                      00483         NOP
                      00484         NOP
                      00485         NOP
                      00486         NOP
                      00487         NOP
                      00488         NOP
                      00489         NOP
                      00490         NOP
                      00491         NOP
                      00492         NOP
                      00493         NOP
                      00494         NOP
                      00495         NOP
                      00496         NOP
                      00497         NOP
                      00498         NOP
                      00499         NOP
                      00500         NOP
                      00501         NOP
                      00502         NOP
                      00503         NOP
                      00504         NOP
                      00505         NOP
                      00506         NOP
                      00507         NOP
                      00508         NOP
                      00509         NOP
                      00510         NOP
                      00511         NOP
                      00512         NOP
                      00513         NOP
                      00514         NOP
                      00515         NOP
                      00516         NOP
                      00517         NOP
                      00518         NOP
                      00519         NOP
                      00520         NOP
                      00521         NOP
                      00522         NOP
                      00523         NOP
                      00524         NOP
                      00525         NOP
                      00526         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00527         NOP
                      00528         NOP
                      00529         NOP
                      00530         NOP
                      00531         NOP
                      00532         NOP
                      00533         NOP
                      00534         NOP
                      00535         NOP
                      00536         NOP
                      00537         NOP
                      00538         NOP
                      00539         NOP
                      00540         NOP
                      00541         NOP
                      00542         NOP
                      00543         NOP
                      00544         NOP
                      00545         NOP
                      00546         NOP
                      00547         NOP
                      00548         NOP
                      00549         NOP
                      00550         NOP
                      00551         NOP
                      00552         NOP
                      00553         NOP
                      00554         NOP
                      00555         NOP
                      00556         NOP
                      00557         NOP
                      00558         NOP
                      00559         NOP
                      00560         NOP
                      00561         NOP
                      00562         NOP
                      00563         NOP
                      00564         NOP
                      00565         NOP
                      00566         NOP
                      00567         NOP
                      00568         NOP
                      00569         NOP
                      00570         NOP
                      00571         NOP
                      00572         NOP
                      00573         NOP
                      00574         NOP
                      00575         NOP
                      00576         NOP
                      00577         NOP
                      00578         NOP
                      00579         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00580         NOP
                      00581         NOP
                      00582         NOP
                      00583         NOP
                      00584         NOP
                      00585         NOP
                      00586         NOP
                      00587         NOP
                      00588         NOP
                      00589         NOP
                      00590         NOP
                      00591         NOP
                      00592         NOP
                      00593         NOP
                      00594         NOP
                      00595         NOP
                      00596         NOP
                      00597         NOP
                      00598         NOP
                      00599         NOP
                      00600         NOP
                      00601         NOP
                      00602         NOP
                      00603         NOP
                      00604         NOP
                      00605         NOP
                      00606         NOP
                      00607         NOP
                      00608         NOP
                      00609         NOP
                      00610         NOP
                      00611         NOP
                      00612         NOP
                      00613         NOP
                      00614         NOP
                      00615         NOP
                      00616         NOP
                      00617         NOP
                      00618         NOP
                      00619         NOP
                      00620         NOP
                      00621         NOP
                      00622         NOP
                      00623         NOP
                      00624         NOP
                      00625         NOP
                      00626         NOP
                      00627         NOP
                      00628         NOP
                      00629         NOP
                      00630         NOP
                      00631         NOP
                      00632         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00633         NOP
                      00634         NOP
                      00635         NOP
                      00636         NOP
                      00637         NOP
                      00638         NOP
                      00639         NOP
                      00640         NOP
                      00641         NOP
                      00642         NOP
                      00643         NOP
                      00644         NOP
                      00645         NOP
                      00646         NOP
                      00647         NOP
                      00648         NOP
                      00649         NOP
                      00650         NOP
                      00651         NOP
                      00652         NOP
                      00653         NOP
                      00654         NOP
                      00655         NOP
                      00656         NOP
                      00657         NOP
                      00658         NOP
                      00659         NOP
                      00660         NOP
                      00661         NOP
                      00662         NOP
                      00663         NOP
                      00664         NOP
                      00665         NOP
                      00666         NOP
                      00667         NOP
                      00668         NOP
                      00669         NOP
                      00670         NOP
                      00671         NOP
                      00672         NOP
                      00673         NOP
                      00674         NOP
                      00675         NOP
                      00676         NOP
                      00677         NOP
                      00678         NOP
                      00679         NOP
                      00680         NOP
                      00681         NOP
                      00682         NOP
                      00683         NOP
                      00684         NOP
                      00685         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00686         NOP
                      00687         NOP
                      00688         NOP
                      00689         NOP
                      00690         NOP
                      00691         NOP
                      00692         NOP
                      00693         NOP
                      00694         NOP
                      00695         NOP
                      00696         NOP
                      00697         NOP
                      00698         NOP
                      00699         NOP
                      00700         NOP
                      00701         NOP
                      00702         NOP
                      00703         NOP
                      00704         NOP
                      00705         NOP
                      00706         NOP
                      00707         NOP
                      00708         NOP
                      00709         NOP
                      00710         NOP
                      00711         NOP
                      00712         NOP
                      00713         NOP
                      00714         NOP
                      00715         NOP
                      00716         NOP
                      00717         NOP
                      00718         NOP
                      00719         NOP
                      00720         NOP
                      00721         NOP
                      00722         NOP
                      00723         NOP
                      00724         NOP
                      00725         NOP
                      00726         NOP
                      00727         NOP
                      00728         NOP
                      00729         NOP
                      00730         NOP
                      00731         NOP
                      00732         NOP
                      00733         NOP
                      00734         NOP
                      00735         NOP
                      00736         NOP
                      00737         NOP
                      00738         NOP
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00739         NOP
                      00740         NOP
                      00741         NOP
                      00742         NOP
                      00743         NOP
                      00744         NOP
                      00745 
                      00746         ENDIF
                      01593 
                      01594 
                      01595 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01596 ;Jump table selection of Serial Number digits (28sb)
                      01597 ;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                      01598         ;ATTENTION: END OF PAGE 1
                      01599 
07FC                  01600         org     0x7FC           ;lookout this OFFSET is fixed!!!!!!!!
07FC   340F           01601 GET_SERIAL_0    RETLW   0x0F    ;low nibble only: msb serial number
07FD   34ED           01602 GET_SERIAL_1    RETLW   0xED    ;serial number
07FE   34CB           01603 GET_SERIAL_2    RETLW   0xCB    ;serial number
07FF   34A8           01604 GET_SERIAL_3    RETLW   0xA8    ;serial number (lsb)
                      01605 
                      01606 
0800                  01607         org     0x800
0800   0000           01608         NOP
                      01609         
                      01610         END                       ; directive 'end of program'
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 54


SYMBOL TABLE
  LABEL                             VALUE 

ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000004
ADCS1                             00000005
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADJUST_CLK_PHASE                  0000002E
ADJUST_RT                         LCD_CHAR2,7
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
AD_START                          00000426
ALTO1_BASSO0                      FLAGS_HCS,1
AN0                               00000000
AN1                               00000001
AN2                               00000002
AN3                               00000003
AN4                               00000004
AN5                               00000005
AN6                               00000006
AN7                               00000007
ANSEL                             00000091
AUTOLOCK_DEBOUNCE                 00000040
AUTOLOCK_OFF_TIME                 0000001E
AUTOLOCK_ON                       LCD_CHAR3,6
AUTOLOCK_ON_TIME                  00000005
AUTO_OFF_12HR                     0000000C
AUTO_OFF_1HR                      00000001
AUTO_OFF_3HR                      00000003
AUTO_OFF_HOURS                    00000031
AUTO_OFF_MINUTES                  00000032
AUTO_OFF_OFF                      00000000
BACKLIGHT                         PORTB,6
BACKLIGHT_CNT                     00000027
BACKLIGHT_PERIOD                  0000001E
BANK0                             BCF     STATUS,RP0
BANK1                             BSF     STATUS,RP0
BATTERY_BLINK_COUNT               0000003B
BATTERY_LOW                       LCD_CHAR5,2
BATTERY_WARN                      LCD_CHAR5,1
BATTLOW                           LCD_CHAR1,7
BATT_HIGH_THRESHLD                00000099
BATT_LOW_THRESHLD                 00000087
BAT_OFF_MSG_COUNT                 0000003D
BEEPER                            LCD_CHAR5,0
BF                                00000000
BIASMD                            00000006
BI_FSR                            0000004E
BI_PCLATH                         0000004D
BI_STATUS                         0000004C
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 55


SYMBOL TABLE
  LABEL                             VALUE 

BI_WREG                           00000076
BLINK_COUNT                       00000028
BLINK_PERIOD                      00000010
BOOST                             LCD_CHAR2,2
BOOST_ACT                         LCD_CHAR5,3
BOOST_MINUTES                     00000033
BOOST_PERIOD                      0000001E
BRGH                              00000002
BTN_ACT_PDG                       LCD_CHAR3,1
C                                 00000000
C1IE                              00000005
C1IF                              00000005
C1INV                             00000004
C1OUT                             00000006
C2IE                              00000006
C2IF                              00000006
C2INV                             00000005
C2OUT                             00000007
C2SYNC                            00000000
CALCOLA_PIN                       00000470
CANC                              BCF
CANC_TMR_TX                       00000483
CARICA_TIMER_HCS_HI               00000046
CARICA_TIMER_HCS_LO               00000047
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CIS                               00000003
CKE                               00000006
CKP                               00000004
CLCKSET_ACT                       LCD_CHAR3,3
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 56


SYMBOL TABLE
  LABEL                             VALUE 

CLEAR_RAM_0                       0000042A
CLEAR_RAM_1                       00000433
CLKP_1224                         00000001
CLKP_HOUR_12                      0000000C
CLKP_HOUR_24                      00000018
CLKP_HOUR_ADJ                     00000003
CLKP_HOUR_DISP12                  00000012
CLKP_HOUR_DISP24                  00000024
CLKP_MIN_ADJ                      00000002
CLKP_NOTHING                      00000000
CLOCK_SET                         NEW_BUTTON_CONFIG,5
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON0                            0000009C
CMCON1                            00000097
COM0                              PORTB,4
COM1                              PORTB,5
COM2                              PORTA,2
COM3                              PORTD,0
COUNT_BIT                         00000049
COUNT_DATA                        0000004B
COUNT_PREAMBOLO                   0000004B
CP_X                              0000047D
CREN                              00000004
CS0                               00000002
CS1                               00000003
CSRC                              00000007
Convert_to_BCD                    000003F5
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DEBOUNCE_CNT                      00000026
DEBOUNCE_PERIOD                   00000006
DEBOUNCING                        LCD_CHAR3,0
DEBUG_OUT                         PORTE,0
DEVICE_OFF                        00000255
DEVOFF                            LCD_CHAR2,1
DEVON                             LCD_CHAR2,0
DIGIT_SELECT                      0000000E
DISPLAY_REAL_TIME                 00000329
D_A                               00000005
EEADRH                            0000010F
EEADRL                            0000010D
EECON1                            0000018C
EECON2                            0000018D
EEDATH                            0000010E
EEDATL                            0000010C
EEIE                              00000007
EEIF                              00000007
EEPGD                             00000007
EERD                              00000000
EEWR                              00000001
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 57


SYMBOL TABLE
  LABEL                             VALUE 

END_TAB_FASE_HCS                  00000492
F                                 00000001
FASE_HEADER                       00000450
FASE_PREAMBOLO                    00000448
FASE_PWM_DATA                     00000460
FASE_PWM_HI                       00000458
FASE_PWM_LO                       00000467
FASE_TX_HCS                       00000045
FERR                              00000002
FH_X                              00000457
FILL_RESEND_PERIOD                00000247
FLAGS_HCS                         00000044
FPH_X                             0000045F
FPL_X                             0000046F
FP_X                              0000044F
FSR                               00000004
FW                                MOVFW
F_BODY_GUARD                      LCD_CHAR5,4
GESTIONE_TMR_HCS                  0000048A
GET_SERIAL_0                      000007FC
GET_SERIAL_1                      000007FD
GET_SERIAL_2                      000007FE
GET_SERIAL_3                      000007FF
GIE                               00000007
GO_DONE                           ADCON0,1
GTH_X                             00000493
HANDLE_BUTTONS                    00000125
HCS1                              0000003E
HCS2                              0000003F
HCS3                              00000040
HCS4                              00000041
HCS5                              00000042
HCS6                              00000043
HEADER_COUNT                      0000004B
HEAT_ACT                          LCD_CHAR3,5
HEAT_MSG_COUNTDWN                 00000009
HOURS                             LCD_CHAR1,1
HOUR_VALUE                        00000074
HTS                               00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IDLE_BATTERY_TEST                 0000000C
IDLE_BATT_COUNT                   0000003C
IDLE_BTN_COUNT                    00000020
IFCANC                            BTFSS
IFSET                             BTFSC
INDF                              00000000
INIZIO_TX_HCS                     0000043C
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 58


SYMBOL TABLE
  LABEL                             VALUE 

INTERRUPT                         00000338
INTF                              00000001
IOC                               00000096
IOC4                              00000004
IOC5                              00000005
IOC6                              00000006
IOC7                              00000007
IOCB                              00000096
IOCB4                             00000004
IOCB5                             00000005
IOCB6                             00000006
IOCB7                             00000007
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRP                               00000007
IRVST                             00000005
ISR                               00000338
ISR_X                             00000341
ITH_X                             00000447
KB0                               PORTA,3
KB1                               PORTD,1
KB2                               PORTD,2
KB3                               PORTD,3
KB4                               PORTD,4
KB5                               PORTD,5
KB6                               PORTD,6
KB7                               PORTE,0
KB8                               PORTE,1
LCD0                              PORTB,0
LCD1                              PORTB,1
LCD10                             PORTC,5
LCD11                             PORTC,4
LCD2                              PORTB,2
LCD3                              PORTB,3
LCD4                              PORTA,4
LCD5                              PORTA,5
LCD6                              PORTC,3
LCD7                              PORTA,1
LCD8                              PORTC,7
LCD9                              PORTC,6
LCDA                              00000005
LCDCON                            00000107
LCDDATA0                          00000110
LCDDATA1                          00000111
LCDDATA10                         0000011A
LCDDATA11                         0000011B
LCDDATA2                          00000112
LCDDATA3                          00000113
LCDDATA4                          00000114
LCDDATA5                          00000115
LCDDATA6                          00000116
LCDDATA7                          00000117
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 59


SYMBOL TABLE
  LABEL                             VALUE 

LCDDATA8                          00000118
LCDDATA9                          00000119
LCDEN                             00000007
LCDIE                             00000004
LCDIF                             00000004
LCDPS                             00000108
LCDSE0                            0000011C
LCDSE1                            0000011D
LCDSE2                            0000011E
LCD_CHAR1                         00000071
LCD_CHAR2                         00000072
LCD_CHAR3                         0000002B
LCD_CHAR4                         0000002C
LCD_CHAR5                         0000002D
LCD_FRAME_FREQ                    00000040
LCD_FRAME_PERIOD                  00003D09
LCD_IF                            PIR2,LCDIF
LCD_PRESCALE                      00000003
LCD_TICK                          00007A12
LCD_UPD                           LCD_CHAR2,3
LED1                              PORTB,7
LED1_CLOCK                        00000022
LED1_STATE                        LCD_CHAR2,4
LMUX0                             00000000
LMUX1                             00000001
LOCKED                            LCD_CHAR1,6
LOOP_BCD                          000003F6
LP0                               00000000
LP1                               00000001
LP2                               00000002
LP3                               00000003
LTS                               00000001
LVDCON                            00000109
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LW                                MOVLW
MANAGE_LED1                       000002A5
MASKTA                            b'11000001'
MASKTB                            b'00000000'
MASKTC                            b'00000111'
MASKTD                            b'00111110'
MASKTE                            b'11111110'
MAX_HOURS                         0000002F
MAX_TEMP                          0000000A
MCLR                              PORTE,3
MESSAGE_LENGTH                    00000030
MILLI                             000003E8
MINUS                             NEW_BUTTON_CONFIG,3
MINUS_BUT                         LCD_CHAR2,6
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 60


SYMBOL TABLE
  LABEL                             VALUE 

MINUTES                           LCD_CHAR1,0
MIN_VALUE                         00000073
MODE                              NEW_BUTTON_CONFIG,2
MODE_ACT                          LCD_CHAR3,2
MSG_PAUSE_PERIOD                  00000001
MULTIPLEX                         00000004
M_BANKSEL_0                       
M_BANKSEL_1                       
M_BANKSEL_2                       
M_BANKSEL_3                       
M_CMPL_JE                         
M_CMPL_JG                         
M_CMPL_JGE                        
M_CMPL_JL                         
M_CMPL_JNE                        
M_CMP_JE                          
M_CMP_JG                          
M_CMP_JGE                         
M_CMP_JL                          
M_CMP_JLE                         
M_CMP_JNE                         
NEW_BUTTON_CONFIG                 00000029
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OERR                              00000001
OLD_BUTTON_CONFIG                 0000002A
ONEHR                             LCD_CHAR1,2
OPTION_REG                        00000081
ORG_INCLUDES                      0000043C
OSCCON                            0000008F
OSCTUNE                           00000090
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000003
P                                 00000004
PAUSE_COUNT                       0000003A
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PIE1                              0000008C
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 61


SYMBOL TABLE
  LABEL                             VALUE 

PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PLUS                              NEW_BUTTON_CONFIG,4
PLUS_BUT                          LCD_CHAR2,5
POP                               00000341
PORTA                             00000005
PORTA6                            "NOT USED"
PORTA7                            "NOT USED"
PORTB                             00000006
PORTC                             00000007
PORTC0                            "DONT KNOW"
PORTC1                            "DONT KNOW"
PORTC2                            "DONT KNOW"
PORTD                             00000008
PORTE                             00000009
PR                                0000042C
PR2                               00000092
PREHEAT                           NEW_BUTTON_CONFIG,1
PREHEAT_COUNTDOWN                 0000030B
PRE_MESSAGE_TIMER                 00000035
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PUNTA_HCS                         00000048
PURA1                             00000435
PUSH                              00000004
PWM_HCS                           PORTD,7
PW_OFF_PERIOD                     00000060
PW_ON_PERIOD                      00000009
R                                 00000002
RAM0                              BCF     STATUS,RP0
RAM1                              BSF     STATUS,RP0
RAM_0                             BCF     STATUS,RP0
RAM_1                             BSF     STATUS,RP0
RBIE                              00000003
RBIF                              00000000
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
READ_WRITE                        00000002
REAL_TIME_SERVICES                000002C6
RELOCK_ON                         LCD_CHAR3,7
RESEND_OFF_COUNT                  00000037
RESEND_ON_COUNT_H                 00000039
RESEND_ON_COUNT_L                 00000038
REXMIT_COUNT                      00000036
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 62


SYMBOL TABLE
  LABEL                             VALUE 

REXMIT_EXTEND                     00000003
REXMIT_NORMAL                     00000002
RE_LOCK_TIME                      00000030
RP0                               00000005
RP1                               00000006
RT_HOURS                          00000025
RT_MINUTES                        00000024
RT_SECONDS                        00000023
RX9                               00000006
RX9D                              00000000
R_W                               00000002
S                                 00000003
S0C0                              00000000
S0C1                              00000000
S0C2                              00000000
S0C3                              00000000
S10C0                             00000002
S10C1                             00000002
S10C2                             00000002
S10C3                             00000002
S11C0                             00000003
S11C1                             00000003
S11C2                             00000003
S11C3                             00000003
S12C0                             00000004
S12C1                             00000004
S12C2                             00000004
S12C3                             00000004
S13C0                             00000005
S13C1                             00000005
S13C2                             00000005
S13C3                             00000005
S14C0                             00000006
S14C1                             00000006
S14C2                             00000006
S14C3                             00000006
S15C0                             00000007
S15C1                             00000007
S15C2                             00000007
S15C3                             00000007
S16C0                             00000000
S16C1                             00000000
S16C2                             00000000
S16C3                             00000000
S17C0                             00000001
S17C1                             00000001
S17C2                             00000001
S17C3                             00000001
S18C0                             00000002
S18C1                             00000002
S18C2                             00000002
S18C3                             00000002
S19C0                             00000003
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 63


SYMBOL TABLE
  LABEL                             VALUE 

S19C1                             00000003
S19C2                             00000003
S19C3                             00000003
S1C0                              00000001
S1C1                              00000001
S1C2                              00000001
S1C3                              00000001
S20C0                             00000004
S20C1                             00000004
S20C2                             00000004
S20C3                             00000004
S21C0                             00000005
S21C1                             00000005
S21C2                             00000005
S21C3                             00000005
S22C0                             00000006
S22C1                             00000006
S22C2                             00000006
S22C3                             00000006
S23C0                             00000007
S23C1                             00000007
S23C2                             00000007
S23C3                             00000007
S2C0                              00000002
S2C1                              00000002
S2C2                              00000002
S2C3                              00000002
S3C0                              00000003
S3C1                              00000003
S3C2                              00000003
S3C3                              00000003
S4C0                              00000004
S4C1                              00000004
S4C2                              00000004
S4C3                              00000004
S5C0                              00000005
S5C1                              00000005
S5C2                              00000005
S5C3                              00000005
S6C0                              00000006
S6C1                              00000006
S6C2                              00000006
S6C3                              00000006
S7C0                              00000007
S7C1                              00000007
S7C2                              00000007
S7C3                              00000007
S8C0                              00000000
S8C1                              00000000
S8C2                              00000000
S8C3                              00000000
S9C0                              00000001
S9C1                              00000001
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 64


SYMBOL TABLE
  LABEL                             VALUE 

S9C2                              00000001
S9C3                              00000001
SAVED_TEMPERATURE                 00000034
SBOREN                            00000004
SC                                BTFSC
SCS                               00000000
SE0                               00000000
SE1                               00000001
SE10                              00000002
SE11                              00000003
SE12                              00000004
SE13                              00000005
SE14                              00000006
SE15                              00000007
SE16                              00000000
SE17                              00000001
SE18                              00000002
SE19                              00000003
SE2                               00000002
SE20                              00000004
SE21                              00000005
SE22                              00000006
SE23                              00000007
SE3                               00000003
SE4                               00000004
SE5                               00000005
SE6                               00000006
SE7                               00000007
SE8                               00000000
SE9                               00000001
SEG0COM0                          00000000
SEG0COM1                          00000000
SEG0COM2                          00000000
SEG0COM3                          00000000
SEG10COM0                         00000002
SEG10COM1                         00000002
SEG10COM2                         00000002
SEG10COM3                         00000002
SEG11COM0                         00000003
SEG11COM1                         00000003
SEG11COM2                         00000003
SEG11COM3                         00000003
SEG12COM0                         00000004
SEG12COM1                         00000004
SEG12COM2                         00000004
SEG12COM3                         00000004
SEG13COM0                         00000005
SEG13COM1                         00000005
SEG13COM2                         00000005
SEG13COM3                         00000005
SEG14COM0                         00000006
SEG14COM1                         00000006
SEG14COM2                         00000006
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 65


SYMBOL TABLE
  LABEL                             VALUE 

SEG14COM3                         00000006
SEG15COM0                         00000007
SEG15COM1                         00000007
SEG15COM2                         00000007
SEG15COM3                         00000007
SEG16COM0                         00000000
SEG16COM1                         00000000
SEG16COM2                         00000000
SEG16COM3                         00000000
SEG17COM0                         00000001
SEG17COM1                         00000001
SEG17COM2                         00000001
SEG17COM3                         00000001
SEG18COM0                         00000002
SEG18COM1                         00000002
SEG18COM2                         00000002
SEG18COM3                         00000002
SEG19COM0                         00000003
SEG19COM1                         00000003
SEG19COM2                         00000003
SEG19COM3                         00000003
SEG1COM0                          00000001
SEG1COM1                          00000001
SEG1COM2                          00000001
SEG1COM3                          00000001
SEG20COM0                         00000004
SEG20COM1                         00000004
SEG20COM2                         00000004
SEG20COM3                         00000004
SEG21COM0                         00000005
SEG21COM1                         00000005
SEG21COM2                         00000005
SEG21COM3                         00000005
SEG22COM0                         00000006
SEG22COM1                         00000006
SEG22COM2                         00000006
SEG22COM3                         00000006
SEG23COM0                         00000007
SEG23COM1                         00000007
SEG23COM2                         00000007
SEG23COM3                         00000007
SEG2COM0                          00000002
SEG2COM1                          00000002
SEG2COM2                          00000002
SEG2COM3                          00000002
SEG3COM0                          00000003
SEG3COM1                          00000003
SEG3COM2                          00000003
SEG3COM3                          00000003
SEG4COM0                          00000004
SEG4COM1                          00000004
SEG4COM2                          00000004
SEG4COM3                          00000004
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 66


SYMBOL TABLE
  LABEL                             VALUE 

SEG5COM0                          00000005
SEG5COM1                          00000005
SEG5COM2                          00000005
SEG5COM3                          00000005
SEG6COM0                          00000006
SEG6COM1                          00000006
SEG6COM2                          00000006
SEG6COM3                          00000006
SEG7COM0                          00000007
SEG7COM1                          00000007
SEG7COM2                          00000007
SEG7COM3                          00000007
SEG8COM0                          00000000
SEG8COM1                          00000000
SEG8COM2                          00000000
SEG8COM3                          00000000
SEG9COM0                          00000001
SEG9COM1                          00000001
SEG9COM2                          00000001
SEG9COM3                          00000001
SEGEN0                            00000000
SEGEN1                            00000001
SEGEN10                           00000002
SEGEN11                           00000003
SEGEN12                           00000004
SEGEN13                           00000005
SEGEN14                           00000006
SEGEN15                           00000007
SEGEN16                           00000000
SEGEN17                           00000001
SEGEN18                           00000002
SEGEN19                           00000003
SEGEN2                            00000002
SEGEN20                           00000004
SEGEN21                           00000005
SEGEN22                           00000006
SEGEN23                           00000007
SEGEN3                            00000003
SEGEN4                            00000004
SEGEN5                            00000005
SEGEN6                            00000006
SEGEN7                            00000007
SEGEN8                            00000000
SEGEN9                            00000001
SEND_MESSAGES                     000000AD
SEND_OFF_PERIOD                   0000001E
SEND_ON_PERIOD                    000002D0
SET                               BSF
SET_TMR_TX                        0000047E
SIXTY_MINUTES                     0000003C
SKPB                              SKPNC
SKPNB                             SKPC
SLPEN                             00000006
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 67


SYMBOL TABLE
  LABEL                             VALUE 

SMP                               00000007
SND_BOOSTON_MSG                   LCD_CHAR4,2
SND_BOO_OFF_MSG                   LCD_CHAR4,3
SND_LEARN_MSG                     LCD_CHAR4,5
SND_OFF_MSG                       LCD_CHAR4,0
SND_ON_MSG                        LCD_CHAR4,1
SND_REFRESH_MSG                   LCD_CHAR4,7
SND_TEMP_MSG                      LCD_CHAR4,4
SND_TEST_MSG                      LCD_CHAR4,6
SPARE                             NEW_BUTTON_CONFIG,0
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SS                                BTFSS
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
SWAPBCD                           000003FB
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
S_KB6                             NEW_BUTTON_CONFIG,6
S_KB7                             NEW_BUTTON_CONFIG,7
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1GE                              00000006
T1GINV                            00000007
T1GSS                             00000001
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TAB_FASE_HCS                      0000048E
TEMPETR                           LCD_CHAR1,5
TEMP_BYT0_B0                      00000020
TEMP_BYT0_B2                      00000123
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 68


SYMBOL TABLE
  LABEL                             VALUE 

TEMP_BYT1_B0                      00000021
TEMP_BYT1_B2                      00000124
TEMP_ROTATE                       0000004A
TEST_BATTERY                      000003FF
TEST_BUTTONS                      00000267
THREEHR                           LCD_CHAR1,3
TMPTR_VALUE                       00000075
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR1_IF                           PIR1,TMR1IF
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TMR_HCS                           00000001
TMR_HCS_ON                        _TMR1ON
TOGGLE_LCD                        00000122
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRASMISSIONE_HCS                  FLAGS_HCS,0
TREAT_BATTERY_DISPLAY             000002B4
TRISA                             00000085
TRISB                             00000086
TRISC                             00000087
TRISD                             00000088
TRISE                             00000089
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TWELVEHR                          LCD_CHAR1,4
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXENBL_TRIS                       TRISA,0
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
TX_ENABLE                         PORTA,0
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 69


SYMBOL TABLE
  LABEL                             VALUE 

UA                                00000001
UNLOCKING                         LCD_CHAR3,4
UPDATE_LCD                        0000034C
VCFG0                             00000005
VCFG1                             00000006
VDIODE                            PORTE,2
VLCDEN                            00000004
VR0                               00000000
VR1                               00000001
VR2                               00000002
VR3                               00000003
VRCON                             0000009D
VREN                              00000007
VRR                               00000005
W                                 00000000
WA                                00000004
WAVE_TYPE_B                       
WCOL                              00000007
WDTCON                            00000105
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WERR                              00000005
WF                                MOVWF
WFT                               00000007
WFT_A                             00000000
WFT_B                             00000080
WPU                               00000095
WPU0                              00000000
WPU1                              00000001
WPU2                              00000002
WPU3                              00000003
WPU4                              00000004
WPU5                              00000005
WPU6                              00000006
WPU7                              00000007
WPUB                              00000095
WPUB0                             00000000
WPUB1                             00000001
WPUB2                             00000002
WPUB3                             00000003
WPUB4                             00000004
WPUB5                             00000005
WPUB6                             00000006
WPUB7                             00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
WR_ERRORS                         00000120
WR_NOERRORS                       00000121
Z                                 00000002
_ACCEPT_HEAT_CHANGE               0000020E
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 70


SYMBOL TABLE
  LABEL                             VALUE 

_ADCON_GO                         00000400
_ADD_HOUR                         000001E0
_ADD_MINUTE                       000001AD
_AO_DONE                          000002FF
_AUTOLOCK_REJECT                  00000132
_AUTOSHUTOFF                      000002F5
_BATTERY                          000003E6
_BATTERY_COUNTER                  00000323
_BATTERY_LOW                      0000040E
_BATTERY_OK                       0000041F
_BATTERY_WARNING                  0000041A
_BATT_FIN                         000002C5
_BATT_GOOD                        000002C4
_BATT_LOW                         000002BF
_BL1                              000002D1
_BOD_NSLEEP                       00003EFF
_BOD_OFF                          00003CFF
_BOD_ON                           00003FFF
_BOD_SBODEN                       00003DFF
_BOOST                            000003EF
_BOOST_OFF_MSG                    000000DD
_BOOST_ON_MSG                     000000D8
_BUTTON_END                       000002A4
_BUTTON_REJECT                    00000243
_CHKSUM_LOOP                      0000010C
_CLEAR_DEBOUNCE                   000002A3
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003F7F
_CP_OFF                           00003FFF
_CP_ON                            00003FBF
_DEBOUNCING                       00000289
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         00002FFF
_DECHR                            000001F1
_DECMIN                           000001BC
_DELAY_MSG_SEND                   00000227
_DISPLAY_ADJUSTMENTS              0000023A
_DISP_AUTO_OFF                    00000181
_EC_OSC                           00003FFB
_EXTRC                            00003FFF
_EXTRCIO                          00003FFE
_EXTRC_OSC_CLKOUT                 00003FFF
_EXTRC_OSC_NOCLKOUT               00003FFE
_FCMEN_OFF                        000037FF
_FCMEN_ON                         00003FFF
_GIE                              INTCON,GIE
_GO1_HR                           000001E9
_GO1_MIN                          000001B6
_HANDLE_CLK_SET                   00000192
_HANDLE_FIN                       00000246
_HEAT_MSG_ACTION                  00000212
_HEAT_MSG_COUNTDOWN               00000231
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 71


SYMBOL TABLE
  LABEL                             VALUE 

_HOURS                            00000393
_HR_ADJUST                        000001CE
_HS_OSC                           00003FFA
_IESO_OFF                         00003BFF
_IESO_ON                          00003FFF
_INCHR                            00000319
_INCMIN                           000002EC
_INTE                             INTCON,INTE
_INTF                             INTCON,INTF
_INTOSC                           00003FFD
_INTOSCIO                         00003FFC
_INTRC_OSC_CLKOUT                 00003FFD
_INTRC_OSC_NOCLKOUT               00003FFC
_INVALID_BUTTON                   0000023D
_LCDCONT                          0000035E
_LCD_DONE                         000003F2
_LED1_END                         000002B3
_LED1_SET                         000002B2
_LOCKED                           000003E3
_LOOP_DELAY                       0000011E
_LP_OSC                           00003FF8
_MCLRE_OFF                        00003FDF
_MCLRE_ON                         00003FFF
_MIN_ADJUST                       0000019B
_MODE12HR                         00000175
_MODE1HR                          0000015E
_MODE3HR                          0000016D
_MODE_HOUR                        000001F8
_MODE_MIN                         000001C2
_MODE_OFF                         0000017D
_MSG_CONT1                        000000E8
_MSG_CONT2                        000000EC
_MSG_CONT3                        000000EF
_MSG_FIN                          00000124
_NEW_ACTIONS                      00000138
_NEW_CLKSET                       00000186
_NEW_CLK_ADJ                      00000188
_NEW_HOURS                        000001F2
_NEW_MINUTES                      000001BD
_NEW_MODE                         00000153
_NEW_MSG                          000000C9
_NEW_TEMP_VARS                    00000204
_NEXT_HANDLE                      00000134
_NORMAL_DEB_PERIOD                000002A0
_NO_BLKHR                         000001D6
_NO_BLKMIN                        000001A3
_OFF                              000003EC
_ON                               000003E9
_ONE_HOURMSG                      000000B4
_ON_MSG                           000000CE
_PEIE                             INTCON,PEIE
_PREHEAT                          0000013F
_PWRTE_OFF                        00003FFF
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 72


SYMBOL TABLE
  LABEL                             VALUE 

_PWRTE_ON                         00003FEF
_REFRESH_MSG                      000000D3
_RELOAD_AO_MINUTES                000002FC
_RELOAD_ON_MSG                    000002DA
_RELOCK_REACHED                   000002E3
_RELOCK_SECS                      000002DC
_RESEND_OFF_MSG                   000002EF
_RESEND_ON_MSG                    000002D4
_RESET_RELOCK                     00000240
_RE_SEND                          00000117
_RT_DONE                          00000328
_RT_HOURS                         00000314
_RT_MINUTES                       000002E7
_RT_SECONDS                       000002C9
_SAVE_MINUTES                     0000017F
_SKIPHR                           000001DB
_SKIPMIN                          000001A8
_SND_LEARN_MSG                    000000E2
_SND_TEST_MSG                     000000E6
_SNOOZE                           0000007F
_START_DEBOUNCING                 00000294
_STAY_UP                          00000093
_SUB_HOUR                         000001EA
_SUB_MINUTE                       000001B7
_T0IE                             INTCON,T0IE
_T0IF                             INTCON,T0IF
_TB_CONT                          00000283
_TB_LOCK                          00000278
_TB_UNLOCK                        0000027E
_TB_WAIT                          0000026B
_TEMPERATURE                      000003C6
_TEMPHIGH                         000003CA
_TEMP_CONT                        000003D0
_TEMP_DECR                        0000021F
_TEMP_INCR                        00000217
_TESTBATT_DONE                    00000423
_THREE_HOURMSG                    000000BB
_TM1ENDEND                        00000337
_TURN_LED1_OFF                    000002AF
_TURN_LED1_ON                     000002AB
_TURN_OFF_BL                      000002D3
_TWELVE_HOURMSG                   000000C2
_WDT_OFF                          00003FF7
_WDT_ON                           00003FFF
_WRAP_HIGH                        00000225
_WRAP_ZERO                        0000021D
_XT_OSC                           00003FF9
__16F914                          00000001
main                              0000001B
MPASM  4.02 Released                               TXTEST.ASM   12-6-2005  12:14:09         PAGE 73


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0000 : XX--XXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXX------------ ---------------- ----------------
07C0 : ---------------- ---------------- ---------------- ------------XXXX
0800 : X--------------- ---------------- ---------------- ----------------
2000 : XXXX---X-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:  1175
Program Memory Words Free:  2921


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,   139 suppressed

