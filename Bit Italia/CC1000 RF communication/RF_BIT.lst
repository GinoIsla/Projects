MP2COD 3.60, COFF to COD File Converter
Copyright (c) 2003 Microchip Technology Inc.
Listing File Generated: Thu Jun 03 15:06:31 2004


Address  Value    Disassembly              Source                                                                           File
-------  -------  -----------------------  -------------------------------------------------------------------------------  -----
                                           ;************************************************************                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;	TITLE:	RF Transceiver via CC1000                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;	Programmer: GINO ISLA                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;	REVISION HISTORY:	31-03-03 First try                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;						05-09-03 v1.0                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;	HARDWARE: BIT SRL. lOW pOWER transciever                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;	FREQUENCY: 4MHz                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;	Function: Master salve query/response using a CC1000                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;************************************************************                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           			list	p=16f876                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                                                                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           #include	<p16f876.inc>                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                                   LIST                                                                     C:\Program Files\MPLAB IDE\MCHIP_Tools\p16f876.inc
                                           ; P16F876.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.  C:\Program Files\MPLAB IDE\MCHIP_Tools\p16f876.inc
                                                   LIST                                                                     C:\Program Files\MPLAB IDE\MCHIP_Tools\p16f876.inc
                                           #include 	<CC1000.h>                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;/* Constants defined for CC1000 */                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                                                                                                            C:\Embedded\CC1000 RF communication\CC1000.h
                                           ;/* Register addresses */                                                        C:\Embedded\CC1000 RF communication\CC1000.h
                                                                                                                            C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_MAIN            0x00                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FREQ_2A         0x01                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FREQ_1A         0x02                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FREQ_0A         0x03                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FREQ_2B         0x04                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FREQ_1B         0x05                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FREQ_0B         0x06                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSEP1           0x07                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSEP0           0x08                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_CURRENT         0x09                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FRONT_END       0x0A                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_PA_POW          0x0B                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_PLL             0x0C                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_LOCK            0x0D                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_CAL             0x0E                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_MODEM2          0x0F                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_MODEM1          0x10                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_MODEM0          0x11                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_MATCH           0x12                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSCTRL          0x13                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSHAPE7         0x14                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSHAPE6         0x15                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSHAPE5         0x16                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSHAPE4         0x17                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSHAPE3         0x18                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSHAPE2         0x19                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSHAPE1         0x1A                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_FSDELAY         0x1B                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_PRESCALER       0x1C                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_TEST6           0x40                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_TEST5           0x41                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_TEST4           0x42                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_TEST3           0x43                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_TEST2           0x44                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_TEST1           0x45                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                           #define CC1000_TEST0           0x46                                              C:\Embedded\CC1000 RF communication\CC1000.h
                                                                                                                            C:\Embedded\CC1000 RF communication\CC1000.h
                                           #include 	<hw_interf.h>                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Pin usage definitions for the RF via CC1000 project                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;The following are the assumed communication ports between the                   C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;CC1000 and PIC16f76A                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define PDATA			PORTC,0	; Register interfaces                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define PCLK			PORTC,1	;                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define PALE			PORTC,2	;                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define DIO 			PORTC,3	; Data interfaces                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define DCLK			PORTB,0 ;                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define CHP_OUT			PORTC,4 ;not used                                              C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define MSTRAP			PORTA,3	;master/slave strap                                     C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define MANLSW			PORTB,4	;manual switch                                          C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define RED_LED			PORTB,2	;LED for 0 count (LEDs connected to Vdd???)            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define GREEN_LED 		PORTB,1	;LED for count > 0                                   C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define PDATA_DIR		TRISC,0                                                       C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TRISC0			TRISC,0                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TRISC1			TRISC,1                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TRISC2			TRISC,2                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define DIO_DIR			TRISC,3                                                        C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TRISC4			TRISC,4                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TRISC5			TRISC,5                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TRISC6			TRISC,6                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TRISC7			TRISC,7                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;ERRORS AND OTHER EVENTS                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define BUTTON_PRESSED	G_Events,0                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define REPLY_SENT		G_Events,1                                                   C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	NEW_COUNT		G_Events,2                                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TIME_0_OUT		G_Events,3                                                   C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define BYTE_FULL		G_Events,4                                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define RESET_CNTRS		G_Events,5                                                  C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define CALIBRATION_OK	G_Events,6                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;STATES                                                                          C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define IDLE_MODE		G_State,0                                                     C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define MASTER			G_State,1                                                       C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define SLAVE			G_State,2                                                        C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define RXCVER			G_State,3                                                       C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TXMTER			G_State,4                                                       C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	QUIET			G_State,5                                                        C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;PROTOCOL                                                                        C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;PROTOCOL PARTS                                                                  C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define BOF_FOUND		G_Pr_status,0                                                 C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define PREAM_FINISHED	G_Pr_status,1                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define UI_FINISHED		G_Pr_status,2                                               C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	ADDR_CMPLT		G_Pr_status,3                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define NBR_BYTES_RCVD	G_Pr_status,4                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define DATA_RECEIVED	G_Pr_status,5                                              C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define SUMCHECK_DONE	G_Pr_status,6                                              C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define CMMND_COMPLETE	G_Pr_status,7                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;OFFSETS:                                                                        C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define PREAMBLE		0x00                                                           C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define UI				0x03                                                               C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define ADDRESS			0x05                                                           C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define NO_BYTES		0x07                                                           C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define DATA_OFFS		0x08                                                          C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define SUM_CHECK		0x0F                                                          C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	UI_CODE1		0xCD	;unique ramdom number                                     C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	UI_CODE2		0x4D	;                                                         C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;NUMBER OF BYTES                                                                 C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define PREA_SIZE		3                                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define UI_SIZE			2                                                              C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define ADD_SIZE		2                                                              C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define NBR_SIZE		1                                                              C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define DATA_SIZE		7                                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define CS_SIZE			1                                                              C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           TOT_FRAME_SIZ			equ	PREA_SIZE+UI_SIZE+ADD_SIZE+NBR_SIZE+DATA_SIZE+CS_SIZE        C:\Embedded\CC1000 RF communication\hw_interf.h
                                           FIXED_PART				equ	PREA_SIZE+UI_SIZE+ADD_SIZE+NBR_SIZE                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	RX_CURRENT		0x44 ;0100xxxx=950uA, XXXX=?????                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define RXPLL			0x60                                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	TX_CURRENT		0x81 ;1000xxxx=1450uA                                        C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TXPLL			0x48                                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define PA_VALUE		0xFF                                                           C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;TIMER 1 TIMERS                                                                  C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;;;#define	RXMIT_TIM1L		0x90	;at 9600bps: h'3590 = 13,712uS=14ms                 C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;;;#define	RXMIT_TIM1H		0x35	; (104uS/b*8bit/byt*16byt/frame+250uS+xx+ switch RX-TX) C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	RXMIT_TIM1L		0xf0	;20ms includes delays for the master switch RX -> TX   C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	RXMIT_TIM1H		0x55	;                                                      C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;LOCK TIMEOUTS (this is a 16 bit integer e.g. 33FF)                              C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;#define	LOCK1		0xFF                                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;#define	LOCK2		0x33                                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	LOCK1			0xFF                                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	LOCK2			0x01                                                             C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;TOGGLES AND CONTROLS FOR LEDS                                                   C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TOGGLE_G		L_GREEN_CTL,7                                                  C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	GREEN_FLAG		L_GREEN_CTL,6                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	SPEED_G			L_GREEN_CTL,5                                                  C:\Embedded\CC1000 RF communication\hw_interf.h
                                           ;                                                                                C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define TOGGLE_R		L_RED_CTL,7                                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	RED_FLAG		L_RED_CTL,6                                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	SPEED_R			L_RED_CTL,5                                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	SLOW_ON			b'11000110'		;1xx..=start on, x1x..=on, xx000110=6 beats       C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	SLOW_OFF		b'01000110'		;0xx..=start off, x1x..=on, xx000110=6 beats      C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	FAST_ON			b'11000010'                                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define	FAST_OFF		b'01000010'                                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                           #define VERYSLOW		b'11010000'                                                    C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\hw_interf.h
                                                                                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;LOCAL DATA                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           	UDATA                                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_Temp1			res 1 		;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_Temp_CS		res	1		;temporary sum-check                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_BITS			res 1		;number of bits sent or received                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_BYTES			res 1		;number of bytes sent or received                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_TX_COUNT		res	1		;TX_BUFFER counter                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_NEXT_FR_BYT	res	1		;counts the byte in the TX buffer                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_INDEX			res 1		;index for addressing buffers below                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_PORTC			res 1		;temporary PORTC                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_DATA_RX		res 1		;1 byte of received data                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_RX_BUFF		res d'16'	;Received data buffer                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_TX_BUFF		res d'16'	;Transmit data buffer                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_PERSIST		res	1		;counter for persistancy checks                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           G_Events 		res 1		;This has to be seen by other modules                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           G_Pr_status		res 1 		;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           G_State			res 1		;will determine the reaction in ISR                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_GREEN_CTL		res	1		;control for flicking the leds                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_GREEN_COU		res	1		;number of times to flip                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_GR_SPEED		res	1		;temporary speed counter                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_RED_CTL		res	1		;same as green..                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_RED_COU		res	1		;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_RED_SPEED		res	1		;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           D_ERROR_CNT		res	1		;Counts number of times in TREAT_ERROR                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           D_ERROR_FLG		res	1		;Manual flag to read all CC1000 regs in TREAT_ERROR          C:\Embedded\CC1000 RF communication\RF.ASM
                                           D_BUGGGER		res	1		;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           STATUS_TEMP		res 1		;for saving STATUS reg during ISR                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;========================================================================================= C:\Embedded\CC1000 RF communication\RF.ASM
                                           DEBUG_BITS		res	1                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           D_BUG1			res	1		;                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           D_BUG2			res	1		;                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;========================================================================================== C:\Embedded\CC1000 RF communication\RF.ASM
                                           	UDATA_SHR				;Common bank                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_EE_COUNT_L	res	1		;This has to be @ addr xxxxxx00 BUT the linker puts it in x71!!! C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_EE_COUNT_H	res	1		;These reserve 8 bytes for data transfer with EEPROM         C:\Embedded\CC1000 RF communication\RF.ASM
                                           L_EE_COUNT_MORE	res	6		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           W_TEMP			res	1		;for saving W reg during ISR                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;EXTERNAL AND GLOBAL SYMBOLS                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           			Global	G_Events,G_Pr_status                                                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           			extern	G_CC_Reg,G_CC_Data                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                                                                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;LIBRARY SUPPORT ROUTINES                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           	extern	Setup_CC1000PD,Reset_CC1000,Setup_CC1000All,CalibrateCC1000              C:\Embedded\CC1000 RF communication\RF.ASM
                                           	extern	SetupCC1000Tx,SetupCC1000Rx,WakeUpCC1000toRx,WakeUpCC1000toTx            C:\Embedded\CC1000 RF communication\RF.ASM
                                           	extern	DelaymS,Delay100uS,DelayuS                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           	extern	ReadFromCC1000register                                                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           	                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CONSTANTS                                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           EE_ADDR_H	equ	0x21					; See EE_counter_addr                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           EE_ADDR_L	equ	0X00					;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;See also GET_NEXT_REGISTER and RAW_BUFFER for CC1000 constants.                 C:\Embedded\CC1000 RF communication\RF.ASM
                                                                                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CONFIGURATION OF PIC                                                            C:\Embedded\CC1000 RF communication\RF.ASM
002007   3731     RETLW     0x31           	__CONFIG	_CP_OFF & _WDT_OFF & _BODEN_OFF & _PWRTE_ON & _XT_OSC & _PWRTE_ON & _LVP_OFF & _DEBUG_ON & _CPD_OFF C:\Embedded\CC1000 RF communication\RF.ASM
                                                                                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           	CODE                                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           			org	0x2100					;EEPROM as defined in linker                                   C:\Embedded\CC1000 RF communication\RF.ASM
002100   0000     NOP                      EE_counter_addr	de	0					;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                                                                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           START_OF_THE_PROGRAM                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           			org		0X000				; Reset Vector                                                  C:\Embedded\CC1000 RF communication\RF.ASM
000000   0000     NOP                      			nop							;                                                                   C:\Embedded\CC1000 RF communication\RF.ASM
000001   018a     CLRF      0xa            			clrf	PCLATH				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000002   2836     GOTO      0x36           			goto	Start				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           			org		0x004				;Iterrupt Vector                                                C:\Embedded\CC1000 RF communication\RF.ASM
000004   293b     GOTO      0x13b          			goto	Service_Interrupt	;                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Table lookups for CC1000 register                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Lookout for page boundaries!!!!!                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           GET_NEXT_REGISTER                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           			Global	GET_NEXT_REGISTER	;                                                    C:\Embedded\CC1000 RF communication\RF.ASM
000005   0782     ADDWF     0x2,0x1        			ADDWF	PCL,F				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;	                                                                     C:\Embedded\CC1000 RF communication\RF.ASM
000006   3400     RETLW     0x0            CC1Kregs	DATA 0x3400,0x3458,0x3420,0x3400,0x3442,0x3414,0x349c,0x3402	;Rf XTAL: 14.745600 C:\Embedded\CC1000 RF communication\RF.ASM
000007   3458     RETLW     0x58                                                                                            
000008   3420     RETLW     0x20                                                                                            
000009   3400     RETLW     0x0                                                                                             
00000a   3442     RETLW     0x42                                                                                            
00000b   3414     RETLW     0x14                                                                                            
00000c   349c     RETLW     0x9c                                                                                            
00000d   3402     RETLW     0x2                                                                                             
00000e   3480     RETLW     0x80           			DATA 0x3480,0x3444,0x3412,0x34FF,0x3460,0x3410,0x3426,0x348E	;PA_POW<0BH>=FF  C:\Embedded\CC1000 RF communication\RF.ASM
00000f   3444     RETLW     0x44                                                                                            
000010   3412     RETLW     0x12                                                                                            
000011   34ff     RETLW     0xff                                                                                            
000012   3460     RETLW     0x60                                                                                            
000013   3410     RETLW     0x10                                                                                            
000014   3426     RETLW     0x26                                                                                            
000015   348e     RETLW     0x8e                                                                                            
000016   346f     RETLW     0x6f           			DATA 0x346F,0x3447,0x3470,0x3401,0x3400,0x3400,0x3400,0x3400	;MODEM0<11H>     C:\Embedded\CC1000 RF communication\RF.ASM
000017   3447     RETLW     0x47                                                                                            
000018   3470     RETLW     0x70                                                                                            
000019   3401     RETLW     0x1                                                                                             
00001a   3400     RETLW     0x0                                                                                             
00001b   3400     RETLW     0x0                                                                                             
00001c   3400     RETLW     0x0                                                                                             
00001d   3400     RETLW     0x0                                                                                             
00001e   3400     RETLW     0x0            			DATA 0x3400,0x3400,0x3400,0x3400,0x3400                                       C:\Embedded\CC1000 RF communication\RF.ASM
00001f   3400     RETLW     0x0                                                                                             
000020   3400     RETLW     0x0                                                                                             
000021   3400     RETLW     0x0                                                                                             
000022   3400     RETLW     0x0                                                                                             
                                           			Global	CC1Kregs			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000023   0008     RETURN                   			RETURN 	                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                                                                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Table lookup, build a frame of data                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           RAW_BUFFER                                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           			Global	RAW_BUFFER			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000024   0782     ADDWF     0x2,0x1        			ADDWF	PCL,F				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;	                                                                     C:\Embedded\CC1000 RF communication\RF.ASM
000025   34aa     RETLW     0xaa           Comm_buffer	DATA 0x34AA,0x34AA,0x34AA,0x34CD,0x344D,0x3400,0x3400,0x3407	;whole frame C:\Embedded\CC1000 RF communication\RF.ASM
000026   34aa     RETLW     0xaa                                                                                            
000027   34aa     RETLW     0xaa                                                                                            
000028   34cd     RETLW     0xcd                                                                                            
000029   344d     RETLW     0x4d                                                                                            
00002a   3400     RETLW     0x0                                                                                             
00002b   3400     RETLW     0x0                                                                                             
00002c   3407     RETLW     0x7                                                                                             
00002d   3400     RETLW     0x0            			DATA 0x3400,0x3400,0x3400,0x3400,0x3400,0x3400,0x3400,0x3400                  C:\Embedded\CC1000 RF communication\RF.ASM
00002e   3400     RETLW     0x0                                                                                             
00002f   3400     RETLW     0x0                                                                                             
000030   3400     RETLW     0x0                                                                                             
000031   3400     RETLW     0x0                                                                                             
000032   3400     RETLW     0x0                                                                                             
000033   3400     RETLW     0x0                                                                                             
000034   3400     RETLW     0x0                                                                                             
                                           			Global	Comm_buffer			;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000035   0008     RETURN                   			RETURN 	                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Program execution starts here                                                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           Start									;Setup MCU                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000036   3039     MOVLW     0x39           			MOVLW	(D_BUG2-L_Temp_CS)+1;Clears all varialble data including                C:\Embedded\CC1000 RF communication\RF.ASM
000037   00a0     MOVWF     0x20           			MOVWF	L_Temp1				; RX and TX buffers, L_Temp1 is used                         C:\Embedded\CC1000 RF communication\RF.ASM
000038   3021     MOVLW     0x21           			MOVLW	L_Temp_CS			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000039   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
00003a   0180     CLRF      0x0            _CLR_MEM	CLRF	INDF				;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00003b   0a84     INCF      0x4,0x1        			INCF	FSR,F				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
00003c   0ba0     DECFSZ    0x20,0x1       			DECFSZ	L_Temp1,F			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00003d   283a     GOTO      0x3a           			GOTO	_CLR_MEM			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00003e   01f1     CLRF      0x71           			CLRF	L_EE_COUNT_L		;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00003f   0183     CLRF      0x3            			CLRF	STATUS				;BANK 0 REGISTERS                                              C:\Embedded\CC1000 RF communication\RF.ASM
000040   0194     CLRF      0x14           			CLRF	SSPCON				;disable serial port                                           C:\Embedded\CC1000 RF communication\RF.ASM
000041   019f     CLRF      0x1f           			CLRF	ADCON0				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000042   0198     CLRF      0x18           			CLRF	RCSTA				;Serial port disabled(bit banging)                              C:\Embedded\CC1000 RF communication\RF.ASM
000043   018b     CLRF      0xb            			CLRF	INTCON				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000044   0185     CLRF      0x5            			CLRF	PORTA				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000045   0186     CLRF      0x6            			CLRF	PORTB				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000046   0187     CLRF      0x7            			CLRF	PORTC				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000047   1683     BSF       0x3,0x5        			BSF		STATUS,RP0			;BANK 1 REGISTERS                                           C:\Embedded\CC1000 RF communication\RF.ASM
000048   3007     MOVLW     0x7            			MOVLW	7					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
000049   009f     MOVWF     0x1f           			MOVWF	ADCON1				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00004a   3003     MOVLW     0x3            			MOVLW	b'00000011'			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
00004b   008e     MOVWF     0xe            			MOVWF	PCON				;power-on, brown-out resets                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00004c   30ff     MOVLW     0xff           			MOVLW	0xFF				;  RA3=Master/Salve Strap (MSTRAP)                              C:\Embedded\CC1000 RF communication\RF.ASM
00004d   0085     MOVWF     0x5            			MOVWF	TRISA				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
00004e   30f9     MOVLW     0xf9           			MOVLW	0xF9				; RB0=DCLK,RB1=GREEN LED,RB2=RED LED,RB4=button                 C:\Embedded\CC1000 RF communication\RF.ASM
00004f   0086     MOVWF     0x6            			MOVWF	TRISB				;(read INTF INTCON<1> for external INT on RB0)                 C:\Embedded\CC1000 RF communication\RF.ASM
000050   30f0     MOVLW     0xf0           			MOVLW	0xF0				;RC<0,1,2,3>=PDATA,PCLK,PALE,DIO = out                          C:\Embedded\CC1000 RF communication\RF.ASM
000051   0087     MOVWF     0x7            			MOVWF	TRISC				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000052   3025     MOVLW     0x25           			MOVLW	25					;4Mhz,9.6Kb                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000053   0099     MOVWF     0x19           			MOVWF	SPBRG				;not necessary when running synchronous slave                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000054   3000     MOVLW     0x0            			MOVLW	b'00000000'			;MCU is slave,8bit,TxEN,Async,high speed,                 C:\Embedded\CC1000 RF communication\RF.ASM
000055   0098     MOVWF     0x18           			MOVWF	TXSTA				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000056   3000     MOVLW     0x0            			MOVLW	b'00000000'			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000057   008c     MOVWF     0xc            			MOVWF	PIE1				;TMR1 int disabled (xxxxxxx1)                                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000058   30c8     MOVLW     0xc8           			MOVLW	b'11001000'			;PortB pullups disabled,                                  C:\Embedded\CC1000 RF communication\RF.ASM
000059   0081     MOVWF     0x1            			MOVWF	OPTION_REG			;xxxx1000b prescaler assigned to WDT                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00005a   1283     BCF       0x3,0x5        			BCF		STATUS,RP0			;MORE BANK 0 REGISTERS                                      C:\Embedded\CC1000 RF communication\RF.ASM
00005b   3000     MOVLW     0x0            			MOVLW	b'00000000'			;xx00xx0x ; Timer1 1:1 prescale, timer1 OFF               C:\Embedded\CC1000 RF communication\RF.ASM
00005c   0090     MOVWF     0x10           			MOVWF	T1CON				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
00005d   30f0     MOVLW     0xf0           			MOVLW	RXMIT_TIM1L			;Reset TIMER1                                             C:\Embedded\CC1000 RF communication\RF.ASM
00005e   008e     MOVWF     0xe            			MOVWF	TMR1L				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
00005f   098e     COMF      0xe,0x1        			COMF	TMR1L,F				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000060   3055     MOVLW     0x55           			MOVLW	RXMIT_TIM1H			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000061   008f     MOVWF     0xf            			MOVWF	TMR1H				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000062   098f     COMF      0xf,0x1        			COMF	TMR1H,F				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000063   1487     BSF       0x7,0x1        			BSF		PCLK				;                                                                C:\Embedded\CC1000 RF communication\RF.ASM
000064   1407     BSF       0x7,0x0        			BSF		PDATA				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000065   1507     BSF       0x7,0x2        			BSF		PALE				;                                                                C:\Embedded\CC1000 RF communication\RF.ASM
000066   174a     BSF       0x4a,0x6       			BSF		CALIBRATION_OK		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000067   1506     BSF       0x6,0x2        			BSF		RED_LED				;start of CC1000 initialization                               C:\Embedded\CC1000 RF communication\RF.ASM
000068   22b8     CALL      0x2b8          			CALL	Setup_CC1000PD		;Setup after Power down CC1000                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000069   22c2     CALL      0x2c2          			CALL	Reset_CC1000		;Reset it  [(A) and (B) fig 16]                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00006a   3006     MOVLW     0x6            			MOVLW	CC1Kregs 			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00006b   22d0     CALL      0x2d0          			CALL	Setup_CC1000All		;Setup all other 28 registers [(C) fig 16]              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00006c   3044     MOVLW     0x44           			MOVLW	RX_CURRENT			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00006d   22df     CALL      0x2df          			CALL	WakeUpCC1000toRx	;Start calibration (A....G) fig 17)                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00006e   3044     MOVLW     0x44           			MOVLW	RX_CURRENT			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00006f   2326     CALL      0x326          			CALL	SetupCC1000Rx		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000070   1f4a     BTFSS     0x4a,0x6       			BTFSS	CALIBRATION_OK		;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
000071   287c     GOTO      0x7c           			GOTO	_CAL_ENDED			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000072   2382     CALL      0x382          			CALL	CalibrateCC1000		;Single calibration as TX                               C:\Embedded\CC1000 RF communication\RF.ASM
000073   1f4a     BTFSS     0x4a,0x6       			BTFSS	CALIBRATION_OK		;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
000074   287c     GOTO      0x7c           			GOTO	_CAL_ENDED			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000075   3081     MOVLW     0x81           			MOVLW	TX_CURRENT			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000076   2302     CALL      0x302          			CALL	WakeUpCC1000toTx	;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000077   3081     MOVLW     0x81           			MOVLW	TX_CURRENT			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000078   2350     CALL      0x350          			CALL	SetupCC1000Tx		;Switch to Tx                                             C:\Embedded\CC1000 RF communication\RF.ASM
000079   1f4a     BTFSS     0x4a,0x6       			BTFSS	CALIBRATION_OK		;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
00007a   287c     GOTO      0x7c           			GOTO	_CAL_ENDED			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00007b   2382     CALL      0x382          			CALL	CalibrateCC1000		;Single calibration  [(D) and (E) FIG 16]               C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00007c   1f4a     BTFSS     0x4a,0x6       _CAL_ENDED	BTFSS	CALIBRATION_OK		;                                               C:\Embedded\CC1000 RF communication\RF.ASM
00007d   2884     GOTO      0x84           			GOTO	_CAL_NOK			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
00007e   1106     BCF       0x6,0x2        			BCF		RED_LED				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
00007f   3003     MOVLW     0x3            			MOVLW	3					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
000080   00ce     MOVWF     0x4e           			MOVWF	L_GREEN_COU			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000081   30c6     MOVLW     0xc6           			MOVLW	SLOW_ON				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000082   00cd     MOVWF     0x4d           			MOVWF	L_GREEN_CTL			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000083   2888     GOTO      0x88           			GOTO	_INIT_CONT			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000084   3003     MOVLW     0x3            _CAL_NOK	MOVLW	3					;Flash 3 times to indicate failed                           C:\Embedded\CC1000 RF communication\RF.ASM
000085   00d1     MOVWF     0x51           			MOVWF	L_RED_COU			;startup of RF part                                         C:\Embedded\CC1000 RF communication\RF.ASM
000086   30c6     MOVLW     0xc6           			MOVLW	SLOW_ON				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000087   00d0     MOVWF     0x50           			MOVWF	L_RED_CTL			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000088   3088     MOVLW     0x88           _INIT_CONT	MOVLW	0x88				;set GIE<7>,INTE<4>,RBIE<3> (GIE,BUTTN)                 C:\Embedded\CC1000 RF communication\RF.ASM
000089   008b     MOVWF     0xb            			MOVWF	INTCON				;clear TMR0IF<2>,INTF<1>,RBIF<0>,PEIE<6>,                     C:\Embedded\CC1000 RF communication\RF.ASM
00008a   100c     BCF       0xc,0x0        			BCF		PIR1,TMR1IF			;clear TMR1 interrupt flag                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00008b   1410     BSF       0x10,0x0       			BSF		T1CON,TMR1ON		;Start timer1                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00008c   1985     BTFSC     0x5,0x3        			BTFSC	MSTRAP 				;Strap to high for MASTER                                    C:\Embedded\CC1000 RF communication\RF.ASM
00008d   2893     GOTO      0x93           			GOTO	_MASTER_RESET		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
00008e   3044     MOVLW     0x44           			MOVLW	RX_CURRENT			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00008f   2326     CALL      0x326          			CALL	SetupCC1000Rx		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000090   154c     BSF       0x4c,0x2       			BSF		SLAVE				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000091   15cc     BSF       0x4c,0x3       			BSF		RXCVER				; Slave stays in Rx mode                                       C:\Embedded\CC1000 RF communication\RF.ASM
000092   2899     GOTO      0x99           			GOTO	_RESET				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           _MASTER_RESET							;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000093   22b8     CALL      0x2b8          			CALL	Setup_CC1000PD		;Turn off CC1000 until master button is pressed (normally high) C:\Embedded\CC1000 RF communication\RF.ASM
000094   14cc     BSF       0x4c,0x1       			BSF		MASTER				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000095   16cc     BSF       0x4c,0x5       			BSF		QUIET				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000096   2899     GOTO      0x99           			GOTO	_RESET				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;If this is the master wait for the button press to start the query to the slave.   C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;If slave, wait for the button to be pressed or for the master's query.          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;ISR will trap the button for slave and master actions.                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000097   1eca     BTFSS     0x4a,0x5       _IDLE_LOOP	BTFSS	RESET_CNTRS			;                                                 C:\Embedded\CC1000 RF communication\RF.ASM
000098   28a3     GOTO      0xa3           			GOTO	_TIMR1_ACTIONS		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000099   01a3     CLRF      0x23           _RESET		CLRF	L_BYTES				;Start all over                                          C:\Embedded\CC1000 RF communication\RF.ASM
00009a   3008     MOVLW     0x8            			MOVLW	8					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
00009b   00a2     MOVWF     0x22           			MOVWF	L_BITS				;Initialize bit counter                                       C:\Embedded\CC1000 RF communication\RF.ASM
00009c   30ff     MOVLW     0xff           			MOVLW	-1					;  so index goes to 0 on BOF                                     C:\Embedded\CC1000 RF communication\RF.ASM
00009d   1a4c     BTFSC     0x4c,0x4       			BTFSC	TXMTER				;L_INDEX starts at -1 or 0 depending                          C:\Embedded\CC1000 RF communication\RF.ASM
00009e   0103     CLRW                     			CLRW						; on wether we're receiver or xmitter                               C:\Embedded\CC1000 RF communication\RF.ASM
00009f   00a6     MOVWF     0x26           			MOVWF	L_INDEX				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0000a0   124a     BCF       0x4a,0x4       			BCF		BYTE_FULL			;G_Events<4,5>                                               C:\Embedded\CC1000 RF communication\RF.ASM
0000a1   12ca     BCF       0x4a,0x5       			BCF		RESET_CNTRS			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0000a2   01cb     CLRF      0x4b           			CLRF	G_Pr_status			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           _TIMR1_ACTIONS							;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000a3   1c0c     BTFSS     0xc,0x0        			BTFSS	PIR1,TMR1IF			;TIMR1 expired?                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000a4   28af     GOTO      0xaf           			GOTO	_POLL_DCLCK			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0000a5   100c     BCF       0xc,0x0        			BCF		PIR1,TMR1IF			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0000a6   20c5     CALL      0xc5           			CALL	HANDLE_LED_BLINK	;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000a7   1ccc     BTFSS     0x4c,0x1       			BTFSS	MASTER				;IF TMR1 EXPIRED &                                            C:\Embedded\CC1000 RF communication\RF.ASM
0000a8   28af     GOTO      0xaf           			GOTO	_POLL_DCLCK			;   MASTER &                                               C:\Embedded\CC1000 RF communication\RF.ASM
0000a9   1dcc     BTFSS     0x4c,0x3       			BTFSS	RXCVER				;   ~XMITTER &                                                C:\Embedded\CC1000 RF communication\RF.ASM
0000aa   28af     GOTO      0xaf           			GOTO	_POLL_DCLCK			;   ~BOF_FOUND                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000ab   184b     BTFSC     0x4b,0x0       			BTFSC	BOF_FOUND			;THEN                                                       C:\Embedded\CC1000 RF communication\RF.ASM
0000ac   28af     GOTO      0xaf           			GOTO	_POLL_DCLCK			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0000ad   218a     CALL      0x18a          			CALL	START_MST_XMIT		; Time to send again                                     C:\Embedded\CC1000 RF communication\RF.ASM
0000ae   28c4     GOTO      0xc4           			GOTO	_COMMS_END			;ENDIF                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           _POLL_DCLCK								;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000af   1c8b     BTFSS     0xb,0x1        			BTFSS	INTCON,INTF			;IF DCLCK PULSE &                                         C:\Embedded\CC1000 RF communication\RF.ASM
0000b0   28c4     GOTO      0xc4           			GOTO	_COMMS_END			;   ~QUIET                                                  C:\Embedded\CC1000 RF communication\RF.ASM
0000b1   1acc     BTFSC     0x4c,0x5       			BTFSC	QUIET				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0000b2   28c4     GOTO      0xc4           			GOTO	_COMMS_END			;THEN                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000b3   1dcc     BTFSS     0x4c,0x3       			BTFSS	RXCVER				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000b4   28bb     GOTO      0xbb           			GOTO	_XMIT				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000b5   20f2     CALL      0xf2           _RCVE		CALL	RECEIVE_BIT			;  IF RECEIVER                                         C:\Embedded\CC1000 RF communication\RF.ASM
0000b6   1e4a     BTFSS     0x4a,0x4       			BTFSS	BYTE_FULL			;     (Master or Slave) receive next bit                    C:\Embedded\CC1000 RF communication\RF.ASM
0000b7   28c4     GOTO      0xc4           			GOTO	_COMMS_END			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000b8   2158     CALL      0x158          			CALL	RECEIVE_BYTE		;     IF received a full byte                              C:\Embedded\CC1000 RF communication\RF.ASM
0000b9   124a     BCF       0x4a,0x4       			BCF		BYTE_FULL			;       check protocol parts                                 C:\Embedded\CC1000 RF communication\RF.ASM
0000ba   28c4     GOTO      0xc4           			GOTO	_COMMS_END			;     ENDIF                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;  ELSE (XMT)                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0000bb   2123     CALL      0x123          _XMIT		CALL	SEND_BIT			;     Send next bit                                       C:\Embedded\CC1000 RF communication\RF.ASM
0000bc   1e4a     BTFSS     0x4a,0x4       			BTFSS	BYTE_FULL			;     IF full byte sent                                     C:\Embedded\CC1000 RF communication\RF.ASM
0000bd   28c4     GOTO      0xc4           			GOTO	_COMMS_END			;        IF MASTER                                          C:\Embedded\CC1000 RF communication\RF.ASM
0000be   1ccc     BTFSS     0x4c,0x1       			BTFSS	MASTER				;          do master EOTX actions                             C:\Embedded\CC1000 RF communication\RF.ASM
0000bf   28c2     GOTO      0xc2           			GOTO	_XMIT_SLV			;           (see if finished, adjust index)                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;         ELSE (slave)                                                 C:\Embedded\CC1000 RF communication\RF.ASM
0000c0   2193     CALL      0x193          			CALL	CHECK_MST_EOTX		;           do slave EOTX actions                        C:\Embedded\CC1000 RF communication\RF.ASM
0000c1   28c3     GOTO      0xc3           			GOTO	_XMIT_END			;         ENDIF                                              C:\Embedded\CC1000 RF communication\RF.ASM
0000c2   21c2     CALL      0x1c2          _XMIT_SLV	CALL	CHECK_SLV_EOTX		;                                                 C:\Embedded\CC1000 RF communication\RF.ASM
0000c3   124a     BCF       0x4a,0x4       _XMIT_END	BCF		BYTE_FULL			;      ENDIF                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;   ENDIF                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0000c4   2897     GOTO      0x97           _COMMS_END	GOTO	_IDLE_LOOP			;ENDIF (end of idle loop)                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;This procedure handles the blinking of the LEDs which are candenced by TMR1     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           HANDLE_LED_BLINK                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
0000c5   1f4d     BTFSS     0x4d,0x6       _GREEN_LED	BTFSS	GREEN_FLAG			;                                                  C:\Embedded\CC1000 RF communication\RF.ASM
0000c6   28db     GOTO      0xdb           			GOTO	_RED_LED			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000c7   08cf     MOVF      0x4f,0x1       			MOVF	L_GR_SPEED,F		;test if zero                                              C:\Embedded\CC1000 RF communication\RF.ASM
0000c8   1903     BTFSC     0x3,0x2        			BTFSC	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0000c9   28cc     GOTO      0xcc           			GOTO	_TOGGLE_GR			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000ca   03cf     DECF      0x4f,0x1       			DECF	L_GR_SPEED,F		;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0000cb   28db     GOTO      0xdb           			GOTO	_RED_LED			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000cc   0d4d     RLF       0x4d,0x0       _TOGGLE_GR	RLF		L_GREEN_CTL,W		;Rotate through carry                             C:\Embedded\CC1000 RF communication\RF.ASM
0000cd   1c03     BTFSS     0x3,0x0        			BTFSS	STATUS,C			; and flip the toggle bit                                    C:\Embedded\CC1000 RF communication\RF.ASM
0000ce   28d2     GOTO      0xd2           			GOTO	_GREEN_OFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000cf   1486     BSF       0x6,0x1        			BSF		GREEN_LED			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0000d0   13cd     BCF       0x4d,0x7       			BCF		TOGGLE_G			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000d1   28d8     GOTO      0xd8           			GOTO	_RES_G_SPD			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000d2   1086     BCF       0x6,0x1        _GREEN_OFF	BCF		GREEN_LED			;Decrement the count only on OFF                     C:\Embedded\CC1000 RF communication\RF.ASM
0000d3   17cd     BSF       0x4d,0x7       			BSF		TOGGLE_G			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000d4   0bce     DECFSZ    0x4e,0x1       			DECFSZ	L_GREEN_COU,F		;Reached number of toggles?                             C:\Embedded\CC1000 RF communication\RF.ASM
0000d5   28d8     GOTO      0xd8           			GOTO	_RES_G_SPD			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000d6   01cd     CLRF      0x4d           			CLRF	L_GREEN_CTL			;finished			                                               C:\Embedded\CC1000 RF communication\RF.ASM
0000d7   28db     GOTO      0xdb           			GOTO	_RED_LED			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000d8   084d     MOVF      0x4d,0x0       _RES_G_SPD	MOVF	L_GREEN_CTL,W		;Reset the speed counter                          C:\Embedded\CC1000 RF communication\RF.ASM
0000d9   393f     ANDLW     0x3f           			ANDLW	0x3F				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0000da   00cf     MOVWF     0x4f           			MOVWF	L_GR_SPEED			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000db   1f50     BTFSS     0x50,0x6       _RED_LED	BTFSS	RED_FLAG			;                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000dc   28f1     GOTO      0xf1           			GOTO	_BLINK_END			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000dd   08d2     MOVF      0x52,0x1       			MOVF	L_RED_SPEED,F		;test if zero                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000de   1903     BTFSC     0x3,0x2        			BTFSC	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0000df   28e2     GOTO      0xe2           			GOTO	_TOGGLE_RD			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000e0   03d2     DECF      0x52,0x1       			DECF	L_RED_SPEED,F		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
0000e1   28f1     GOTO      0xf1           			GOTO	_BLINK_END			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000e2   0d50     RLF       0x50,0x0       _TOGGLE_RD	RLF		L_RED_CTL,W			;Rotate through carry                              C:\Embedded\CC1000 RF communication\RF.ASM
0000e3   1c03     BTFSS     0x3,0x0        			BTFSS	STATUS,C			; and flip the toggle bit                                    C:\Embedded\CC1000 RF communication\RF.ASM
0000e4   28e8     GOTO      0xe8           			GOTO	_RED_OFF			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000e5   1506     BSF       0x6,0x2        			BSF		RED_LED				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000e6   13d0     BCF       0x50,0x7       			BCF		TOGGLE_R			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000e7   28ee     GOTO      0xee           			GOTO	_RES_R_SPD			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000e8   1106     BCF       0x6,0x2        _RED_OFF	BCF		RED_LED				;Decrement the count only on OFF                        C:\Embedded\CC1000 RF communication\RF.ASM
0000e9   17d0     BSF       0x50,0x7       			BSF		TOGGLE_R			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0000ea   0bd1     DECFSZ    0x51,0x1       			DECFSZ	L_RED_COU,F			;Reached number of toggles?                              C:\Embedded\CC1000 RF communication\RF.ASM
0000eb   28ee     GOTO      0xee           			GOTO	_RES_R_SPD			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000ec   01d0     CLRF      0x50           			CLRF	L_RED_CTL			;finished			                                                 C:\Embedded\CC1000 RF communication\RF.ASM
0000ed   28f1     GOTO      0xf1           			GOTO	_BLINK_END			;		                                                         C:\Embedded\CC1000 RF communication\RF.ASM
0000ee   0850     MOVF      0x50,0x0       _RES_R_SPD	MOVF	L_RED_CTL,W			;Reset the speed counter                           C:\Embedded\CC1000 RF communication\RF.ASM
0000ef   393f     ANDLW     0x3f           			ANDLW	0x3F				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0000f0   00d2     MOVWF     0x52           			MOVWF	L_RED_SPEED			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000f1   0008     RETURN                   _BLINK_END	RETURN						;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Receive the next bit,count full bytes, find the beginning of a frame.           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: Idle loop                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           RECEIVE_BIT                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000f2   3006     MOVLW     0x6            _DATA_IN	MOVLW	d'6'				;do a persistancy check first (50us)                      C:\Embedded\CC1000 RF communication\RF.ASM
0000f3   00c9     MOVWF     0x49           			MOVWF	L_PERSIST			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000f4   1c06     BTFSS     0x6,0x0        _DCLK_IN	BTFSS	DCLK				;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
0000f5   2922     GOTO      0x122          			GOTO	_NO_BIT_IN			;ignore spikes                                              C:\Embedded\CC1000 RF communication\RF.ASM
0000f6   0bc9     DECFSZ    0x49,0x1       			DECFSZ	L_PERSIST,F			;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
0000f7   28f4     GOTO      0xf4           			GOTO	_DCLK_IN			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0000f8   0807     MOVF      0x7,0x0        _RX_CONT	MOVF	PORTC,W				;Persistancy check on the port                          C:\Embedded\CC1000 RF communication\RF.ASM
0000f9   3908     ANDLW     0x8            			ANDLW	8					;PORTC<3>                                                         C:\Embedded\CC1000 RF communication\RF.ASM
0000fa   00a7     MOVWF     0x27           			MOVWF	L_PORTC				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0000fb   3004     MOVLW     0x4            			MOVLW	d'4'				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0000fc   00c9     MOVWF     0x49           			MOVWF	L_PERSIST			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0000fd   0807     MOVF      0x7,0x0        _DIO_IN_P	MOVF	PORTC,W				;read again                                            C:\Embedded\CC1000 RF communication\RF.ASM
0000fe   3908     ANDLW     0x8            			ANDLW	8					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
0000ff   0627     XORWF     0x27,0x0       			XORWF	L_PORTC,W			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000100   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;still the same?                                             C:\Embedded\CC1000 RF communication\RF.ASM
000101   2922     GOTO      0x122          			GOTO	_NO_BIT_IN			;ignore spikes                                              C:\Embedded\CC1000 RF communication\RF.ASM
000102   0bc9     DECFSZ    0x49,0x1       			DECFSZ	L_PERSIST,F			;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000103   28fd     GOTO      0xfd           			GOTO	_DIO_IN_P			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000104   1003     BCF       0x3,0x0        			CLRC						;Accept bit                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000105   0da8     RLF       0x28,0x1       			RLF		L_DATA_RX,F			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000106   0103     CLRW                     			CLRW						;                                                                   C:\Embedded\CC1000 RF communication\RF.ASM
000107   19a7     BTFSC     0x27,0x3       			BTFSC	L_PORTC,3			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000108   3001     MOVLW     0x1            			MOVLW	1					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
000109   04a8     IORWF     0x28,0x1       			IORWF	L_DATA_RX,F			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00010a   184b     BTFSC     0x4b,0x0       			BTFSC	BOF_FOUND			; If BOF has been found we are now collecting data          C:\Embedded\CC1000 RF communication\RF.ASM
00010b   2915     GOTO      0x115          			GOTO	_BOF_CONT2			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;Look for BOF                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00010c   0828     MOVF      0x28,0x0       			MOVF	L_DATA_RX,W			;This check is done bit by bit through the 1st             C:\Embedded\CC1000 RF communication\RF.ASM
00010d   3caa     SUBLW     0xaa           			SUBLW	0xAA				; byte of the preamble                                          C:\Embedded\CC1000 RF communication\RF.ASM
00010e   1903     BTFSC     0x3,0x2        			BTFSC	STATUS,Z			;zero flag set when 0 (EQ)                                   C:\Embedded\CC1000 RF communication\RF.ASM
00010f   2912     GOTO      0x112          			GOTO	_BOF_FOUND			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000110   104b     BCF       0x4b,0x0       _NO_BOF		BCF		BOF_FOUND			;                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000111   2921     GOTO      0x121          			GOTO	_RX_END				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000112   144b     BSF       0x4b,0x0       _BOF_FOUND	BSF		BOF_FOUND			;Begining of Frame found                             C:\Embedded\CC1000 RF communication\RF.ASM
000113   3001     MOVLW     0x1            			MOVLW	1					;Force recognition of 1st byte of data                            C:\Embedded\CC1000 RF communication\RF.ASM
000114   00a2     MOVWF     0x22           			MOVWF	L_BITS				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000115   0ba2     DECFSZ    0x22,0x1       _BOF_CONT2	DECFSZ	L_BITS,F			;8 bits received?                                   C:\Embedded\CC1000 RF communication\RF.ASM
000116   2921     GOTO      0x121          			GOTO	_RX_END				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000117   164a     BSF       0x4a,0x4       			BSF		BYTE_FULL			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000118   0aa3     INCF      0x23,0x1       			INCF	L_BYTES,F			;L_BYTES are modified by each procedure                      C:\Embedded\CC1000 RF communication\RF.ASM
000119   0aa6     INCF      0x26,0x1       			INCF	L_INDEX,F			;  (on detection of BOF, L_BYTES is 1)                       C:\Embedded\CC1000 RF communication\RF.ASM
00011a   3008     MOVLW     0x8            			MOVLW	8					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
00011b   00a2     MOVWF     0x22           			MOVWF	L_BITS				;reset bit count                                              C:\Embedded\CC1000 RF communication\RF.ASM
00011c   0826     MOVF      0x26,0x0       			MOVF	L_INDEX,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00011d   3e29     ADDLW     0x29           			ADDLW	L_RX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00011e   0084     MOVWF     0x4            			MOVWF	FSR					;Complete byte put in the RX_BUFFER                             C:\Embedded\CC1000 RF communication\RF.ASM
00011f   0828     MOVF      0x28,0x0       			MOVF	L_DATA_RX,W			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000120   0080     MOVWF     0x0            			MOVWF	INDF				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000121   108b     BCF       0xb,0x1        _RX_END		BCF		INTCON,INTF			;                                                    C:\Embedded\CC1000 RF communication\RF.ASM
000122   0008     RETURN                   _NO_BIT_IN	RETURN                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Send the next bit in L_TX_BUFF(L_INDEX,L_BITS)                                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           SEND_BIT								;                                                                C:\Embedded\CC1000 RF communication\RF.ASM
000123   300c     MOVLW     0xc            			MOVLW	d'12'				;persistancy check 50us                                        C:\Embedded\CC1000 RF communication\RF.ASM
000124   00c9     MOVWF     0x49           			MOVWF	L_PERSIST			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000125   1806     BTFSC     0x6,0x0        _DCLK_OUT	BTFSC	DCLK				;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000126   293a     GOTO      0x13a          			GOTO	_NO_BIT_OUT			;ignore spikes                                             C:\Embedded\CC1000 RF communication\RF.ASM
000127   0bc9     DECFSZ    0x49,0x1       			DECFSZ	L_PERSIST,F			;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000128   2925     GOTO      0x125          			GOTO	_DCLK_OUT			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000129   0826     MOVF      0x26,0x0       _TX_CONT	MOVF	L_INDEX,W			;                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00012a   3e39     ADDLW     0x39           			ADDLW	L_TX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00012b   0084     MOVWF     0x4            			MOVWF	FSR					;Data to send: L_TX_BUFFER(L_INDEX<L_BITS>)                     C:\Embedded\CC1000 RF communication\RF.ASM
00012c   0d80     RLF       0x0,0x1        			RLF		INDF,F				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
00012d   1c03     BTFSS     0x3,0x0        			BTFSS	STATUS,C			;CARRY?                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00012e   2931     GOTO      0x131          			GOTO	_CLR_DIO			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
00012f   1587     BSF       0x7,0x3        			BSF		DIO					;                                                                C:\Embedded\CC1000 RF communication\RF.ASM
000130   2932     GOTO      0x132          			GOTO	_XM_CONT			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000131   1187     BCF       0x7,0x3        _CLR_DIO	BCF		DIO					;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000132   0ba2     DECFSZ    0x22,0x1       _XM_CONT	DECFSZ	L_BITS,F			;8 bits sent?                                         C:\Embedded\CC1000 RF communication\RF.ASM
000133   2939     GOTO      0x139          			GOTO	_OUT_END			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000134   164a     BSF       0x4a,0x4       			BSF		BYTE_FULL			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000135   0aa3     INCF      0x23,0x1       			INCF	L_BYTES,F			;L_BYTES is modified by each procedure                       C:\Embedded\CC1000 RF communication\RF.ASM
000136   0aa6     INCF      0x26,0x1       			INCF	L_INDEX,F			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000137   3008     MOVLW     0x8            			MOVLW	8					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
000138   00a2     MOVWF     0x22           			MOVWF	L_BITS				;reset bit count                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000139   108b     BCF       0xb,0x1        _OUT_END	BCF		INTCON,INTF			;                                                    C:\Embedded\CC1000 RF communication\RF.ASM
00013a   0008     RETURN                   _NO_BIT_OUT	RETURN						;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Procedure:	Service_Interrupt                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Function:	Handles Interrupts for the Push Button and the TMR1 expiration.       C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;           Handling of the button is different depending on wether this is      C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			the Master or the Slave.                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Inputs:	None                                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Returns:	Nothing.                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           Service_Interrupt						;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
00013b   00f9     MOVWF     0x79           			MOVWF	W_TEMP				;W_TEMP MUST be in shared memory                              C:\Embedded\CC1000 RF communication\RF.ASM
00013c   0e03     SWAPF     0x3,0x0        			SWAPF	STATUS,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00013d   00d6     MOVWF     0x56           			MOVWF	STATUS_TEMP			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
00013e   0183     CLRF      0x3            			CLRF	STATUS				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
00013f   00d6     MOVWF     0x56           			MOVWF	STATUS_TEMP			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000140   1c0b     BTFSS     0xb,0x0        			BTFSS	INTCON,RBIF			;BUTTON PRESS (PORTB<4> state change)?                    C:\Embedded\CC1000 RF communication\RF.ASM
000141   2172     CALL      0x172          			CALL	TREAT_ERROR			; Unknown Interrupt                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;Read the port so it can be cleared                                    C:\Embedded\CC1000 RF communication\RF.ASM
000142   0806     MOVF      0x6,0x0        			MOVF	PORTB,W				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000143   1a06     BTFSC     0x6,0x4        			BTFSC	PORTB,4				;Button pushed                                               C:\Embedded\CC1000 RF communication\RF.ASM
000144   2952     GOTO      0x152          			GOTO	_RES_RBIF			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000145   3064     MOVLW     0x64           _WAI_RELS	MOVLW	d'100'				;Introduce delays to avoid bouncing                    C:\Embedded\CC1000 RF communication\RF.ASM
000146   23ae     CALL      0x3ae          			CALL	DelaymS				; (note that interrupts are disabled)                         C:\Embedded\CC1000 RF communication\RF.ASM
000147   1e06     BTFSS     0x6,0x4        			BTFSS	PORTB,4				;Stay in loop while button is released                       C:\Embedded\CC1000 RF communication\RF.ASM
000148   2945     GOTO      0x145          			GOTO	_WAI_RELS			;(normally high goes low when pushed)                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000149   1ccc     BTFSS     0x4c,0x1       			BTFSS	MASTER 				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00014a   2951     GOTO      0x151          			GOTO	_BUTTN_SLV			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00014b   1ecc     BTFSS     0x4c,0x5       			BTFSS	QUIET				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
00014c   2952     GOTO      0x152          			GOTO	_RES_RBIF			;Send from master only if we're not already                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           										; sending or receiveing                                                C:\Embedded\CC1000 RF communication\RF.ASM
00014d   3081     MOVLW     0x81           			MOVLW	TX_CURRENT			;First power up CC1000 - consider at least 14ms            C:\Embedded\CC1000 RF communication\RF.ASM
00014e   2302     CALL      0x302          			CALL	WakeUpCC1000toTx	;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00014f   218a     CALL      0x18a          			CALL	START_MST_XMIT		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000150   2952     GOTO      0x152          			GOTO	_RES_RBIF			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000151   2183     CALL      0x183          _BUTTN_SLV	CALL	SLAVE_BUTTON		;                                                  C:\Embedded\CC1000 RF communication\RF.ASM
000152   100b     BCF       0xb,0x0        _RES_RBIF	BCF		INTCON,RBIF			;                                                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000153   0e56     SWAPF     0x56,0x0       _ISR_END	SWAPF	STATUS_TEMP,W		;                                                  C:\Embedded\CC1000 RF communication\RF.ASM
000154   0083     MOVWF     0x3            			MOVWF	STATUS				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000155   0ef9     SWAPF     0x79,0x1       			SWAPF	W_TEMP,F			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000156   0e79     SWAPF     0x79,0x0       			SWAPF	W_TEMP,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000157   0009     RETFIE                   			RETFIE						;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Treat reception of a packet - the first byte of the pre-amble has already been  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;detected                                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: Idle Loop                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           RECEIVE_BYTE							;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000158   18cb     BTFSC     0x4b,0x1       			BTFSC	PREAM_FINISHED		;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
000159   295c     GOTO      0x15c          			GOTO	_UNIQUE_ID			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00015a   21d0     CALL      0x1d0          			CALL	CHECK_PREAMBLE		;Continue checking the preamble                          C:\Embedded\CC1000 RF communication\RF.ASM
00015b   2970     GOTO      0x170          			GOTO	_RCV_FINISH			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00015c   194b     BTFSC     0x4b,0x2       _UNIQUE_ID	BTFSC	UI_FINISHED			;                                                 C:\Embedded\CC1000 RF communication\RF.ASM
00015d   2960     GOTO      0x160          			GOTO	_ADDRESS			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
00015e   21e2     CALL      0x1e2          			CALL	CHECK_UI			;Frame valid, checks the Unique Identifier                    C:\Embedded\CC1000 RF communication\RF.ASM
00015f   2970     GOTO      0x170          			GOTO	_RCV_FINISH			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000160   19cb     BTFSC     0x4b,0x3       _ADDRESS	BTFSC	ADDR_CMPLT			;                                                    C:\Embedded\CC1000 RF communication\RF.ASM
000161   2964     GOTO      0x164          			GOTO	_NBR_BYTES			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000162   21f9     CALL      0x1f9          			CALL	CHECK_ADDR			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000163   2970     GOTO      0x170          			GOTO	_RCV_FINISH			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000164   1a4b     BTFSC     0x4b,0x4       _NBR_BYTES	BTFSC	NBR_BYTES_RCVD		;Number of bytes field has been received        C:\Embedded\CC1000 RF communication\RF.ASM
000165   2968     GOTO      0x168          			GOTO	_RECV_DATA			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000166   220a     CALL      0x20a          			CALL	NBR_BYTES_DATA		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000167   2970     GOTO      0x170          			GOTO	_RCV_FINISH			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000168   1acb     BTFSC     0x4b,0x5       _RECV_DATA	BTFSC	DATA_RECEIVED		;                                                C:\Embedded\CC1000 RF communication\RF.ASM
000169   296c     GOTO      0x16c          			GOTO	_SUMCHECK			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00016a   2217     CALL      0x217          			CALL	ACCEPT_DATA			;data is made available                                    C:\Embedded\CC1000 RF communication\RF.ASM
00016b   2970     GOTO      0x170          			GOTO	_RCV_FINISH			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00016c   1b4b     BTFSC     0x4b,0x6       _SUMCHECK	BTFSC	SUMCHECK_DONE		;                                                 C:\Embedded\CC1000 RF communication\RF.ASM
00016d   296f     GOTO      0x16f          			GOTO	_ACCEPT_COMMAND		;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
00016e   2224     CALL      0x224          			CALL	CHECK_SUM			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           _ACCEPT_COMMAND							;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00016f   2237     CALL      0x237          			CALL	PROCESS_DATA		;Finished - sets RESET_CNTRS to force start over           C:\Embedded\CC1000 RF communication\RF.ASM
                                           _RCV_FINISH								;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000170   01a8     CLRF      0x28           			CLRF	L_DATA_RX			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000171   0008     RETURN                   			RETURN						;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;This is a good place to set a breakpoint in case of error                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           TREAT_ERROR                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
                                           			Global	TREAT_ERROR                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000172   0000     NOP                      			nop							;BREAKPOINT TO RAISE THE FLAG                                       C:\Embedded\CC1000 RF communication\RF.ASM
000173   1c54     BTFSS     0x54,0x0       			btfss	D_ERROR_FLG,0		;Set this flag to 1 while in debugging mode              C:\Embedded\CC1000 RF communication\RF.ASM
000174   2980     GOTO      0x180          			GOTO	_SKIP_REGS			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000175   01d5     CLRF      0x55           			clrf	D_BUGGGER			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000176   0855     MOVF      0x55,0x0       _read_all	movf	D_BUGGGER,w			;                                                   C:\Embedded\CC1000 RF communication\RF.ASM
000177   00da     MOVWF     0x5a           			movwf	G_CC_Reg			;read all regs 1 by 1                                        C:\Embedded\CC1000 RF communication\RF.ASM
000178   3c1c     SUBLW     0x1c           			sublw	d'28'				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000179   1c03     BTFSS     0x3,0x0        			btfss	STATUS,C			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00017a   2980     GOTO      0x180          			goto	_SKIP_REGS			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00017b   2282     CALL      0x282          			call	ReadFromCC1000register                                                   C:\Embedded\CC1000 RF communication\RF.ASM
00017c   085b     MOVF      0x5b,0x0       			movf	G_CC_Data,w			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00017d   0000     NOP                      			nop							;BREAKPOINT TO READ THE REGISTER                                    C:\Embedded\CC1000 RF communication\RF.ASM
00017e   0ad5     INCF      0x55,0x1       			incf	D_BUGGGER,f			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00017f   2976     GOTO      0x176          			goto	_read_all			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000180   0ad3     INCF      0x53,0x1       _SKIP_REGS	incf	D_ERROR_CNT,F		;count transmission errors										;             C:\Embedded\CC1000 RF communication\RF.ASM
000181   16ca     BSF       0x4a,0x5       			bsf		RESET_CNTRS			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000182   0008     RETURN                   			RETURN                                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Read, increment and re-write the counter                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Runs on interrupts disabled                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: ISR                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           SLAVE_BUTTON							;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			CALL	READ_EEPROM			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000183   1d4a     BTFSS     0x4a,0x2       			BTFSS	NEW_COUNT			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000184   2987     GOTO      0x187          			GOTO	_COUNT_UP			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000185   114a     BCF       0x4a,0x2       			BCF		NEW_COUNT			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000186   01f1     CLRF      0x71           			CLRF	L_EE_COUNT_L		;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000187   0af1     INCF      0x71,0x1       _COUNT_UP	INCF	L_EE_COUNT_L,F		;Increment the counter                            C:\Embedded\CC1000 RF communication\RF.ASM
000188   0000     NOP                      			NOP							;This is where we would treat an overflow                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			CALL	WRITE_EEPROM		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000189   0008     RETURN                   			RETURN						;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Setup the buffer which will be transmitted in NEXT_BIT, then become transmitter. C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: ISR, Idle loop                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           START_MST_XMIT							;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00018a   1486     BSF       0x6,0x1        			BSF		GREEN_LED			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00018b   224d     CALL      0x24d          			CALL	FILL_TX_BUFFER		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;Here we could add additional instructions for                         C:\Embedded\CC1000 RF communication\RF.ASM
00018c   3081     MOVLW     0x81           			MOVLW	TX_CURRENT			; the slave in the TX buffer                               C:\Embedded\CC1000 RF communication\RF.ASM
00018d   2350     CALL      0x350          			CALL	SetupCC1000Tx		;Switch to Tx                                             C:\Embedded\CC1000 RF communication\RF.ASM
00018e   12cc     BCF       0x4c,0x5       			BCF		QUIET				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
00018f   11cc     BCF       0x4c,0x3       			BCF		RXCVER				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000190   164c     BSF       0x4c,0x4       			BSF		TXMTER				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000191   16ca     BSF       0x4a,0x5       			BSF		RESET_CNTRS			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000192   0008     RETURN                   			RETURN						;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;When transmission is finished, become receiver and set the retry timer.         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: Idle loop                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           CHECK_MST_EOTX							;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000193   0826     MOVF      0x26,0x0       			MOVF	L_INDEX,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000194   3c10     SUBLW     0x10           			SUBLW	TOT_FRAME_SIZ		;	                                                       C:\Embedded\CC1000 RF communication\RF.ASM
000195   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000196   29a9     GOTO      0x1a9          			GOTO	_MASTR_NOT_DONE		;still sending bits...                                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000197   3044     MOVLW     0x44           			MOVLW	RX_CURRENT			;Tranmission is finished, become receiver again            C:\Embedded\CC1000 RF communication\RF.ASM
000198   2326     CALL      0x326          			CALL	SetupCC1000Rx		;(NOTE: this takes as much as 4-5 mS!!)                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000199   0ad9     INCF      0x59,0x1       			INCF	D_BUG2,F			;for debug, indicate MASTER-TX buffer sent                    C:\Embedded\CC1000 RF communication\RF.ASM
00019a   0859     MOVF      0x59,0x0       			MOVF	D_BUG2,W			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
00019b   00b9     MOVWF     0x39           			MOVWF	L_TX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00019c   1010     BCF       0x10,0x0       			BCF		T1CON,TMR1ON		;Reset TIMER1                                              C:\Embedded\CC1000 RF communication\RF.ASM
00019d   100c     BCF       0xc,0x0        			BCF		PIR1,TMR1IF			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00019e   30f0     MOVLW     0xf0           			MOVLW	RXMIT_TIM1L			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
00019f   008e     MOVWF     0xe            			MOVWF	TMR1L				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001a0   098e     COMF      0xe,0x1        			COMF	TMR1L,F				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0001a1   3055     MOVLW     0x55           			MOVLW	RXMIT_TIM1H			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
0001a2   008f     MOVWF     0xf            			MOVWF	TMR1H				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001a3   098f     COMF      0xf,0x1        			COMF	TMR1H,F				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0001a4   1410     BSF       0x10,0x0       			BSF		T1CON,TMR1ON		;Start timer1                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001a5   124c     BCF       0x4c,0x4       			BCF		TXMTER				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001a6   15cc     BSF       0x4c,0x3       			BSF		RXCVER				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001a7   1086     BCF       0x6,0x1        			BCF		GREEN_LED			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001a8   16ca     BSF       0x4a,0x5       			BSF		RESET_CNTRS			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           _MASTR_NOT_DONE							;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0001a9   0008     RETURN                   			RETURN						;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Prepare the slave response, fill the buffer add the EEPROM data, recalculate the SC  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;and become transmitter                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: PROCESS_DATA                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           START_SLV_XMIT                                                                   C:\Embedded\CC1000 RF communication\RF.ASM
0001aa   1486     BSF       0x6,0x1        			BSF		GREEN_LED			;Signal                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001ab   224d     CALL      0x24d          			CALL	FILL_TX_BUFFER		;Build the TX_BUFFER                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			CALL	READ_EEPROM			;Get the EEPROM counters                                  C:\Embedded\CC1000 RF communication\RF.ASM
0001ac   0871     MOVF      0x71,0x0       			MOVF	L_EE_COUNT_L,W		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
0001ad   00a0     MOVWF     0x20           			MOVWF	L_Temp1				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001ae   3039     MOVLW     0x39           			MOVLW	L_TX_BUFF			;put it as last byte of data                                C:\Embedded\CC1000 RF communication\RF.ASM
0001af   3e0e     ADDLW     0xe            			ADDLW	(DATA_OFFS+6)		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
0001b0   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0001b1   0820     MOVF      0x20,0x0       			MOVF	L_Temp1,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001b2   0080     MOVWF     0x0            			MOVWF	INDF				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001b3   3039     MOVLW     0x39           			MOVLW	L_TX_BUFF			;Update CS                                                  C:\Embedded\CC1000 RF communication\RF.ASM
0001b4   3e0f     ADDLW     0xf            			ADDLW	SUM_CHECK			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0001b5   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0001b6   0800     MOVF      0x0,0x0        			MOVF	INDF,W				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001b7   0720     ADDWF     0x20,0x0       			ADDWF	L_Temp1,W			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0001b8   0080     MOVWF     0x0            			MOVWF	INDF				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;clear EEPROM counter                                                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			CALL	WRITE_EEPROM		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001b9   3081     MOVLW     0x81           			MOVLW	TX_CURRENT			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0001ba   2350     CALL      0x350          			CALL	SetupCC1000Tx		;Become transmitter                                       C:\Embedded\CC1000 RF communication\RF.ASM
0001bb   3007     MOVLW     0x7            			MOVLW	d'7'				;necessary courtesy wait for master tx -> rx transition         C:\Embedded\CC1000 RF communication\RF.ASM
0001bc   23ae     CALL      0x3ae          			CALL	DelaymS				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001bd   154a     BSF       0x4a,0x2       			BSF		NEW_COUNT			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001be   11cc     BCF       0x4c,0x3       			BCF		RXCVER				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001bf   164c     BSF       0x4c,0x4       			BSF		TXMTER				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001c0   16ca     BSF       0x4a,0x5       			BSF		RESET_CNTRS			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0001c1   0008     RETURN                   			RETURN						;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;This procedure gets called each time a full byte (8 bits) has been transmitted by C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;SEND_BIT.  When the end of the buffer is reached, it causes this PIC to become a C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;receiver again.                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: Idle loop                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           CHECK_SLV_EOTX							;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0001c2   0826     MOVF      0x26,0x0       			MOVF	L_INDEX,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001c3   3c10     SUBLW     0x10           			SUBLW	TOT_FRAME_SIZ		;Check for end of tranmission	                           C:\Embedded\CC1000 RF communication\RF.ASM
0001c4   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001c5   29cf     GOTO      0x1cf          			GOTO	_SLAVE_DONE			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;we're done sending                                                    C:\Embedded\CC1000 RF communication\RF.ASM
0001c6   3044     MOVLW     0x44           			MOVLW	RX_CURRENT			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0001c7   2326     CALL      0x326          			CALL	SetupCC1000Rx		;Become receiver again                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001c8   0ad9     INCF      0x59,0x1       			INCF	D_BUG2,F			;for debug, indicate SLAVE-TX buffer sent                     C:\Embedded\CC1000 RF communication\RF.ASM
0001c9   0859     MOVF      0x59,0x0       			MOVF	D_BUG2,W			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0001ca   00b9     MOVWF     0x39           			MOVWF	L_TX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001cb   124c     BCF       0x4c,0x4       			BCF		TXMTER				; initiate transmission                                        C:\Embedded\CC1000 RF communication\RF.ASM
0001cc   15cc     BSF       0x4c,0x3       			BSF		RXCVER				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001cd   1086     BCF       0x6,0x1        			BCF		GREEN_LED			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001ce   16ca     BSF       0x4a,0x5       			BSF		RESET_CNTRS			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0001cf   0008     RETURN                   _SLAVE_DONE	RETURN                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;This is the first procedure to be called after a RX. Detects and validates the preamble. C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;The first byte of the preamble, in L_RX_BUFF(0), has already been detected and counted by C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;RECEIVE.                                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: RECEIVE                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           CHECK_PREAMBLE							;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0001d0   0826     MOVF      0x26,0x0       			MOVF	L_INDEX,W			;Point to the RX_buffer                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001d1   3e29     ADDLW     0x29           			ADDLW	L_RX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0001d2   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0001d3   30aa     MOVLW     0xaa           			MOVLW	0xAA				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0001d4   0200     SUBWF     0x0,0x0        			SUBWF	INDF,W				;			                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0001d5   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;zero flag set when 0 (EQ)                                   C:\Embedded\CC1000 RF communication\RF.ASM
0001d6   29de     GOTO      0x1de          			GOTO	_PREA_FAIL			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001d7   0823     MOVF      0x23,0x0       _PREA_CONT	MOVF	L_BYTES,W			;The minimun matches must be 3                       C:\Embedded\CC1000 RF communication\RF.ASM
0001d8   3c02     SUBLW     0x2            			SUBLW	2					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
0001d9   1803     BTFSC     0x3,0x0        			BTFSC	STATUS,C			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001da   29e1     GOTO      0x1e1          			GOTO	_PREA_FIN			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001db   14cb     BSF       0x4b,0x1       			BSF		PREAM_FINISHED		;Preamble found - this is where AverageLock would be managed C:\Embedded\CC1000 RF communication\RF.ASM
0001dc   01a3     CLRF      0x23           			CLRF	L_BYTES				;  if we were not using Manchester coding                     C:\Embedded\CC1000 RF communication\RF.ASM
0001dd   29e1     GOTO      0x1e1          			GOTO	_PREA_FIN			;			                                                         C:\Embedded\CC1000 RF communication\RF.ASM
0001de   16ca     BSF       0x4a,0x5       _PREA_FAIL	BSF		RESET_CNTRS			;                                                  C:\Embedded\CC1000 RF communication\RF.ASM
0001df   104b     BCF       0x4b,0x0       			BCF		BOF_FOUND			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001e0   01a3     CLRF      0x23           			CLRF	L_BYTES				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001e1   0008     RETURN                   _PREA_FIN	RETURN						;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Checks for an exact match of the Unique Identifiers (2 bytes)                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: RECEIVE                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           CHECK_UI	                                                                        C:\Embedded\CC1000 RF communication\RF.ASM
0001e2   3029     MOVLW     0x29           			MOVLW	L_RX_BUFF			;Point to the unique code of the receive buffer             C:\Embedded\CC1000 RF communication\RF.ASM
0001e3   3e02     ADDLW     0x2            			ADDLW	(UI-1)				;adjust for L_BYTES (1,2,3,...)                               C:\Embedded\CC1000 RF communication\RF.ASM
0001e4   0723     ADDWF     0x23,0x0       			ADDWF	L_BYTES,W			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0001e5   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0001e6   3001     MOVLW     0x1            			MOVLW	1					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
0001e7   0223     SUBWF     0x23,0x0       			SUBWF	L_BYTES,W			;Decide if we're looking for UI1 or UI2                     C:\Embedded\CC1000 RF communication\RF.ASM
0001e8   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001e9   29ec     GOTO      0x1ec          			GOTO	_CODE2				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
0001ea   30cd     MOVLW     0xcd           			MOVLW	UI_CODE1			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001eb   29ed     GOTO      0x1ed          			GOTO	_UI_CONT			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0001ec   304d     MOVLW     0x4d           _CODE2		MOVLW	UI_CODE2			;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001ed   0200     SUBWF     0x0,0x0        _UI_CONT	SUBWF	INDF,W				;			                                                    C:\Embedded\CC1000 RF communication\RF.ASM
0001ee   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;zero flag set when 0 (EQ)                                   C:\Embedded\CC1000 RF communication\RF.ASM
0001ef   29f7     GOTO      0x1f7          			GOTO	_UI_FAIL			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001f0   0823     MOVF      0x23,0x0       			MOVF	L_BYTES,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001f1   3c02     SUBLW     0x2            			SUBLW	UI_SIZE				;done checking IU?                                           C:\Embedded\CC1000 RF communication\RF.ASM
0001f2   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001f3   29f8     GOTO      0x1f8          			GOTO	_UI_BACK			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001f4   154b     BSF       0x4b,0x2       			BSF		UI_FINISHED			;UI complete and successful                                C:\Embedded\CC1000 RF communication\RF.ASM
0001f5   01a3     CLRF      0x23           			CLRF	L_BYTES				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
0001f6   29f8     GOTO      0x1f8          			GOTO	_UI_BACK			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
0001f7   2172     CALL      0x172          _UI_FAIL	CALL	TREAT_ERROR			;IF ERROR                                            C:\Embedded\CC1000 RF communication\RF.ASM
0001f8   0008     RETURN                   _UI_BACK	RETURN						;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Address is not really implemented, check for 0,0 now                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: RECEIVE                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           CHECK_ADDR                                                                       C:\Embedded\CC1000 RF communication\RF.ASM
0001f9   3029     MOVLW     0x29           			MOVLW	L_RX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
0001fa   3e04     ADDLW     0x4            			ADDLW	(ADDRESS-1)			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
0001fb   0723     ADDWF     0x23,0x0       			ADDWF	L_BYTES,W			;Point to address part in the receive buffer                C:\Embedded\CC1000 RF communication\RF.ASM
0001fc   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
0001fd   3000     MOVLW     0x0            			MOVLW	0					;fake address                                                     C:\Embedded\CC1000 RF communication\RF.ASM
0001fe   0200     SUBWF     0x0,0x0        			SUBWF	INDF,W				;			                                                          C:\Embedded\CC1000 RF communication\RF.ASM
0001ff   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;zero flag set when 0 (EQ)                                   C:\Embedded\CC1000 RF communication\RF.ASM
000200   2a08     GOTO      0x208          			GOTO	_ADDR_FAIL			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000201   0823     MOVF      0x23,0x0       			MOVF	L_BYTES,W			;Check the Addr and set the ADDR_CMPLT flag                  C:\Embedded\CC1000 RF communication\RF.ASM
000202   3c02     SUBLW     0x2            			SUBLW	ADD_SIZE			; if this is the last byte (of 2)                            C:\Embedded\CC1000 RF communication\RF.ASM
000203   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000204   2a09     GOTO      0x209          			GOTO	_ADDR_BACK			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000205   15cb     BSF       0x4b,0x3       			BSF		ADDR_CMPLT			;Address complete and correct                               C:\Embedded\CC1000 RF communication\RF.ASM
000206   01a3     CLRF      0x23           			CLRF	L_BYTES				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000207   2a09     GOTO      0x209          			GOTO	_ADDR_BACK			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000208   2172     CALL      0x172          _ADDR_FAIL	CALL	TREAT_ERROR			;IF ERROR                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000209   0008     RETURN                   _ADDR_BACK	RETURN						;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;We receive exactly 7 bytes of data.  If we are going to implement a             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;variable size frame, Timer1 must be loaded according to the following:          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;((numer of bytes in the frame* (10**6/baudrate)) / timer1 prescaler)            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;where: 10**6/baudrate at 9600 = 104 uS per bit                                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: RECEIVE                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           NBR_BYTES_DATA                                                                   C:\Embedded\CC1000 RF communication\RF.ASM
00020a   3029     MOVLW     0x29           			MOVLW	L_RX_BUFF			;Point to number of bytes in the receive buffer             C:\Embedded\CC1000 RF communication\RF.ASM
00020b   3e06     ADDLW     0x6            			ADDLW	(NO_BYTES-1)		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
00020c   0723     ADDWF     0x23,0x0       			ADDWF	L_BYTES,W			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00020d   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
00020e   3007     MOVLW     0x7            			MOVLW	7					;make sure number of bytes is seven                               C:\Embedded\CC1000 RF communication\RF.ASM
00020f   0200     SUBWF     0x0,0x0        			SUBWF	INDF,W				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000210   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;zero flag set when 0 (EQ)                                   C:\Embedded\CC1000 RF communication\RF.ASM
000211   2a15     GOTO      0x215          			GOTO	_BYTES_FAIL			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000212   164b     BSF       0x4b,0x4       			BSF		NBR_BYTES_RCVD		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000213   01a3     CLRF      0x23           			CLRF	L_BYTES				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000214   2a16     GOTO      0x216          			GOTO	_BYTES_DONE			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000215   2172     CALL      0x172          _BYTES_FAIL	CALL	TREAT_ERROR			;If too big or too small                          C:\Embedded\CC1000 RF communication\RF.ASM
000216   0008     RETURN                   _BYTES_DONE	RETURN						;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Here the only thing to be done is wait for the number of bytes we are supposed to receive C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;and set the DATA_RECEIVED flag. The real check for data validity is in the checksum and in  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;the processing of that data.                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: RECEIVE                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ACCEPT_DATA	                                                                     C:\Embedded\CC1000 RF communication\RF.ASM
000217   3029     MOVLW     0x29           			MOVLW	L_RX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000218   3e07     ADDLW     0x7            			ADDLW	(DATA_OFFS-1)		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000219   0723     ADDWF     0x23,0x0       			ADDWF	L_BYTES,W			;Point to data part of the receive buffer                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;........ do something....                                             C:\Embedded\CC1000 RF communication\RF.ASM
00021a   3029     MOVLW     0x29           			MOVLW	L_RX_BUFF			;Point to number of bytes                                   C:\Embedded\CC1000 RF communication\RF.ASM
00021b   3e07     ADDLW     0x7            			ADDLW	NO_BYTES			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00021c   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
00021d   0800     MOVF      0x0,0x0        			MOVF	INDF,W				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
00021e   0223     SUBWF     0x23,0x0       			SUBWF	L_BYTES,W			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00021f   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000220   2a23     GOTO      0x223          			GOTO	_ACCEPT_END			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000221   16cb     BSF       0x4b,0x5       			BSF		DATA_RECEIVED		;all data received                                        C:\Embedded\CC1000 RF communication\RF.ASM
000222   01a3     CLRF      0x23           			CLRF	L_BYTES				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000223   0008     RETURN                   _ACCEPT_END	RETURN						;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Sum check is only one byte so no use checking length.  This procedure called during C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;reception of a frame                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: RECEIVE                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           CHECK_SUM                                                                        C:\Embedded\CC1000 RF communication\RF.ASM
000224   3029     MOVLW     0x29           			MOVLW	L_RX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000225   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000226   300f     MOVLW     0xf            			MOVLW	(TOT_FRAME_SIZ-1)	;                                                     C:\Embedded\CC1000 RF communication\RF.ASM
000227   00a0     MOVWF     0x20           			MOVWF	L_Temp1				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000228   0103     CLRW                     			CLRW						;                                                                   C:\Embedded\CC1000 RF communication\RF.ASM
000229   0700     ADDWF     0x0,0x0        _CS_LOOP	ADDWF	INDF,W				;calculate the CS for the frame                         C:\Embedded\CC1000 RF communication\RF.ASM
00022a   0a84     INCF      0x4,0x1        			INCF	FSR,F				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
00022b   0ba0     DECFSZ    0x20,0x1       			DECFSZ	L_Temp1,F			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
00022c   2a29     GOTO      0x229          			GOTO	_CS_LOOP			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
00022d   00a1     MOVWF     0x21           			MOVWF	L_Temp_CS			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00022e   3029     MOVLW     0x29           			MOVLW	L_RX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00022f   0726     ADDWF     0x26,0x0       			ADDWF	L_INDEX,W			;L_INDEX points to CS                                       C:\Embedded\CC1000 RF communication\RF.ASM
000230   0084     MOVWF     0x4            			MOVWF	FSR					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000231   0800     MOVF      0x0,0x0        			MOVF	INDF,W				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000232   0221     SUBWF     0x21,0x0       			SUBWF	L_Temp_CS,W			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000233   1d03     BTFSS     0x3,0x2        			BTFSS	STATUS,Z			;SCs must be identical                                       C:\Embedded\CC1000 RF communication\RF.ASM
000234   2172     CALL      0x172          			CALL	TREAT_ERROR			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000235   174b     BSF       0x4b,0x6       _SC_OK		BSF		SUMCHECK_DONE		;                                                    C:\Embedded\CC1000 RF communication\RF.ASM
000236   0008     RETURN                   _SC_FIN		RETURN						;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Process the the packet received depending on wether this is slave or master.    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;The Slave replies to the master query, the Master receives the data sent from   C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;the Slave and lights the corresponding LED.                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Sets RESET_CNTRS when necessary to force start over.                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Note:                                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;If the response from the slave to the master query is lost, there is no recovery. The C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;protocol should consider and acknowledgement before the counter is wiped out.   C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: RECEIVE                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           PROCESS_DATA		                                                                   C:\Embedded\CC1000 RF communication\RF.ASM
000237   3001     MOVLW     0x1            			MOVLW	1					;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
000238   00d1     MOVWF     0x51           			MOVWF	L_RED_COU			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000239   30c6     MOVLW     0xc6           			MOVLW	SLOW_ON				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00023a   00d0     MOVWF     0x50           			MOVWF	L_RED_CTL			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00023b   138b     BCF       0xb,0x7        			BCF		INTCON,GIE			;Disable interrupts to switch to TX/Rx                      C:\Embedded\CC1000 RF communication\RF.ASM
00023c   18cc     BTFSC     0x4c,0x1       			BTFSC	MASTER				;Master                                                       C:\Embedded\CC1000 RF communication\RF.ASM
00023d   2a40     GOTO      0x240          			GOTO	_MAST_PROC			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00023e   21aa     CALL      0x1aa          			CALL	START_SLV_XMIT		;This is were we could chose slave                       C:\Embedded\CC1000 RF communication\RF.ASM
00023f   2a4b     GOTO      0x24b          			GOTO	_PROC_END			;actions.  For now, just send the counter.                   C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000240   3029     MOVLW     0x29           _MAST_PROC	MOVLW	L_RX_BUFF			;Read the RX_BUFFER                                 C:\Embedded\CC1000 RF communication\RF.ASM
000241   3e0e     ADDLW     0xe            			ADDLW	(DATA_OFFS+6)		; and light the                                          C:\Embedded\CC1000 RF communication\RF.ASM
000242   0084     MOVWF     0x4            			MOVWF	FSR					; corresponding LED                                             C:\Embedded\CC1000 RF communication\RF.ASM
000243   0800     MOVF      0x0,0x0        			MOVF	INDF,W				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
000244   1903     BTFSC     0x3,0x2        			BTFSC	STATUS,Z			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000245   2a49     GOTO      0x249          			GOTO	_MAST_END			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000246   00ce     MOVWF     0x4e           			MOVWF	L_GREEN_COU			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000247   30c6     MOVLW     0xc6           			MOVLW	SLOW_ON				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
000248   00cd     MOVWF     0x4d           			MOVWF	L_GREEN_CTL			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
000249   16cc     BSF       0x4c,0x5       _MAST_END	BSF		QUIET				;job finished                                            C:\Embedded\CC1000 RF communication\RF.ASM
00024a   22b8     CALL      0x2b8          			CALL	Setup_CC1000PD		;Turn off CC1000 until button is pressed again           C:\Embedded\CC1000 RF communication\RF.ASM
00024b   178b     BSF       0xb,0x7        _PROC_END	BSF		INTCON,GIE			;                                                    C:\Embedded\CC1000 RF communication\RF.ASM
00024c   0008     RETURN                   			RETURN						;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;copy the Comm_buffer to the TX_BUFFER, calculate and fill the check sum         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM: START_MST_XMIT, START_SLV_XMIT                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           FILL_TX_BUFFER							;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
00024d   01a6     CLRF      0x26           			CLRF	L_INDEX				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
00024e   01a1     CLRF      0x21           			CLRF	L_Temp_CS			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
00024f   01a5     CLRF      0x25           			CLRF	L_NEXT_FR_BYT		;number of frame bytes                                    C:\Embedded\CC1000 RF communication\RF.ASM
000250   3039     MOVLW     0x39           			MOVLW	L_TX_BUFF			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000251   0725     ADDWF     0x25,0x0       			ADDWF	L_NEXT_FR_BYT,W		;                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000252   0084     MOVWF     0x4            			MOVWF	FSR					;INDF -> L_TX_BUFF (Dest)                                       C:\Embedded\CC1000 RF communication\RF.ASM
000253   300f     MOVLW     0xf            			MOVLW	(TOT_FRAME_SIZ-1)	;                                                     C:\Embedded\CC1000 RF communication\RF.ASM
000254   00a4     MOVWF     0x24           			MOVWF	L_TX_COUNT			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
000255   3000     MOVLW     0x0            _TX_COPY	MOVLW	HIGH RAW_BUFFER		;                                                C:\Embedded\CC1000 RF communication\RF.ASM
000256   008a     MOVWF     0xa            			MOVWF	PCLATH				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
000257   0825     MOVF      0x25,0x0       			MOVF	L_NEXT_FR_BYT,W		;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
000258   2024     CALL      0x24           			CALL	RAW_BUFFER			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
000259   0080     MOVWF     0x0            			MOVWF	INDF				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
00025a   07a1     ADDWF     0x21,0x1       			ADDWF	L_Temp_CS,F			;compute check sum                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00025b   0a84     INCF      0x4,0x1        			INCF	FSR,F				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
00025c   0aa5     INCF      0x25,0x1       			INCF	L_NEXT_FR_BYT,F		;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
00025d   0ba4     DECFSZ    0x24,0x1       			DECFSZ	L_TX_COUNT,F		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
00025e   2a55     GOTO      0x255          			GOTO	_TX_COPY			;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           										;                                                                      C:\Embedded\CC1000 RF communication\RF.ASM
00025f   0821     MOVF      0x21,0x0       			MOVF	L_Temp_CS,W			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
000260   0080     MOVWF     0x0            			MOVWF	INDF				;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
000261   0008     RETURN                   			RETURN						;                                                                 C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Reads the counter in EEPROM which is locatated in PROGRAM MEMORY and returns it in L_EE_COUNT. C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;EEPROM is defined as FLASH MEMORY (in Program Memory)                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Runs on interrupts disabled                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM:                                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;READ_EEPROM                                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP1			;bank 2                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	EE_ADDR_H			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEADRH				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	EE_ADDR_L			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEADR				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP0			;bank 3                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		EECON1,EEPGD		;Point to program memory                                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		EECON1,RD			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			NOP							;                                                                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			NOP							;                                                                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;bank 2                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVF	EEDATA,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	L_EE_COUNT_L		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVF	EEDATH,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	L_EE_COUNT_H		;                                                        C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP1			;bank 0                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			RETURN 						;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Writes the counter in EEPROM which is locatated in PROGRAM MEMORY               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Parameters: L_EE_COUNT                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Runs on interrupts disabled                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM:                                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;WRITE_EEPROM                                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP1			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;bank 2                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	EE_ADDR_H			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEADRH				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	EE_ADDR_L			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEADR				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	L_EE_COUNT_L		;contains (points) the 1st byte of data                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	FSR					;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           _;EE_LOOP	MOVF	INDF,W				;                                                       C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEDATA				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			INCF	FSR,F				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVF	INDF,W				;second byte                                                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEDATH				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			INCF	FSR,F				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP0			;bank 3                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		EECON1,EEPGD		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		EECON1,WREN			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		INTCON,GIE			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	0x55				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EECON2				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	0xAA				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EECON2				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		EECON1,WR			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			NOP							;			                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			NOP							;			                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		EECON1,WREN			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		INTCON,GIE			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;bank 2                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			INCF	EEADR,F				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVF	EEADR,W				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			ANDLW	0x03				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			XORLW	0x03				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BTFSC	STATUS,Z			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			GOTO	_EE_LOOP			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP1			;bank 0                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			RETURN 						;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Reads the counter in EEPROM which is locatated in DATA MEMORY and returns it in W.   C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Runs on interrupts disabled                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM:                                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;READ_EEPROM                                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	EE_counter_addr		;                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP1			;bank 2                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEADR				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP0			;bank 3                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		EECON1,EEPGD		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		EECON1,RD			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVF	EEDATA,W			;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP1			;bank 0                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	L_EE_COUNT			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			RETURN 						;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Writes the counter in EEPROM which is locatated in DATA MEMORY                  C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Parameters: L_EE_COUNT                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;Runs on interrupts disabled                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;CALLED FROM:                                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;                                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;WRITE_EEPROM                                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP1			;bank 3                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP0			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BTFSC	EECON1,WR			;in case of pending writes?                                C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			GOTO	$-1					;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;bank 2                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	EE_counter_addr		;                                                     C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEADR				;                                                             C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP1			;bank 0                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVF	L_EE_COUNT,W		;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP1			;bank 2                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EEDATA				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		STATUS,RP0			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		EECON1,EEPGD		;Prepare to write                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		EECON1,WREN			;                                                         C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	0x55				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EECON2				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVLW	0xAA				;                                                              C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			MOVWF	EECON2				;                                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BSF		EECON1,WR			;                                                           C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		EECON1,WREN			;Enable writes                                            C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP1			;bank 0                                                    C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			BCF		STATUS,RP0			;                                                          C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;			RETURN 						;                                                               C:\Embedded\CC1000 RF communication\RF.ASM
                                           ;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ C:\Embedded\CC1000 RF communication\RF.ASM
                                           			END		; of code                                                                C:\Embedded\CC1000 RF communication\RF.ASM
                                                   LIST                                                                     C:\PROGRA~1\MPLABI~1\MCHIP_Tools\p16f876.inc
                                           ; P16F876.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.  C:\PROGRA~1\MPLABI~1\MCHIP_Tools\p16f876.inc
                                                   LIST                                                                     C:\PROGRA~1\MPLABI~1\MCHIP_Tools\p16f876.inc
                                                   LIST                                                                     C:\Program Files\MPLAB IDE\MCHIP_Tools\p16f876.inc
                                           ; P16F876.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.  C:\Program Files\MPLAB IDE\MCHIP_Tools\p16f876.inc
                                                   LIST                                                                     C:\Program Files\MPLAB IDE\MCHIP_Tools\p16f876.inc
